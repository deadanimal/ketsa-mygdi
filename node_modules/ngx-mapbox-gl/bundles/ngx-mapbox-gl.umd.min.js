!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/common"),require("@angular/core"),require("mapbox-gl"),require("rxjs"),require("rxjs/operators"),require("@mapbox/mapbox-gl-geocoder")):"function"==typeof define&&define.amd?define("ngx-mapbox-gl",["exports","@angular/common","@angular/core","mapbox-gl","rxjs","rxjs/operators","@mapbox/mapbox-gl-geocoder"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self)["ngx-mapbox-gl"]={},t.ng.common,t.ng.core,t.MapboxGl,t.rxjs,t.rxjs.operators,t.MapboxGeocoder)}(this,(function(t,e,n,r,o,i,s){"use strict";function a(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}function u(t){if(t&&t.__esModule)return t;var e=Object.create(null);return t&&Object.keys(t).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}})),e.default=t,Object.freeze(e)}var p=u(r),c=a(s);function h(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function l(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}Object.create;function m(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}Object.create;var d=new n.InjectionToken("MapboxApiKey"),g=function(){function t(t,e){this.zone=t,this.MAPBOX_API_KEY=e,this.mapCreated=new o.AsyncSubject,this.mapLoaded=new o.AsyncSubject,this.markersToRemove=[],this.popupsToRemove=[],this.imageIdsToRemove=[],this.subscription=new o.Subscription,this.mapCreated$=this.mapCreated.asObservable(),this.mapLoaded$=this.mapLoaded.asObservable()}return t.prototype.setup=function(t){var e=this;this.zone.onStable.pipe(i.first()).subscribe((function(){e.assign(p,"accessToken",t.accessToken||e.MAPBOX_API_KEY),t.customMapboxApiUrl&&e.assign(p,"config.API_URL",t.customMapboxApiUrl),e.createMap(t.mapOptions),e.hookEvents(t.mapEvents),e.mapEvents=t.mapEvents,e.mapCreated.next(void 0),e.mapCreated.complete()}))},t.prototype.destroyMap=function(){this.mapInstance&&(this.subscription.unsubscribe(),this.mapInstance.remove())},t.prototype.updateMinZoom=function(t){var e=this;return this.zone.runOutsideAngular((function(){e.mapInstance.setMinZoom(t)}))},t.prototype.updateMaxZoom=function(t){var e=this;return this.zone.runOutsideAngular((function(){e.mapInstance.setMaxZoom(t)}))},t.prototype.updateMinPitch=function(t){var e=this;return this.zone.runOutsideAngular((function(){e.mapInstance.setMinPitch(t)}))},t.prototype.updateMaxPitch=function(t){var e=this;return this.zone.runOutsideAngular((function(){e.mapInstance.setMaxPitch(t)}))},t.prototype.updateRenderWorldCopies=function(t){var e=this;return this.zone.runOutsideAngular((function(){e.mapInstance.setRenderWorldCopies(t)}))},t.prototype.updateScrollZoom=function(t){var e=this;return this.zone.runOutsideAngular((function(){t?e.mapInstance.scrollZoom.enable():e.mapInstance.scrollZoom.disable()}))},t.prototype.updateDragRotate=function(t){var e=this;return this.zone.runOutsideAngular((function(){t?e.mapInstance.dragRotate.enable():e.mapInstance.dragRotate.disable()}))},t.prototype.updateTouchPitch=function(t){var e=this;return this.zone.runOutsideAngular((function(){t?e.mapInstance.touchPitch.enable():e.mapInstance.touchPitch.disable()}))},t.prototype.updateTouchZoomRotate=function(t){var e=this;return this.zone.runOutsideAngular((function(){t?e.mapInstance.touchZoomRotate.enable():e.mapInstance.touchZoomRotate.disable()}))},t.prototype.updateDoubleClickZoom=function(t){var e=this;return this.zone.runOutsideAngular((function(){t?e.mapInstance.doubleClickZoom.enable():e.mapInstance.doubleClickZoom.disable()}))},t.prototype.updateKeyboard=function(t){var e=this;return this.zone.runOutsideAngular((function(){t?e.mapInstance.keyboard.enable():e.mapInstance.keyboard.disable()}))},t.prototype.updateDragPan=function(t){var e=this;return this.zone.runOutsideAngular((function(){t?e.mapInstance.dragPan.enable():e.mapInstance.dragPan.disable()}))},t.prototype.updateBoxZoom=function(t){var e=this;return this.zone.runOutsideAngular((function(){t?e.mapInstance.boxZoom.enable():e.mapInstance.boxZoom.disable()}))},t.prototype.updateStyle=function(t){var e=this;return this.zone.runOutsideAngular((function(){e.mapInstance.setStyle(t)}))},t.prototype.updateMaxBounds=function(t){var e=this;return this.zone.runOutsideAngular((function(){e.mapInstance.setMaxBounds(t)}))},t.prototype.changeCanvasCursor=function(t){this.mapInstance.getCanvasContainer().style.cursor=t},t.prototype.queryRenderedFeatures=function(t,e){return this.mapInstance.queryRenderedFeatures(t,e)},t.prototype.panTo=function(t,e){var n=this;return this.zone.runOutsideAngular((function(){n.mapInstance.panTo(t,e)}))},t.prototype.move=function(t,e,n,r,o,i){var s=this;return this.zone.runOutsideAngular((function(){s.mapInstance[t](Object.assign(Object.assign({},e),{zoom:n||s.mapInstance.getZoom(),center:r||s.mapInstance.getCenter(),bearing:o||s.mapInstance.getBearing(),pitch:i||s.mapInstance.getPitch()}))}))},t.prototype.addLayer=function(t,e,n){var r=this;this.zone.runOutsideAngular((function(){Object.keys(t.layerOptions).forEach((function(e){var n=e;void 0===t.layerOptions[n]&&delete t.layerOptions[n]})),r.mapInstance.addLayer(t.layerOptions,n),e&&((t.layerEvents.layerClick.observers.length||t.layerEvents.click.observers.length)&&r.mapInstance.on("click",t.layerOptions.id,(function(e){r.zone.run((function(){t.layerEvents.layerClick.emit(e),t.layerEvents.click.emit(e)}))})),(t.layerEvents.layerDblClick.observers.length||t.layerEvents.dblClick.observers.length)&&r.mapInstance.on("dblclick",t.layerOptions.id,(function(e){r.zone.run((function(){t.layerEvents.layerDblClick.emit(e),t.layerEvents.dblClick.emit(e)}))})),(t.layerEvents.layerMouseDown.observers.length||t.layerEvents.mouseDown.observers.length)&&r.mapInstance.on("mousedown",t.layerOptions.id,(function(e){r.zone.run((function(){t.layerEvents.layerMouseDown.emit(e),t.layerEvents.mouseDown.emit(e)}))})),(t.layerEvents.layerMouseUp.observers.length||t.layerEvents.mouseUp.observers.length)&&r.mapInstance.on("mouseup",t.layerOptions.id,(function(e){r.zone.run((function(){t.layerEvents.layerMouseUp.emit(e),t.layerEvents.mouseUp.emit(e)}))})),(t.layerEvents.layerMouseEnter.observers.length||t.layerEvents.mouseEnter.observers.length)&&r.mapInstance.on("mouseenter",t.layerOptions.id,(function(e){r.zone.run((function(){t.layerEvents.layerMouseEnter.emit(e),t.layerEvents.mouseEnter.emit(e)}))})),(t.layerEvents.layerMouseLeave.observers.length||t.layerEvents.mouseLeave.observers.length)&&r.mapInstance.on("mouseleave",t.layerOptions.id,(function(e){r.zone.run((function(){t.layerEvents.layerMouseLeave.emit(e),t.layerEvents.mouseLeave.emit(e)}))})),(t.layerEvents.layerMouseMove.observers.length||t.layerEvents.mouseMove.observers.length)&&r.mapInstance.on("mousemove",t.layerOptions.id,(function(e){r.zone.run((function(){t.layerEvents.layerMouseMove.emit(e),t.layerEvents.mouseMove.emit(e)}))})),(t.layerEvents.layerMouseOver.observers.length||t.layerEvents.mouseOver.observers.length)&&r.mapInstance.on("mouseover",t.layerOptions.id,(function(e){r.zone.run((function(){t.layerEvents.layerMouseOver.emit(e),t.layerEvents.mouseOver.emit(e)}))})),(t.layerEvents.layerMouseOut.observers.length||t.layerEvents.mouseOut.observers.length)&&r.mapInstance.on("mouseout",t.layerOptions.id,(function(e){r.zone.run((function(){t.layerEvents.layerMouseOut.emit(e),t.layerEvents.mouseOut.emit(e)}))})),(t.layerEvents.layerContextMenu.observers.length||t.layerEvents.contextMenu.observers.length)&&r.mapInstance.on("contextmenu",t.layerOptions.id,(function(e){r.zone.run((function(){t.layerEvents.layerContextMenu.emit(e),t.layerEvents.contextMenu.emit(e)}))})),(t.layerEvents.layerTouchStart.observers.length||t.layerEvents.touchStart.observers.length)&&r.mapInstance.on("touchstart",t.layerOptions.id,(function(e){r.zone.run((function(){t.layerEvents.layerTouchStart.emit(e),t.layerEvents.touchStart.emit(e)}))})),(t.layerEvents.layerTouchEnd.observers.length||t.layerEvents.touchEnd.observers.length)&&r.mapInstance.on("touchend",t.layerOptions.id,(function(e){r.zone.run((function(){t.layerEvents.layerTouchEnd.emit(e),t.layerEvents.touchEnd.emit(e)}))})),(t.layerEvents.layerTouchCancel.observers.length||t.layerEvents.touchCancel.observers.length)&&r.mapInstance.on("touchcancel",t.layerOptions.id,(function(e){r.zone.run((function(){t.layerEvents.layerTouchCancel.emit(e),t.layerEvents.touchCancel.emit(e)}))})))}))},t.prototype.removeLayer=function(t){var e=this;this.zone.runOutsideAngular((function(){null!=e.mapInstance.getLayer(t)&&e.mapInstance.removeLayer(t)}))},t.prototype.addMarker=function(t){var e=this,n={offset:t.markersOptions.offset,anchor:t.markersOptions.anchor,draggable:!!t.markersOptions.draggable,rotationAlignment:t.markersOptions.rotationAlignment,pitchAlignment:t.markersOptions.pitchAlignment,clickTolerance:t.markersOptions.clickTolerance};t.markersOptions.element.childNodes.length>0&&(n.element=t.markersOptions.element);var o=new r.Marker(n);(t.markersEvents.markerDragStart.observers.length||t.markersEvents.dragStart.observers.length)&&o.on("dragstart",(function(n){if(n){var r=n.target;e.zone.run((function(){t.markersEvents.markerDragStart.emit(r),t.markersEvents.dragStart.emit(r)}))}})),(t.markersEvents.markerDrag.observers.length||t.markersEvents.drag.observers.length)&&o.on("drag",(function(n){if(n){var r=n.target;e.zone.run((function(){t.markersEvents.markerDrag.emit(r),t.markersEvents.drag.emit(r)}))}})),(t.markersEvents.markerDragEnd.observers.length||t.markersEvents.dragEnd.observers.length)&&o.on("dragend",(function(n){if(n){var r=n.target;e.zone.run((function(){t.markersEvents.markerDragEnd.emit(r),t.markersEvents.dragEnd.emit(r)}))}}));var i=t.markersOptions.feature?t.markersOptions.feature.geometry.coordinates:t.markersOptions.lngLat;return o.setLngLat(i),this.zone.runOutsideAngular((function(){return o.addTo(e.mapInstance),o}))},t.prototype.removeMarker=function(t){this.markersToRemove.push(t)},t.prototype.createPopup=function(t,e){var n=this;return this.zone.runOutsideAngular((function(){Object.keys(t.popupOptions).forEach((function(e){return void 0===t.popupOptions[e]&&delete t.popupOptions[e]}));var o=new r.Popup(t.popupOptions);return o.setDOMContent(e),(t.popupEvents.popupClose.observers.length||t.popupEvents.close.observers.length)&&o.on("close",(function(){n.zone.run((function(){t.popupEvents.popupClose.emit(),t.popupEvents.close.emit()}))})),(t.popupEvents.popupOpen.observers.length||t.popupEvents.open.observers.length)&&o.on("open",(function(){n.zone.run((function(){t.popupEvents.popupOpen.emit(),t.popupEvents.open.emit()}))})),o}))},t.prototype.addPopupToMap=function(t,e,n){var r=this;return void 0===n&&(n=!1),this.zone.runOutsideAngular((function(){n&&t._listeners&&delete t._listeners.open,t.setLngLat(e),t.addTo(r.mapInstance)}))},t.prototype.addPopupToMarker=function(t,e){return this.zone.runOutsideAngular((function(){t.setPopup(e)}))},t.prototype.removePopupFromMap=function(t,e){void 0===e&&(e=!1),e&&t._listeners&&delete t._listeners.close,this.popupsToRemove.push(t)},t.prototype.removePopupFromMarker=function(t){return this.zone.runOutsideAngular((function(){t.setPopup(void 0)}))},t.prototype.addControl=function(t,e){var n=this;return this.zone.runOutsideAngular((function(){n.mapInstance.addControl(t,e)}))},t.prototype.removeControl=function(t){var e=this;return this.zone.runOutsideAngular((function(){e.mapInstance.removeControl(t)}))},t.prototype.loadAndAddImage=function(t,e,n){return h(this,void 0,void 0,(function(){var r=this;return l(this,(function(o){return[2,this.zone.runOutsideAngular((function(){return new Promise((function(o,i){r.mapInstance.loadImage(e,(function(e,s){e?i(e):(r.addImage(t,s,n),o())}))}))}))]}))}))},t.prototype.addImage=function(t,e,n){var r=this;return this.zone.runOutsideAngular((function(){r.mapInstance.addImage(t,e,n)}))},t.prototype.removeImage=function(t){this.imageIdsToRemove.push(t)},t.prototype.addSource=function(t,e){var n=this;return this.zone.runOutsideAngular((function(){Object.keys(e).forEach((function(t){return void 0===e[t]&&delete e[t]})),n.mapInstance.addSource(t,e)}))},t.prototype.getSource=function(t){return this.mapInstance.getSource(t)},t.prototype.removeSource=function(t){var e=this;this.zone.runOutsideAngular((function(){e.findLayersBySourceId(t).forEach((function(t){return e.mapInstance.removeLayer(t.id)})),e.mapInstance.removeSource(t)}))},t.prototype.setAllLayerPaintProperty=function(t,e){var n=this;return this.zone.runOutsideAngular((function(){Object.keys(e).forEach((function(r){n.mapInstance.setPaintProperty(t,r,e[r])}))}))},t.prototype.setAllLayerLayoutProperty=function(t,e){var n=this;return this.zone.runOutsideAngular((function(){Object.keys(e).forEach((function(r){n.mapInstance.setLayoutProperty(t,r,e[r])}))}))},t.prototype.setLayerFilter=function(t,e){var n=this;return this.zone.runOutsideAngular((function(){n.mapInstance.setFilter(t,e)}))},t.prototype.setLayerBefore=function(t,e){var n=this;return this.zone.runOutsideAngular((function(){n.mapInstance.moveLayer(t,e)}))},t.prototype.setLayerZoomRange=function(t,e,n){var r=this;return this.zone.runOutsideAngular((function(){r.mapInstance.setLayerZoomRange(t,e||0,n||20)}))},t.prototype.fitBounds=function(t,e){var n=this;return this.zone.runOutsideAngular((function(){n.mapInstance.fitBounds(t,e)}))},t.prototype.fitScreenCoordinates=function(t,e,n){var r=this;return this.zone.runOutsideAngular((function(){r.mapInstance.fitScreenCoordinates(t[0],t[1],e,n)}))},t.prototype.applyChanges=function(){var t=this;this.zone.runOutsideAngular((function(){t.removeMarkers(),t.removePopups(),t.removeImages()}))},t.prototype.createMap=function(t){var e=this;n.NgZone.assertNotInAngularZone(),Object.keys(t).forEach((function(e){var n=e;void 0===t[n]&&delete t[n]})),this.mapInstance=new r.Map(t),window&&/msie\s|trident\/|edge\//i.test(window.navigator.userAgent)&&this.mapInstance.setStyle(t.style),this.subscription.add(this.zone.onMicrotaskEmpty.subscribe((function(){return e.applyChanges()})))},t.prototype.removeMarkers=function(){var t,e;try{for(var n=m(this.markersToRemove),r=n.next();!r.done;r=n.next()){r.value.remove()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.markersToRemove=[]},t.prototype.removePopups=function(){var t,e;try{for(var n=m(this.popupsToRemove),r=n.next();!r.done;r=n.next()){r.value.remove()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.popupsToRemove=[]},t.prototype.removeImages=function(){var t,e;try{for(var n=m(this.imageIdsToRemove),r=n.next();!r.done;r=n.next()){var o=r.value;this.mapInstance.removeImage(o)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.imageIdsToRemove=[]},t.prototype.findLayersBySourceId=function(t){var e=this.mapInstance.getStyle().layers;return null==e?[]:e.filter((function(e){return"source"in e&&e.source===t}))},t.prototype.hookEvents=function(t){var e=this;this.mapInstance.on("load",(function(n){e.mapLoaded.next(void 0),e.mapLoaded.complete(),e.zone.run((function(){t.mapLoad.emit(n.target),t.load.emit(n.target)}))})),(t.mapResize.observers.length||t.resize.observers.length)&&this.mapInstance.on("resize",(function(n){return e.zone.run((function(){t.mapResize.emit(n),t.resize.emit(n)}))})),(t.mapRemove.observers.length||t.remove.observers.length)&&this.mapInstance.on("remove",(function(n){return e.zone.run((function(){t.mapRemove.emit(n),t.remove.emit(n)}))})),(t.mapMouseDown.observers.length||t.mouseDown.observers.length)&&this.mapInstance.on("mousedown",(function(n){return e.zone.run((function(){t.mapMouseDown.emit(n),t.mouseDown.emit(n)}))})),(t.mapMouseUp.observers.length||t.mouseUp.observers.length)&&this.mapInstance.on("mouseup",(function(n){return e.zone.run((function(){t.mapMouseUp.emit(n),t.mouseUp.emit(n)}))})),(t.mapMouseMove.observers.length||t.mouseMove.observers.length)&&this.mapInstance.on("mousemove",(function(n){return e.zone.run((function(){t.mapMouseMove.emit(n),t.mouseMove.emit(n)}))})),(t.mapClick.observers.length||t.click.observers.length)&&this.mapInstance.on("click",(function(n){return e.zone.run((function(){t.mapClick.emit(n),t.click.emit(n)}))})),(t.mapDblClick.observers.length||t.dblClick.observers.length)&&this.mapInstance.on("dblclick",(function(n){return e.zone.run((function(){t.mapDblClick.emit(n),t.dblClick.emit(n)}))})),(t.mapMouseOver.observers.length||t.mouseOver.observers.length)&&this.mapInstance.on("mouseover",(function(n){return e.zone.run((function(){t.mapMouseOver.emit(n),t.mouseOver.emit(n)}))})),(t.mapMouseOut.observers.length||t.mouseOut.observers.length)&&this.mapInstance.on("mouseout",(function(n){return e.zone.run((function(){t.mapMouseOut.emit(n),t.mouseOut.emit(n)}))})),(t.mapContextMenu.observers.length||t.contextMenu.observers.length)&&this.mapInstance.on("contextmenu",(function(n){return e.zone.run((function(){t.mapContextMenu.emit(n),t.contextMenu.emit(n)}))})),(t.mapTouchStart.observers.length||t.touchStart.observers.length)&&this.mapInstance.on("touchstart",(function(n){return e.zone.run((function(){t.mapTouchStart.emit(n),t.touchStart.emit(n)}))})),(t.mapTouchEnd.observers.length||t.touchEnd.observers.length)&&this.mapInstance.on("touchend",(function(n){return e.zone.run((function(){t.mapTouchEnd.emit(n),t.touchEnd.emit(n)}))})),(t.mapTouchMove.observers.length||t.touchMove.observers.length)&&this.mapInstance.on("touchmove",(function(n){return e.zone.run((function(){t.mapTouchMove.emit(n),t.touchMove.emit(n)}))})),(t.mapTouchCancel.observers.length||t.touchCancel.observers.length)&&this.mapInstance.on("touchcancel",(function(n){return e.zone.run((function(){t.mapTouchCancel.emit(n),t.touchCancel.emit(n)}))})),(t.mapWheel.observers.length||t.wheel.observers.length)&&this.mapInstance.on("wheel",(function(n){return e.zone.run((function(){t.mapWheel.emit(n),t.wheel.emit(n)}))})),t.moveStart.observers.length&&this.mapInstance.on("movestart",(function(n){return e.zone.run((function(){return t.moveStart.emit(n)}))})),t.move.observers.length&&this.mapInstance.on("move",(function(n){return e.zone.run((function(){return t.move.emit(n)}))})),t.moveEnd.observers.length&&this.mapInstance.on("moveend",(function(n){return e.zone.run((function(){return t.moveEnd.emit(n)}))})),(t.mapDragStart.observers.length||t.dragStart.observers.length)&&this.mapInstance.on("dragstart",(function(n){return e.zone.run((function(){t.mapDragStart.emit(n),t.dragStart.emit(n)}))})),(t.mapDrag.observers.length||t.drag.observers.length)&&this.mapInstance.on("drag",(function(n){return e.zone.run((function(){t.mapDrag.emit(n),t.drag.emit(n)}))})),(t.mapDragEnd.observers.length||t.dragEnd.observers.length)&&this.mapInstance.on("dragend",(function(n){return e.zone.run((function(){t.mapDragEnd.emit(n),t.dragEnd.emit(n)}))})),t.zoomStart.observers.length&&this.mapInstance.on("zoomstart",(function(n){return e.zone.run((function(){return t.zoomStart.emit(n)}))})),t.zoomEvt.observers.length&&this.mapInstance.on("zoom",(function(n){return e.zone.run((function(){return t.zoomEvt.emit(n)}))})),t.zoomEnd.observers.length&&this.mapInstance.on("zoomend",(function(n){return e.zone.run((function(){return t.zoomEnd.emit(n)}))})),t.rotateStart.observers.length&&this.mapInstance.on("rotatestart",(function(n){return e.zone.run((function(){return t.rotateStart.emit(n)}))})),t.rotate.observers.length&&this.mapInstance.on("rotate",(function(n){return e.zone.run((function(){return t.rotate.emit(n)}))})),t.rotateEnd.observers.length&&this.mapInstance.on("rotateend",(function(n){return e.zone.run((function(){return t.rotateEnd.emit(n)}))})),t.pitchStart.observers.length&&this.mapInstance.on("pitchstart",(function(n){return e.zone.run((function(){return t.pitchStart.emit(n)}))})),t.pitchEvt.observers.length&&this.mapInstance.on("pitch",(function(n){return e.zone.run((function(){return t.pitchEvt.emit(n)}))})),t.pitchEnd.observers.length&&this.mapInstance.on("pitchend",(function(n){return e.zone.run((function(){return t.pitchEnd.emit(n)}))})),t.boxZoomStart.observers.length&&this.mapInstance.on("boxzoomstart",(function(n){return e.zone.run((function(){return t.boxZoomStart.emit(n)}))})),t.boxZoomEnd.observers.length&&this.mapInstance.on("boxzoomend",(function(n){return e.zone.run((function(){return t.boxZoomEnd.emit(n)}))})),t.boxZoomCancel.observers.length&&this.mapInstance.on("boxzoomcancel",(function(n){return e.zone.run((function(){return t.boxZoomCancel.emit(n)}))})),t.webGlContextLost.observers.length&&this.mapInstance.on("webglcontextlost",(function(n){return e.zone.run((function(){return t.webGlContextLost.emit(n)}))})),t.webGlContextRestored.observers.length&&this.mapInstance.on("webglcontextrestored",(function(n){return e.zone.run((function(){return t.webGlContextRestored.emit(n)}))})),t.render.observers.length&&this.mapInstance.on("render",(function(n){return e.zone.run((function(){return t.render.emit(n)}))})),(t.mapError.observers.length||t.error.observers.length)&&this.mapInstance.on("error",(function(n){return e.zone.run((function(){t.mapError.emit(n),t.error.emit(n)}))})),t.data.observers.length&&this.mapInstance.on("data",(function(n){return e.zone.run((function(){return t.data.emit(n)}))})),t.styleData.observers.length&&this.mapInstance.on("styledata",(function(n){return e.zone.run((function(){return t.styleData.emit(n)}))})),t.sourceData.observers.length&&this.mapInstance.on("sourcedata",(function(n){return e.zone.run((function(){return t.sourceData.emit(n)}))})),t.dataLoading.observers.length&&this.mapInstance.on("dataloading",(function(n){return e.zone.run((function(){return t.dataLoading.emit(n)}))})),t.styleDataLoading.observers.length&&this.mapInstance.on("styledataloading",(function(n){return e.zone.run((function(){return t.styleDataLoading.emit(n)}))})),t.sourceDataLoading.observers.length&&this.mapInstance.on("sourcedataloading",(function(n){return e.zone.run((function(){return t.sourceDataLoading.emit(n)}))})),t.styleImageMissing.observers.length&&this.mapInstance.on("styleimagemissing",(function(n){return e.zone.run((function(){return t.styleImageMissing.emit(n)}))})),t.idle.observers.length&&this.mapInstance.on("idle",(function(n){return e.zone.run((function(){return t.idle.emit(n)}))}))},t.prototype.assign=function(t,e,n){if("string"==typeof e&&(e=e.split(".")),e.length>1){var r=e.shift();this.assign(t[r]="[object Object]"===Object.prototype.toString.call(t[r])?t[r]:{},e,n)}else t[e[0]]=n},t}();g.decorators=[{type:n.Injectable}],g.ctorParameters=function(){return[{type:n.NgZone},{type:String,decorators:[{type:n.Optional},{type:n.Inject,args:[d]}]}]};var v=function(){function t(t){this.container=t}return t.prototype.onAdd=function(){return this.container},t.prototype.onRemove=function(){return this.container.parentNode.removeChild(this.container)},t.prototype.getDefaultPosition=function(){return"top-right"},t}(),y=function(){function t(t){this.MapService=t,this.controlAdded=!1}return t.prototype.ngAfterContentInit=function(){var t=this;this.content.nativeElement.childNodes.length&&(this.control=new v(this.content.nativeElement),this.MapService.mapCreated$.subscribe((function(){t.MapService.addControl(t.control,t.position),t.controlAdded=!0})))},t.prototype.ngOnDestroy=function(){this.controlAdded&&this.MapService.removeControl(this.control)},t}();y.decorators=[{type:n.Component,args:[{selector:"mgl-control",template:'<div class="mapboxgl-ctrl" #content><ng-content></ng-content></div>',changeDetection:n.ChangeDetectionStrategy.OnPush}]}],y.ctorParameters=function(){return[{type:g}]},y.propDecorators={position:[{type:n.Input}],content:[{type:n.ViewChild,args:["content",{static:!0}]}]};var f=function(){function t(t,e){this.MapService=t,this.ControlComponent=e}return t.prototype.ngAfterContentInit=function(){var t=this;this.MapService.mapCreated$.subscribe((function(){if(t.ControlComponent.control)throw new Error("Another control is already set for this control");var e={};void 0!==t.compact&&(e.compact=t.compact),void 0!==t.customAttribution&&(e.customAttribution=t.customAttribution),t.ControlComponent.control=new r.AttributionControl(e),t.MapService.addControl(t.ControlComponent.control,t.ControlComponent.position)}))},t}();f.decorators=[{type:n.Directive,args:[{selector:"[mglAttribution]"}]}],f.ctorParameters=function(){return[{type:g},{type:y,decorators:[{type:n.Host}]}]},f.propDecorators={compact:[{type:n.Input}],customAttribution:[{type:n.Input}]};var b=function(){function t(t,e){this.MapService=t,this.ControlComponent=e}return t.prototype.ngAfterContentInit=function(){var t=this;this.MapService.mapCreated$.subscribe((function(){if(t.ControlComponent.control)throw new Error("Another control is already set for this control");t.ControlComponent.control=new r.FullscreenControl({container:t.container}),t.MapService.addControl(t.ControlComponent.control,t.ControlComponent.position)}))},t}();function E(t,e,n){console.warn("[ngx-mapbox-gl]: "+t+": "+e+" is deprecated, please use "+n+" instead.")}b.decorators=[{type:n.Directive,args:[{selector:"[mglFullscreen]"}]}],b.ctorParameters=function(){return[{type:g},{type:y,decorators:[{type:n.Host}]}]},b.propDecorators={container:[{type:n.Input}]};var C=new n.InjectionToken("MapboxApiKey"),I=function(){function t(t,e,r,o){this.MapService=t,this.zone=e,this.ControlComponent=r,this.MAPBOX_GEOCODER_API_KEY=o,this.marker=!1,this.clear=new n.EventEmitter,this.loading=new n.EventEmitter,this.geocoderResults=new n.EventEmitter,this.geocoderResult=new n.EventEmitter,this.geocoderError=new n.EventEmitter,this.results=new n.EventEmitter,this.result=new n.EventEmitter,this.error=new n.EventEmitter}return t.prototype.ngAfterContentInit=function(){var t=this;this.MapService.mapCreated$.subscribe((function(){if(t.ControlComponent.control)throw new Error("Another control is already set for this control");var e={proximity:t.proximity,countries:t.countries,placeholder:t.placeholder,zoom:t.zoom,bbox:t.bbox,types:t.types,flyTo:t.flyTo,minLength:t.minLength,limit:t.limit,language:t.language,filter:t.filter,localGeocoder:t.localGeocoder,accessToken:t.accessToken||t.MAPBOX_GEOCODER_API_KEY,mapboxgl:t.mapboxgl,marker:t.marker};Object.keys(e).forEach((function(t){var n=t;void 0===e[n]&&delete e[n]})),t.geocoder=new c.default(e),t.hookEvents(t),t.addControl()})),this.searchInput&&this.MapService.mapLoaded$.subscribe((function(){t.geocoder.query(t.searchInput)}))},t.prototype.ngOnChanges=function(t){this.geocoder&&(t.proximity&&!t.proximity.isFirstChange()&&this.geocoder.setProximity(t.proximity.currentValue),t.searchInput&&this.geocoder.query(this.searchInput))},t.prototype.addControl=function(){this.ControlComponent.control=this.geocoder,this.MapService.addControl(this.ControlComponent.control,this.ControlComponent.position)},t.prototype.hookEvents=function(t){var e=this;this.warnDeprecatedOutputs(t),(t.results.observers.length||t.geocoderResults.observers.length)&&this.geocoder.on("results",(function(n){return e.zone.run((function(){t.geocoderResults.emit(n),t.results.emit(n)}))})),(t.geocoderResult.observers.length||t.result.observers.length)&&this.geocoder.on("result",(function(n){e.lastResultId!==n.result.id&&(e.lastResultId=n.result.id,e.zone.run((function(){t.geocoderResult.emit(n),t.result.emit(n)})))})),(t.error.observers.length||t.geocoderError.observers.length)&&this.geocoder.on("error",(function(n){return e.zone.run((function(){t.geocoderError.emit(n),t.error.emit(n)}))})),t.loading.observers.length&&this.geocoder.on("loading",(function(n){return e.zone.run((function(){return t.loading.emit(n)}))})),t.clear.observers.length&&this.geocoder.on("clear",(function(){return e.zone.run((function(){return t.clear.emit()}))}))},t.prototype.warnDeprecatedOutputs=function(e){var n=E.bind(void 0,t.name);e.results.observers.length&&n("results","geocoderResults"),e.result.observers.length&&n("result","geocoderResult"),e.error.observers.length&&n("error","geocoderError")},t}();I.decorators=[{type:n.Directive,args:[{selector:"[mglGeocoder]"}]}],I.ctorParameters=function(){return[{type:g},{type:n.NgZone},{type:y,decorators:[{type:n.Host}]},{type:String,decorators:[{type:n.Optional},{type:n.Inject,args:[C]}]}]},I.propDecorators={countries:[{type:n.Input}],placeholder:[{type:n.Input}],zoom:[{type:n.Input}],bbox:[{type:n.Input}],types:[{type:n.Input}],flyTo:[{type:n.Input}],minLength:[{type:n.Input}],limit:[{type:n.Input}],language:[{type:n.Input}],accessToken:[{type:n.Input}],filter:[{type:n.Input}],localGeocoder:[{type:n.Input}],mapboxgl:[{type:n.Input}],marker:[{type:n.Input}],proximity:[{type:n.Input}],searchInput:[{type:n.Input}],clear:[{type:n.Output}],loading:[{type:n.Output}],geocoderResults:[{type:n.Output}],geocoderResult:[{type:n.Output}],geocoderError:[{type:n.Output}],results:[{type:n.Output}],result:[{type:n.Output}],error:[{type:n.Output}]};var O=function(){function t(t,e){this.MapService=t,this.ControlComponent=e,this.geolocate=new n.EventEmitter}return t.prototype.ngAfterContentInit=function(){var t=this;this.MapService.mapCreated$.subscribe((function(){if(t.ControlComponent.control)throw new Error("Another control is already set for this control");var e={positionOptions:t.positionOptions,fitBoundsOptions:t.fitBoundsOptions,trackUserLocation:t.trackUserLocation,showUserLocation:t.showUserLocation};Object.keys(e).forEach((function(t){var n=t;void 0===e[n]&&delete e[n]})),t.ControlComponent.control=new r.GeolocateControl(e),t.ControlComponent.control.on("geolocate",(function(e){t.geolocate.emit(e)})),t.MapService.addControl(t.ControlComponent.control,t.ControlComponent.position)}))},t}();O.decorators=[{type:n.Directive,args:[{selector:"[mglGeolocate]"}]}],O.ctorParameters=function(){return[{type:g},{type:y,decorators:[{type:n.Host}]}]},O.propDecorators={positionOptions:[{type:n.Input}],fitBoundsOptions:[{type:n.Input}],trackUserLocation:[{type:n.Input}],showUserLocation:[{type:n.Input}],geolocate:[{type:n.Output}]};var M=function(){function t(t,e){this.MapService=t,this.ControlComponent=e}return t.prototype.ngAfterContentInit=function(){var t=this;this.MapService.mapCreated$.subscribe((function(){if(t.ControlComponent.control)throw new Error("Another control is already set for this control");var e={};void 0!==t.showCompass&&(e.showCompass=t.showCompass),void 0!==t.showZoom&&(e.showZoom=t.showZoom),t.ControlComponent.control=new r.NavigationControl(e),t.MapService.addControl(t.ControlComponent.control,t.ControlComponent.position)}))},t}();M.decorators=[{type:n.Directive,args:[{selector:"[mglNavigation]"}]}],M.ctorParameters=function(){return[{type:g},{type:y,decorators:[{type:n.Host}]}]},M.propDecorators={showCompass:[{type:n.Input}],showZoom:[{type:n.Input}]};var S=function(){function t(t,e){this.MapService=t,this.ControlComponent=e}return t.prototype.ngOnChanges=function(t){t.unit&&!t.unit.isFirstChange()&&this.ControlComponent.control.setUnit(t.unit.currentValue)},t.prototype.ngAfterContentInit=function(){var t=this;this.MapService.mapCreated$.subscribe((function(){if(t.ControlComponent.control)throw new Error("Another control is already set for this control");var e={};void 0!==t.maxWidth&&(e.maxWidth=t.maxWidth),void 0!==t.unit&&(e.unit=t.unit),t.ControlComponent.control=new r.ScaleControl(e),t.MapService.addControl(t.ControlComponent.control,t.ControlComponent.position)}))},t}();S.decorators=[{type:n.Directive,args:[{selector:"[mglScale]"}]}],S.ctorParameters=function(){return[{type:g},{type:y,decorators:[{type:n.Host}]}]},S.propDecorators={maxWidth:[{type:n.Input}],unit:[{type:n.Input}]};var w=function(){function t(t,e){this.MapService=t,this.zone=e,this.updateFeatureData=new o.Subject,this.sub=new o.Subscription,this.sourceAdded=!1,this.featureIdCounter=0}return t.prototype.ngOnInit=function(){var t=this;this.data||(this.data={type:"FeatureCollection",features:[]});var e=this.MapService.mapLoaded$.subscribe((function(){t.init();var e=o.fromEvent(t.MapService.mapInstance,"styledata").pipe(i.filter((function(){return!t.MapService.mapInstance.getSource(t.id)}))).subscribe((function(){t.init()}));t.sub.add(e)}));this.sub.add(e)},t.prototype.ngOnChanges=function(t){this.sourceAdded&&((t.maxzoom&&!t.maxzoom.isFirstChange()||t.attribution&&!t.attribution.isFirstChange()||t.buffer&&!t.buffer.isFirstChange()||t.tolerance&&!t.tolerance.isFirstChange()||t.cluster&&!t.cluster.isFirstChange()||t.clusterRadius&&!t.clusterRadius.isFirstChange()||t.clusterMaxZoom&&!t.clusterMaxZoom.isFirstChange()||t.clusterMinPoints&&!t.clusterMinPoints.isFirstChange()||t.clusterProperties&&!t.clusterProperties.isFirstChange()||t.lineMetrics&&!t.lineMetrics.isFirstChange()||t.generateId&&!t.generateId.isFirstChange()||t.promoteId&&!t.promoteId.isFirstChange()||t.filter&&!t.filter.isFirstChange())&&(this.ngOnDestroy(),this.ngOnInit()),t.data&&!t.data.isFirstChange()&&this.MapService.getSource(this.id).setData(this.data))},t.prototype.ngOnDestroy=function(){this.sub.unsubscribe(),this.sourceAdded&&(this.MapService.removeSource(this.id),this.sourceAdded=!1)},t.prototype.getClusterExpansionZoom=function(t){return h(this,void 0,void 0,(function(){var e,n=this;return l(this,(function(r){return e=this.MapService.getSource(this.id),[2,this.zone.run((function(){return h(n,void 0,void 0,(function(){return l(this,(function(n){return[2,new Promise((function(n,r){e.getClusterExpansionZoom(t,(function(t,e){t?r(t):n(e)}))}))]}))}))}))]}))}))},t.prototype.getClusterChildren=function(t){return h(this,void 0,void 0,(function(){var e,n=this;return l(this,(function(r){return e=this.MapService.getSource(this.id),[2,this.zone.run((function(){return h(n,void 0,void 0,(function(){return l(this,(function(n){return[2,new Promise((function(n,r){e.getClusterChildren(t,(function(t,e){t?r(t):n(e)}))}))]}))}))}))]}))}))},t.prototype.getClusterLeaves=function(t,e,n){return h(this,void 0,void 0,(function(){var r,o=this;return l(this,(function(i){return r=this.MapService.getSource(this.id),[2,this.zone.run((function(){return h(o,void 0,void 0,(function(){return l(this,(function(o){return[2,new Promise((function(o,i){r.getClusterLeaves(t,e,n,(function(t,e){t?i(t):o(e)}))}))]}))}))}))]}))}))},t.prototype._addFeature=function(t){this.data.features.push(t),this.updateFeatureData.next()},t.prototype._removeFeature=function(t){var e=this.data,n=e.features.indexOf(t);n>-1&&e.features.splice(n,1),this.updateFeatureData.next()},t.prototype._getNewFeatureId=function(){return++this.featureIdCounter},t.prototype.init=function(){var t=this,e={type:"geojson",data:this.data,maxzoom:this.maxzoom,attribution:this.attribution,buffer:this.buffer,tolerance:this.tolerance,cluster:this.cluster,clusterRadius:this.clusterRadius,clusterMaxZoom:this.clusterMaxZoom,clusterMinPoints:this.clusterMinPoints,clusterProperties:this.clusterProperties,lineMetrics:this.lineMetrics,generateId:this.generateId,promoteId:this.promoteId,filter:this.filter};this.MapService.addSource(this.id,e);var n=this.updateFeatureData.pipe(i.debounceTime(0)).subscribe((function(){t.MapService.getSource(t.id).setData(t.data)}));this.sub.add(n),this.sourceAdded=!0},t}();w.decorators=[{type:n.Component,args:[{selector:"mgl-geojson-source",template:"",changeDetection:n.ChangeDetectionStrategy.OnPush}]}],w.ctorParameters=function(){return[{type:g},{type:n.NgZone}]},w.propDecorators={id:[{type:n.Input}],data:[{type:n.Input}],maxzoom:[{type:n.Input}],attribution:[{type:n.Input}],buffer:[{type:n.Input}],tolerance:[{type:n.Input}],cluster:[{type:n.Input}],clusterRadius:[{type:n.Input}],clusterMaxZoom:[{type:n.Input}],clusterMinPoints:[{type:n.Input}],clusterProperties:[{type:n.Input}],lineMetrics:[{type:n.Input}],generateId:[{type:n.Input}],promoteId:[{type:n.Input}],filter:[{type:n.Input}]};var k=function(){function t(t){this.GeoJSONSourceComponent=t,this.type="Feature"}return t.prototype.ngOnInit=function(){this.id||(this.id=this.GeoJSONSourceComponent._getNewFeatureId()),this.feature={type:this.type,geometry:this.geometry,properties:this.properties?this.properties:{}},this.feature.id=this.id,this.GeoJSONSourceComponent._addFeature(this.feature)},t.prototype.ngOnDestroy=function(){this.GeoJSONSourceComponent._removeFeature(this.feature)},t.prototype.updateCoordinates=function(t){this.feature.geometry.coordinates=t,this.GeoJSONSourceComponent.updateFeatureData.next()},t}();k.decorators=[{type:n.Component,args:[{selector:"mgl-feature",template:"",changeDetection:n.ChangeDetectionStrategy.OnPush}]}],k.ctorParameters=function(){return[{type:w,decorators:[{type:n.Inject,args:[n.forwardRef((function(){return w}))]}]}]},k.propDecorators={id:[{type:n.Input}],geometry:[{type:n.Input}],properties:[{type:n.Input}]};var D=function(){function t(t,e,r){this.MapService=t,this.NgZone=e,this.FeatureComponent=r,this.featureDragStart=new n.EventEmitter,this.featureDragEnd=new n.EventEmitter,this.featureDrag=new n.EventEmitter,this.dragStart=new n.EventEmitter,this.dragEnd=new n.EventEmitter,this.drag=new n.EventEmitter,this.sub=new o.Subscription}return t.prototype.ngOnInit=function(){var t,e,n;if(this.warnDeprecatedOutputs(),!this.FeatureComponent||!this.layer)throw new Error("mglDraggable can only be used on Feature (with a layer as input) or Marker");if(t=this.layer.layerMouseEnter,e=this.layer.layerMouseLeave,n=this.FeatureComponent.updateCoordinates.bind(this.FeatureComponent),"Point"!==this.FeatureComponent.geometry.type)throw new Error("mglDraggable only support point feature");this.handleDraggable(t,e,n)},t.prototype.ngOnDestroy=function(){this.sub.unsubscribe()},t.prototype.handleDraggable=function(t,e,n){var r=this,s=!1,a=!1;this.MapService.mapCreated$.subscribe((function(){var u=o.fromEvent(r.MapService.mapInstance,"mouseup"),p=t.pipe(i.filter((function(){return!s})),i.filter((function(t){return r.filterFeature(t)})),i.tap((function(){a=!0,r.MapService.changeCanvasCursor("move"),r.MapService.updateDragPan(!1)})),i.switchMap((function(){return o.fromEvent(r.MapService.mapInstance,"mousedown").pipe(i.takeUntil(e))}))),c=p.pipe(i.switchMap((function(){return o.fromEvent(r.MapService.mapInstance,"mousemove").pipe(i.takeUntil(u))}))),h=p.pipe(i.switchMap((function(){return u.pipe(i.take(1))})));r.sub.add(p.subscribe((function(t){s=!0,(r.featureDragStart.observers.length||r.dragStart.observers.length)&&r.NgZone.run((function(){r.featureDragStart.emit(t),r.dragStart.emit(t)}))}))),r.sub.add(c.subscribe((function(t){n([t.lngLat.lng,t.lngLat.lat]),(r.featureDrag.observers.length||r.drag.observers.length)&&r.NgZone.run((function(){r.featureDrag.emit(t),r.drag.emit(t)}))}))),r.sub.add(h.subscribe((function(t){s=!1,(r.featureDragEnd.observers.length||r.dragEnd.observers.length)&&r.NgZone.run((function(){r.featureDragEnd.emit(t),r.dragEnd.emit(t)})),a||(r.MapService.changeCanvasCursor(""),r.MapService.updateDragPan(!0))}))),r.sub.add(e.pipe(i.tap((function(){return a=!1})),i.filter((function(){return!s}))).subscribe((function(){r.MapService.changeCanvasCursor(""),r.MapService.updateDragPan(!0)})))}))},t.prototype.filterFeature=function(t){if(this.FeatureComponent&&this.layer&&!this.MapService.queryRenderedFeatures(t.point,{layers:[this.layer.id],filter:["all",["==","$type","Point"],["==","$id",this.FeatureComponent.id]]})[0])return!1;return!0},t.prototype.warnDeprecatedOutputs=function(){var e=E.bind(void 0,t.name);this.dragStart.observers.length&&e("dragStart","featureDragStart"),this.dragEnd.observers.length&&e("dragEnd","featureDragEnd"),this.drag.observers.length&&e("drag","featureDrag")},t}();D.decorators=[{type:n.Directive,args:[{selector:"[mglDraggable]"}]}],D.ctorParameters=function(){return[{type:g},{type:n.NgZone},{type:k,decorators:[{type:n.Optional},{type:n.Host}]}]},D.propDecorators={layer:[{type:n.Input,args:["mglDraggable"]}],featureDragStart:[{type:n.Output}],featureDragEnd:[{type:n.Output}],featureDrag:[{type:n.Output}],dragStart:[{type:n.Output}],dragEnd:[{type:n.Output}],drag:[{type:n.Output}]};var z=function(){function t(t,e){this.MapService=t,this.zone=e,this.imageError=new n.EventEmitter,this.imageLoaded=new n.EventEmitter,this.error=new n.EventEmitter,this.loaded=new n.EventEmitter,this.isAdded=!1,this.isAdding=!1}return t.prototype.ngOnInit=function(){var t=this;this.warnDeprecatedOutputs(),this.sub=this.MapService.mapLoaded$.pipe(i.switchMap((function(){return o.fromEvent(t.MapService.mapInstance,"styledata").pipe(i.startWith(void 0),i.filter((function(){return!t.isAdding&&!t.MapService.mapInstance.hasImage(t.id)})))}))).subscribe((function(){return t.init()}))},t.prototype.ngOnChanges=function(t){(t.data&&!t.data.isFirstChange()||t.options&&!t.options.isFirstChange()||t.url&&!t.url.isFirstChange())&&(this.ngOnDestroy(),this.ngOnInit())},t.prototype.ngOnDestroy=function(){this.isAdded&&this.MapService.removeImage(this.id),this.sub&&this.sub.unsubscribe()},t.prototype.init=function(){return h(this,void 0,void 0,(function(){var t,e=this;return l(this,(function(n){switch(n.label){case 0:return this.isAdding=!0,this.data?(this.MapService.addImage(this.id,this.data,this.options),this.isAdded=!0,this.isAdding=!1,[3,5]):[3,1];case 1:if(!this.url)return[3,5];n.label=2;case 2:return n.trys.push([2,4,,5]),[4,this.MapService.loadAndAddImage(this.id,this.url,this.options)];case 3:return n.sent(),this.isAdded=!0,this.isAdding=!1,this.zone.run((function(){e.imageLoaded.emit(),e.loaded.emit()})),[3,5];case 4:return t=n.sent(),this.zone.run((function(){e.imageError.emit(t),e.error.emit(t)})),[3,5];case 5:return[2]}}))}))},t.prototype.warnDeprecatedOutputs=function(){var e=E.bind(void 0,t.name);this.error.observers.length&&e("error","imageError"),this.loaded.observers.length&&e("loaded","imageLoaded")},t}();z.decorators=[{type:n.Component,args:[{selector:"mgl-image",template:""}]}],z.ctorParameters=function(){return[{type:g},{type:n.NgZone}]},z.propDecorators={id:[{type:n.Input}],data:[{type:n.Input}],options:[{type:n.Input}],url:[{type:n.Input}],imageError:[{type:n.Output}],imageLoaded:[{type:n.Output}],error:[{type:n.Output}],loaded:[{type:n.Output}]};var x=function(){function t(t){this.MapService=t,this.layerClick=new n.EventEmitter,this.layerDblClick=new n.EventEmitter,this.layerMouseDown=new n.EventEmitter,this.layerMouseUp=new n.EventEmitter,this.layerMouseEnter=new n.EventEmitter,this.layerMouseLeave=new n.EventEmitter,this.layerMouseMove=new n.EventEmitter,this.layerMouseOver=new n.EventEmitter,this.layerMouseOut=new n.EventEmitter,this.layerContextMenu=new n.EventEmitter,this.layerTouchStart=new n.EventEmitter,this.layerTouchEnd=new n.EventEmitter,this.layerTouchCancel=new n.EventEmitter,this.click=new n.EventEmitter,this.dblClick=new n.EventEmitter,this.mouseDown=new n.EventEmitter,this.mouseUp=new n.EventEmitter,this.mouseEnter=new n.EventEmitter,this.mouseLeave=new n.EventEmitter,this.mouseMove=new n.EventEmitter,this.mouseOver=new n.EventEmitter,this.mouseOut=new n.EventEmitter,this.contextMenu=new n.EventEmitter,this.touchStart=new n.EventEmitter,this.touchEnd=new n.EventEmitter,this.touchCancel=new n.EventEmitter,this.layerAdded=!1}return t.prototype.ngOnInit=function(){var t=this;this.warnDeprecatedOutputs(),this.sub=this.MapService.mapLoaded$.pipe(i.switchMap((function(){return o.fromEvent(t.MapService.mapInstance,"styledata").pipe(i.mapTo(!1),i.filter((function(){return!t.MapService.mapInstance.getLayer(t.id)})),i.startWith(!0))}))).subscribe((function(e){return t.init(e)}))},t.prototype.ngOnChanges=function(t){this.layerAdded&&(t.paint&&!t.paint.isFirstChange()&&this.MapService.setAllLayerPaintProperty(this.id,t.paint.currentValue),t.layout&&!t.layout.isFirstChange()&&this.MapService.setAllLayerLayoutProperty(this.id,t.layout.currentValue),t.filter&&!t.filter.isFirstChange()&&this.MapService.setLayerFilter(this.id,t.filter.currentValue),t.before&&!t.before.isFirstChange()&&this.MapService.setLayerBefore(this.id,t.before.currentValue),(t.minzoom&&!t.minzoom.isFirstChange()||t.maxzoom&&!t.maxzoom.isFirstChange())&&this.MapService.setLayerZoomRange(this.id,this.minzoom,this.maxzoom))},t.prototype.ngOnDestroy=function(){this.layerAdded&&this.MapService.removeLayer(this.id),this.sub&&this.sub.unsubscribe()},t.prototype.init=function(t){var e={layerOptions:{id:this.id,type:this.type,source:this.source,metadata:this.metadata,"source-layer":this.sourceLayer,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this.layout,paint:this.paint},layerEvents:{layerClick:this.layerClick,layerDblClick:this.layerDblClick,layerMouseDown:this.layerMouseDown,layerMouseUp:this.layerMouseUp,layerMouseEnter:this.layerMouseEnter,layerMouseLeave:this.layerMouseLeave,layerMouseMove:this.layerMouseMove,layerMouseOver:this.layerMouseOver,layerMouseOut:this.layerMouseOut,layerContextMenu:this.layerContextMenu,layerTouchStart:this.layerTouchStart,layerTouchEnd:this.layerTouchEnd,layerTouchCancel:this.layerTouchCancel,click:this.click,dblClick:this.dblClick,mouseDown:this.mouseDown,mouseUp:this.mouseUp,mouseEnter:this.mouseEnter,mouseLeave:this.mouseLeave,mouseMove:this.mouseMove,mouseOver:this.mouseOver,mouseOut:this.mouseOut,contextMenu:this.contextMenu,touchStart:this.touchStart,touchEnd:this.touchEnd,touchCancel:this.touchCancel}};this.MapService.addLayer(e,t,this.before),this.layerAdded=!0},t.prototype.warnDeprecatedOutputs=function(){var e=E.bind(void 0,t.name);this.click.observers.length&&e("click","layerClick"),this.dblClick.observers.length&&e("dblClick","layerDblClick"),this.mouseDown.observers.length&&e("mouseDown","layerMouseDown"),this.mouseUp.observers.length&&e("mouseUp","layerMouseUp"),this.mouseEnter.observers.length&&e("mouseEnter","layerMouseEnter"),this.mouseLeave.observers.length&&e("mouseLeave","layerMouseLeave"),this.mouseMove.observers.length&&e("mouseMove","layerMouseMove"),this.mouseOver.observers.length&&e("mouseOver","layerMouseOver"),this.mouseOut.observers.length&&e("mouseOut","layerMouseOut"),this.contextMenu.observers.length&&e("contextMenu","layerContextMenu"),this.touchStart.observers.length&&e("touchStart","layerTouchStart"),this.touchEnd.observers.length&&e("touchEnd","layerTouchEnd"),this.touchCancel.observers.length&&e("touchCancel","layerTouchCancel")},t}();x.decorators=[{type:n.Component,args:[{selector:"mgl-layer",template:""}]}],x.ctorParameters=function(){return[{type:g}]},x.propDecorators={id:[{type:n.Input}],source:[{type:n.Input}],type:[{type:n.Input}],metadata:[{type:n.Input}],sourceLayer:[{type:n.Input}],filter:[{type:n.Input}],layout:[{type:n.Input}],paint:[{type:n.Input}],before:[{type:n.Input}],minzoom:[{type:n.Input}],maxzoom:[{type:n.Input}],layerClick:[{type:n.Output}],layerDblClick:[{type:n.Output}],layerMouseDown:[{type:n.Output}],layerMouseUp:[{type:n.Output}],layerMouseEnter:[{type:n.Output}],layerMouseLeave:[{type:n.Output}],layerMouseMove:[{type:n.Output}],layerMouseOver:[{type:n.Output}],layerMouseOut:[{type:n.Output}],layerContextMenu:[{type:n.Output}],layerTouchStart:[{type:n.Output}],layerTouchEnd:[{type:n.Output}],layerTouchCancel:[{type:n.Output}],click:[{type:n.Output}],dblClick:[{type:n.Output}],mouseDown:[{type:n.Output}],mouseUp:[{type:n.Output}],mouseEnter:[{type:n.Output}],mouseLeave:[{type:n.Output}],mouseMove:[{type:n.Output}],mouseOver:[{type:n.Output}],mouseOut:[{type:n.Output}],contextMenu:[{type:n.Output}],touchStart:[{type:n.Output}],touchEnd:[{type:n.Output}],touchCancel:[{type:n.Output}]};var P=function(){function t(t){this.MapService=t,this.movingMethod="flyTo",this.mapResize=new n.EventEmitter,this.mapRemove=new n.EventEmitter,this.mapMouseDown=new n.EventEmitter,this.mapMouseUp=new n.EventEmitter,this.mapMouseMove=new n.EventEmitter,this.mapClick=new n.EventEmitter,this.mapDblClick=new n.EventEmitter,this.mapMouseOver=new n.EventEmitter,this.mapMouseOut=new n.EventEmitter,this.mapContextMenu=new n.EventEmitter,this.mapTouchStart=new n.EventEmitter,this.mapTouchEnd=new n.EventEmitter,this.mapTouchMove=new n.EventEmitter,this.mapTouchCancel=new n.EventEmitter,this.mapWheel=new n.EventEmitter,this.moveStart=new n.EventEmitter,this.move=new n.EventEmitter,this.moveEnd=new n.EventEmitter,this.mapDragStart=new n.EventEmitter,this.mapDrag=new n.EventEmitter,this.mapDragEnd=new n.EventEmitter,this.zoomStart=new n.EventEmitter,this.zoomEvt=new n.EventEmitter,this.zoomEnd=new n.EventEmitter,this.rotateStart=new n.EventEmitter,this.rotate=new n.EventEmitter,this.rotateEnd=new n.EventEmitter,this.pitchStart=new n.EventEmitter,this.pitchEvt=new n.EventEmitter,this.pitchEnd=new n.EventEmitter,this.boxZoomStart=new n.EventEmitter,this.boxZoomEnd=new n.EventEmitter,this.boxZoomCancel=new n.EventEmitter,this.webGlContextLost=new n.EventEmitter,this.webGlContextRestored=new n.EventEmitter,this.mapLoad=new n.EventEmitter,this.idle=new n.EventEmitter,this.render=new n.EventEmitter,this.mapError=new n.EventEmitter,this.data=new n.EventEmitter,this.styleData=new n.EventEmitter,this.sourceData=new n.EventEmitter,this.dataLoading=new n.EventEmitter,this.styleDataLoading=new n.EventEmitter,this.sourceDataLoading=new n.EventEmitter,this.styleImageMissing=new n.EventEmitter,this.resize=new n.EventEmitter,this.remove=new n.EventEmitter,this.mouseDown=new n.EventEmitter,this.mouseUp=new n.EventEmitter,this.mouseMove=new n.EventEmitter,this.click=new n.EventEmitter,this.dblClick=new n.EventEmitter,this.mouseOver=new n.EventEmitter,this.mouseOut=new n.EventEmitter,this.contextMenu=new n.EventEmitter,this.touchStart=new n.EventEmitter,this.touchEnd=new n.EventEmitter,this.touchMove=new n.EventEmitter,this.touchCancel=new n.EventEmitter,this.wheel=new n.EventEmitter,this.dragStart=new n.EventEmitter,this.drag=new n.EventEmitter,this.dragEnd=new n.EventEmitter,this.load=new n.EventEmitter,this.error=new n.EventEmitter}return Object.defineProperty(t.prototype,"mapInstance",{get:function(){return this.MapService.mapInstance},enumerable:!1,configurable:!0}),t.prototype.ngAfterViewInit=function(){this.warnDeprecatedOutputs(),this.MapService.setup({accessToken:this.accessToken,customMapboxApiUrl:this.customMapboxApiUrl,mapOptions:{collectResourceTiming:this.collectResourceTiming,container:this.mapContainer.nativeElement,crossSourceCollisions:this.crossSourceCollisions,fadeDuration:this.fadeDuration,minZoom:this.minZoom,maxZoom:this.maxZoom,minPitch:this.minPitch,maxPitch:this.maxPitch,style:this.style,hash:this.hash,interactive:this.interactive,bearingSnap:this.bearingSnap,pitchWithRotate:this.pitchWithRotate,clickTolerance:this.clickTolerance,attributionControl:this.attributionControl,logoPosition:this.logoPosition,failIfMajorPerformanceCaveat:this.failIfMajorPerformanceCaveat,preserveDrawingBuffer:this.preserveDrawingBuffer,refreshExpiredTiles:this.refreshExpiredTiles,maxBounds:this.maxBounds,scrollZoom:this.scrollZoom,boxZoom:this.boxZoom,dragRotate:this.dragRotate,dragPan:this.dragPan,keyboard:this.keyboard,doubleClickZoom:this.doubleClickZoom,touchPitch:this.touchPitch,touchZoomRotate:this.touchZoomRotate,trackResize:this.trackResize,center:this.center,zoom:this.zoom,bearing:this.bearing,pitch:this.pitch,renderWorldCopies:this.renderWorldCopies,maxTileCacheSize:this.maxTileCacheSize,localIdeographFontFamily:this.localIdeographFontFamily,transformRequest:this.transformRequest,bounds:this.bounds?this.bounds:this.fitBounds,fitBoundsOptions:this.fitBoundsOptions,antialias:this.antialias,locale:this.locale},mapEvents:this}),this.cursorStyle&&this.MapService.changeCanvasCursor(this.cursorStyle)},t.prototype.ngOnDestroy=function(){this.MapService.destroyMap()},t.prototype.ngOnChanges=function(t){return h(this,void 0,void 0,(function(){return l(this,(function(e){switch(e.label){case 0:return[4,this.MapService.mapCreated$.toPromise()];case 1:return e.sent(),t.cursorStyle&&!t.cursorStyle.isFirstChange()&&this.MapService.changeCanvasCursor(t.cursorStyle.currentValue),t.minZoom&&!t.minZoom.isFirstChange()&&this.MapService.updateMinZoom(t.minZoom.currentValue),t.maxZoom&&!t.maxZoom.isFirstChange()&&this.MapService.updateMaxZoom(t.maxZoom.currentValue),t.minPitch&&!t.minPitch.isFirstChange()&&this.MapService.updateMinPitch(t.minPitch.currentValue),t.maxPitch&&!t.maxPitch.isFirstChange()&&this.MapService.updateMaxPitch(t.maxPitch.currentValue),t.renderWorldCopies&&!t.renderWorldCopies.isFirstChange()&&this.MapService.updateRenderWorldCopies(t.renderWorldCopies.currentValue),t.scrollZoom&&!t.scrollZoom.isFirstChange()&&this.MapService.updateScrollZoom(t.scrollZoom.currentValue),t.dragRotate&&!t.dragRotate.isFirstChange()&&this.MapService.updateDragRotate(t.dragRotate.currentValue),t.touchPitch&&!t.touchPitch.isFirstChange()&&this.MapService.updateTouchPitch(t.touchPitch.currentValue),t.touchZoomRotate&&!t.touchZoomRotate.isFirstChange()&&this.MapService.updateTouchZoomRotate(t.touchZoomRotate.currentValue),t.doubleClickZoom&&!t.doubleClickZoom.isFirstChange()&&this.MapService.updateDoubleClickZoom(t.doubleClickZoom.currentValue),t.keyboard&&!t.keyboard.isFirstChange()&&this.MapService.updateKeyboard(t.keyboard.currentValue),t.dragPan&&!t.dragPan.isFirstChange()&&this.MapService.updateDragPan(t.dragPan.currentValue),t.boxZoom&&!t.boxZoom.isFirstChange()&&this.MapService.updateBoxZoom(t.boxZoom.currentValue),t.style&&!t.style.isFirstChange()&&this.MapService.updateStyle(t.style.currentValue),t.maxBounds&&!t.maxBounds.isFirstChange()&&this.MapService.updateMaxBounds(t.maxBounds.currentValue),t.fitBounds&&t.fitBounds.currentValue&&!t.fitBounds.isFirstChange()&&this.MapService.fitBounds(t.fitBounds.currentValue,this.fitBoundsOptions),t.fitScreenCoordinates&&t.fitScreenCoordinates.currentValue&&((this.center||this.zoom||this.pitch||this.fitBounds)&&t.fitScreenCoordinates.isFirstChange()&&console.warn("[ngx-mapbox-gl] center / zoom / pitch / fitBounds inputs are being overridden by fitScreenCoordinates input"),this.MapService.fitScreenCoordinates(t.fitScreenCoordinates.currentValue,this.bearing?this.bearing[0]:0,this.movingOptions)),!this.centerWithPanTo||!t.center||t.center.isFirstChange()||t.zoom||t.bearing||t.pitch?(t.center&&!t.center.isFirstChange()||t.zoom&&!t.zoom.isFirstChange()||t.bearing&&!t.bearing.isFirstChange()&&!t.fitScreenCoordinates||t.pitch&&!t.pitch.isFirstChange())&&this.MapService.move(this.movingMethod,this.movingOptions,t.zoom&&this.zoom?this.zoom[0]:void 0,t.center?this.center:void 0,t.bearing&&this.bearing?this.bearing[0]:void 0,t.pitch&&this.pitch?this.pitch[0]:void 0):this.MapService.panTo(this.center,this.panToOptions),[2]}}))}))},t.prototype.warnDeprecatedOutputs=function(){var e=E.bind(void 0,t.name);this.resize.observers.length&&e("resize","mapResize"),this.remove.observers.length&&e("remove","mapRemove"),this.mouseDown.observers.length&&e("mouseDown","mapMouseDown"),this.mouseUp.observers.length&&e("mouseUp","mapMouseUp"),this.mouseMove.observers.length&&e("mouseMove","mapMouseMove"),this.click.observers.length&&e("click","mapClick"),this.dblClick.observers.length&&e("dblClick","mapDblClick"),this.mouseOver.observers.length&&e("mouseOver","mapMouseOver"),this.mouseOut.observers.length&&e("mouseOut","mapMouseOut"),this.contextMenu.observers.length&&e("contextMenu","mapContextMenu"),this.touchStart.observers.length&&e("touchStart","mapTouchStart"),this.touchEnd.observers.length&&e("touchEnd","mapTouchEnd"),this.touchMove.observers.length&&e("touchMove","mapTouchMove"),this.touchCancel.observers.length&&e("touchCancel","mapTouchCancel"),this.wheel.observers.length&&e("wheel","mapWheel"),this.dragStart.observers.length&&e("dragStart","mapDragStart"),this.drag.observers.length&&e("drag","mapDrag"),this.dragEnd.observers.length&&e("dragEnd","mapDragEnd"),this.load.observers.length&&e("load","mapLoad"),this.error.observers.length&&e("error","mapError")},t}();P.decorators=[{type:n.Component,args:[{selector:"mgl-map",template:"<div #container></div>",providers:[g],changeDetection:n.ChangeDetectionStrategy.OnPush,styles:["\n      :host {\n        display: block;\n      }\n      div {\n        height: 100%;\n        width: 100%;\n      }\n    "]}]}],P.ctorParameters=function(){return[{type:g}]},P.propDecorators={accessToken:[{type:n.Input}],collectResourceTiming:[{type:n.Input}],crossSourceCollisions:[{type:n.Input}],customMapboxApiUrl:[{type:n.Input}],fadeDuration:[{type:n.Input}],hash:[{type:n.Input}],refreshExpiredTiles:[{type:n.Input}],failIfMajorPerformanceCaveat:[{type:n.Input}],bearingSnap:[{type:n.Input}],interactive:[{type:n.Input}],pitchWithRotate:[{type:n.Input}],clickTolerance:[{type:n.Input}],attributionControl:[{type:n.Input}],logoPosition:[{type:n.Input}],maxTileCacheSize:[{type:n.Input}],localIdeographFontFamily:[{type:n.Input}],preserveDrawingBuffer:[{type:n.Input}],trackResize:[{type:n.Input}],transformRequest:[{type:n.Input}],bounds:[{type:n.Input}],antialias:[{type:n.Input}],locale:[{type:n.Input}],minZoom:[{type:n.Input}],maxZoom:[{type:n.Input}],minPitch:[{type:n.Input}],maxPitch:[{type:n.Input}],scrollZoom:[{type:n.Input}],dragRotate:[{type:n.Input}],touchPitch:[{type:n.Input}],touchZoomRotate:[{type:n.Input}],doubleClickZoom:[{type:n.Input}],keyboard:[{type:n.Input}],dragPan:[{type:n.Input}],boxZoom:[{type:n.Input}],style:[{type:n.Input}],center:[{type:n.Input}],maxBounds:[{type:n.Input}],zoom:[{type:n.Input}],bearing:[{type:n.Input}],pitch:[{type:n.Input}],fitBoundsOptions:[{type:n.Input}],renderWorldCopies:[{type:n.Input}],movingMethod:[{type:n.Input}],movingOptions:[{type:n.Input}],fitBounds:[{type:n.Input}],fitScreenCoordinates:[{type:n.Input}],centerWithPanTo:[{type:n.Input}],panToOptions:[{type:n.Input}],cursorStyle:[{type:n.Input}],mapResize:[{type:n.Output}],mapRemove:[{type:n.Output}],mapMouseDown:[{type:n.Output}],mapMouseUp:[{type:n.Output}],mapMouseMove:[{type:n.Output}],mapClick:[{type:n.Output}],mapDblClick:[{type:n.Output}],mapMouseOver:[{type:n.Output}],mapMouseOut:[{type:n.Output}],mapContextMenu:[{type:n.Output}],mapTouchStart:[{type:n.Output}],mapTouchEnd:[{type:n.Output}],mapTouchMove:[{type:n.Output}],mapTouchCancel:[{type:n.Output}],mapWheel:[{type:n.Output}],moveStart:[{type:n.Output}],move:[{type:n.Output}],moveEnd:[{type:n.Output}],mapDragStart:[{type:n.Output}],mapDrag:[{type:n.Output}],mapDragEnd:[{type:n.Output}],zoomStart:[{type:n.Output}],zoomEvt:[{type:n.Output}],zoomEnd:[{type:n.Output}],rotateStart:[{type:n.Output}],rotate:[{type:n.Output}],rotateEnd:[{type:n.Output}],pitchStart:[{type:n.Output}],pitchEvt:[{type:n.Output}],pitchEnd:[{type:n.Output}],boxZoomStart:[{type:n.Output}],boxZoomEnd:[{type:n.Output}],boxZoomCancel:[{type:n.Output}],webGlContextLost:[{type:n.Output}],webGlContextRestored:[{type:n.Output}],mapLoad:[{type:n.Output}],idle:[{type:n.Output}],render:[{type:n.Output}],mapError:[{type:n.Output}],data:[{type:n.Output}],styleData:[{type:n.Output}],sourceData:[{type:n.Output}],dataLoading:[{type:n.Output}],styleDataLoading:[{type:n.Output}],sourceDataLoading:[{type:n.Output}],styleImageMissing:[{type:n.Output}],resize:[{type:n.Output}],remove:[{type:n.Output}],mouseDown:[{type:n.Output}],mouseUp:[{type:n.Output}],mouseMove:[{type:n.Output}],click:[{type:n.Output}],dblClick:[{type:n.Output}],mouseOver:[{type:n.Output}],mouseOut:[{type:n.Output}],contextMenu:[{type:n.Output}],touchStart:[{type:n.Output}],touchEnd:[{type:n.Output}],touchMove:[{type:n.Output}],touchCancel:[{type:n.Output}],wheel:[{type:n.Output}],dragStart:[{type:n.Output}],drag:[{type:n.Output}],dragEnd:[{type:n.Output}],load:[{type:n.Output}],error:[{type:n.Output}],mapContainer:[{type:n.ViewChild,args:["container",{static:!0}]}]};var A=function(){function t(t){this.MapService=t,this.markerDragStart=new n.EventEmitter,this.markerDragEnd=new n.EventEmitter,this.markerDrag=new n.EventEmitter,this.dragStart=new n.EventEmitter,this.dragEnd=new n.EventEmitter,this.drag=new n.EventEmitter}return t.prototype.ngOnInit=function(){if(this.warnDeprecatedOutputs(),this.feature&&this.lngLat)throw new Error("feature and lngLat input are mutually exclusive")},t.prototype.ngOnChanges=function(t){t.lngLat&&!t.lngLat.isFirstChange()&&this.markerInstance.setLngLat(this.lngLat),t.feature&&!t.feature.isFirstChange()&&this.markerInstance.setLngLat(this.feature.geometry.coordinates),t.draggable&&!t.draggable.isFirstChange()&&this.markerInstance.setDraggable(!!this.draggable),t.popupShown&&!t.popupShown.isFirstChange()&&(t.popupShown.currentValue?this.markerInstance.getPopup().addTo(this.MapService.mapInstance):this.markerInstance.getPopup().remove()),t.pitchAlignment&&!t.pitchAlignment.isFirstChange()&&this.markerInstance.setPitchAlignment(t.pitchAlignment.currentValue),t.rotationAlignment&&!t.rotationAlignment.isFirstChange()&&this.markerInstance.setRotationAlignment(t.rotationAlignment.currentValue)},t.prototype.ngAfterViewInit=function(){var t=this;this.MapService.mapCreated$.subscribe((function(){t.markerInstance=t.MapService.addMarker({markersOptions:{offset:t.offset,anchor:t.anchor,pitchAlignment:t.pitchAlignment,rotationAlignment:t.rotationAlignment,draggable:!!t.draggable,element:t.content.nativeElement,feature:t.feature,lngLat:t.lngLat,clickTolerance:t.clickTolerance},markersEvents:{markerDragStart:t.markerDragStart,markerDrag:t.markerDrag,markerDragEnd:t.markerDragEnd,dragStart:t.dragStart,drag:t.drag,dragEnd:t.dragEnd}})}))},t.prototype.ngOnDestroy=function(){this.MapService.removeMarker(this.markerInstance),this.markerInstance=void 0},t.prototype.togglePopup=function(){this.markerInstance.togglePopup()},t.prototype.updateCoordinates=function(t){this.markerInstance.setLngLat(t)},t.prototype.warnDeprecatedOutputs=function(){var e=E.bind(void 0,t.name);this.dragStart.observers.length&&e("dragStart","markerDragStart"),this.dragEnd.observers.length&&e("dragEnd","markerDragEnd"),this.drag.observers.length&&e("drag","markerDrag")},t}();A.decorators=[{type:n.Component,args:[{selector:"mgl-marker",template:'<div [class]="className" #content><ng-content></ng-content></div>',encapsulation:n.ViewEncapsulation.None,changeDetection:n.ChangeDetectionStrategy.OnPush}]}],A.ctorParameters=function(){return[{type:g}]},A.propDecorators={offset:[{type:n.Input}],anchor:[{type:n.Input}],clickTolerance:[{type:n.Input}],feature:[{type:n.Input}],lngLat:[{type:n.Input}],draggable:[{type:n.Input}],popupShown:[{type:n.Input}],className:[{type:n.Input}],pitchAlignment:[{type:n.Input}],rotationAlignment:[{type:n.Input}],markerDragStart:[{type:n.Output}],markerDragEnd:[{type:n.Output}],markerDrag:[{type:n.Output}],dragStart:[{type:n.Output}],dragEnd:[{type:n.Output}],drag:[{type:n.Output}],content:[{type:n.ViewChild,args:["content",{static:!0}]}]};var F=function(){};F.decorators=[{type:n.Directive,args:[{selector:"ng-template[mglPoint]"}]}];var L=function(){};L.decorators=[{type:n.Directive,args:[{selector:"ng-template[mglClusterPoint]"}]}];var T=0,R=function(){function t(t,e,n){this.MapService=t,this.ChangeDetectorRef=e,this.zone=n,this.layerId="mgl-markers-for-clusters-"+T++,this.sub=new o.Subscription}return t.prototype.ngAfterContentInit=function(){var t=this,e=this.MapService.mapCreated$.pipe(i.switchMap((function(){return o.fromEvent(t.MapService.mapInstance,"data").pipe(i.filter((function(e){return e.sourceId===t.source&&"metadata"!==e.sourceDataType&&t.MapService.mapInstance.isSourceLoaded(t.source)})))})),i.switchMap((function(){return o.merge(o.fromEvent(t.MapService.mapInstance,"move"),o.fromEvent(t.MapService.mapInstance,"moveend")).pipe(i.startWith(void 0))}))).subscribe((function(){t.zone.run((function(){t.updateCluster()}))}));this.sub.add(e)},t.prototype.ngOnDestroy=function(){this.sub.unsubscribe()},t.prototype.trackByClusterPoint=function(t,e){return e.id},t.prototype.updateCluster=function(){var t={layers:[this.layerId]};this.pointTpl||(t.filter=["==","cluster",!0]),this.clusterPoints=this.MapService.mapInstance.queryRenderedFeatures(t),this.ChangeDetectorRef.markForCheck()},t}();R.decorators=[{type:n.Component,args:[{selector:"mgl-markers-for-clusters",template:'\n    <mgl-layer\n      [id]="layerId"\n      [source]="source"\n      type="circle"\n      [paint]="{ \'circle-radius\': 0 }"\n    ></mgl-layer>\n    <ng-container\n      *ngFor="let feature of clusterPoints; trackBy: trackByClusterPoint"\n    >\n      <ng-container *ngIf="feature.properties.cluster">\n        <mgl-marker [feature]="feature">\n          <ng-container\n            *ngTemplateOutlet="clusterPointTpl; context: { $implicit: feature }"\n          ></ng-container>\n        </mgl-marker>\n      </ng-container>\n      <ng-container *ngIf="!feature.properties.cluster">\n        <mgl-marker [feature]="feature">\n          <ng-container\n            *ngTemplateOutlet="pointTpl; context: { $implicit: feature }"\n          ></ng-container>\n        </mgl-marker>\n      </ng-container>\n    </ng-container>\n  ',changeDetection:n.ChangeDetectionStrategy.OnPush,preserveWhitespaces:!1}]}],R.ctorParameters=function(){return[{type:g},{type:n.ChangeDetectorRef},{type:n.NgZone}]},R.propDecorators={source:[{type:n.Input}],pointTpl:[{type:n.ContentChild,args:[F,{read:n.TemplateRef,static:!1}]}],clusterPointTpl:[{type:n.ContentChild,args:[L,{read:n.TemplateRef,static:!1}]}]};var Z=function(){function t(t){this.MapService=t,this.popupClose=new n.EventEmitter,this.popupOpen=new n.EventEmitter,this.close=new n.EventEmitter,this.open=new n.EventEmitter}return t.prototype.ngOnInit=function(){if(this.warnDeprecatedOutputs(),this.lngLat&&this.marker||this.feature&&this.lngLat||this.feature&&this.marker)throw new Error("marker, lngLat, feature input are mutually exclusive")},t.prototype.ngOnChanges=function(t){if(t.lngLat&&!t.lngLat.isFirstChange()||t.feature&&!t.feature.isFirstChange()){var e=t.lngLat?this.lngLat:this.feature.geometry.coordinates;this.MapService.removePopupFromMap(this.popupInstance,!0);var n=this.createPopup();this.MapService.addPopupToMap(n,e,this.popupInstance.isOpen()),this.popupInstance=n}if(t.marker&&!t.marker.isFirstChange()){var r=t.marker.previousValue;r.markerInstance&&this.MapService.removePopupFromMarker(r.markerInstance),this.marker&&this.marker.markerInstance&&this.popupInstance&&this.MapService.addPopupToMarker(this.marker.markerInstance,this.popupInstance)}t.offset&&!t.offset.isFirstChange()&&this.popupInstance&&this.popupInstance.setOffset(this.offset)},t.prototype.ngAfterViewInit=function(){this.popupInstance=this.createPopup(),this.addPopup(this.popupInstance)},t.prototype.ngOnDestroy=function(){this.popupInstance&&(this.lngLat||this.feature?this.MapService.removePopupFromMap(this.popupInstance):this.marker&&this.marker.markerInstance&&this.MapService.removePopupFromMarker(this.marker.markerInstance)),this.popupInstance=void 0},t.prototype.createPopup=function(){return this.MapService.createPopup({popupOptions:{closeButton:this.closeButton,closeOnClick:this.closeOnClick,anchor:this.anchor,offset:this.offset,className:this.className,maxWidth:this.maxWidth},popupEvents:{open:this.open,close:this.close,popupOpen:this.popupOpen,popupClose:this.popupClose}},this.content.nativeElement)},t.prototype.addPopup=function(t){var e=this;this.MapService.mapCreated$.subscribe((function(){if(e.lngLat||e.feature)e.MapService.addPopupToMap(t,e.lngLat?e.lngLat:e.feature.geometry.coordinates);else{if(!e.marker||!e.marker.markerInstance)throw new Error("mgl-popup need either lngLat/marker/feature to be set");e.MapService.addPopupToMarker(e.marker.markerInstance,t)}}))},t.prototype.warnDeprecatedOutputs=function(){var e=E.bind(void 0,t.name);this.close.observers.length&&e("close","popupClose"),this.open.observers.length&&e("open","popupOpen")},t}();Z.decorators=[{type:n.Component,args:[{selector:"mgl-popup",template:"<div #content><ng-content></ng-content></div>",changeDetection:n.ChangeDetectionStrategy.OnPush}]}],Z.ctorParameters=function(){return[{type:g}]},Z.propDecorators={closeButton:[{type:n.Input}],closeOnClick:[{type:n.Input}],anchor:[{type:n.Input}],className:[{type:n.Input}],maxWidth:[{type:n.Input}],feature:[{type:n.Input}],lngLat:[{type:n.Input}],marker:[{type:n.Input}],offset:[{type:n.Input}],popupClose:[{type:n.Output}],popupOpen:[{type:n.Output}],close:[{type:n.Output}],open:[{type:n.Output}],content:[{type:n.ViewChild,args:["content",{static:!0}]}]};var B=function(){function t(t){this.MapService=t,this.sourceAdded=!1,this.sub=new o.Subscription}return t.prototype.ngOnInit=function(){var t=this,e=this.MapService.mapLoaded$.subscribe((function(){t.init();var e=o.fromEvent(t.MapService.mapInstance,"styledata").pipe(i.filter((function(){return!t.MapService.mapInstance.getSource(t.id)}))).subscribe((function(){t.init()}));t.sub.add(e)}));this.sub.add(e)},t.prototype.ngOnChanges=function(t){if(this.sourceAdded)if(t.canvas&&!t.canvas.isFirstChange()||t.animate&&!t.animate.isFirstChange())this.ngOnDestroy(),this.ngOnInit();else if(t.coordinates&&!t.coordinates.isFirstChange()){this.MapService.getSource(this.id).setCoordinates(this.coordinates)}},t.prototype.ngOnDestroy=function(){this.sub.unsubscribe(),this.sourceAdded&&(this.MapService.removeSource(this.id),this.sourceAdded=!1)},t.prototype.init=function(){var t={type:"canvas",coordinates:this.coordinates,canvas:this.canvas,animate:this.animate};this.MapService.addSource(this.id,t),this.sourceAdded=!0},t}();B.decorators=[{type:n.Component,args:[{selector:"mgl-canvas-source",template:"",changeDetection:n.ChangeDetectionStrategy.OnPush}]}],B.ctorParameters=function(){return[{type:g}]},B.propDecorators={id:[{type:n.Input}],coordinates:[{type:n.Input}],canvas:[{type:n.Input}],animate:[{type:n.Input}]};var j=function(){function t(t){this.MapService=t}return t.prototype.ngOnInit=function(){var t=this;this.sub=this.MapService.mapLoaded$.subscribe((function(){return t.init()}))},t.prototype.ngOnChanges=function(t){void 0!==this.sourceId&&this.MapService.getSource(this.sourceId).updateImage({url:void 0===t.url?void 0:this.url,coordinates:void 0===t.coordinates?void 0:this.coordinates})},t.prototype.ngOnDestroy=function(){void 0!==this.sub&&this.sub.unsubscribe(),void 0!==this.sourceId&&(this.MapService.removeSource(this.sourceId),this.sourceId=void 0)},t.prototype.init=function(){var t={type:"image",url:this.url,coordinates:this.coordinates};this.MapService.addSource(this.id,t),this.sourceId=this.id},t}();j.decorators=[{type:n.Component,args:[{selector:"mgl-image-source",template:"",changeDetection:n.ChangeDetectionStrategy.OnPush}]}],j.ctorParameters=function(){return[{type:g}]},j.propDecorators={id:[{type:n.Input}],url:[{type:n.Input}],coordinates:[{type:n.Input}]};var U=function(){function t(t){this.MapService=t,this.type="raster-dem",this.sourceAdded=!1,this.sub=new o.Subscription}return t.prototype.ngOnInit=function(){var t=this,e=this.MapService.mapLoaded$.subscribe((function(){t.init();var e=o.fromEvent(t.MapService.mapInstance,"styledata").pipe(i.filter((function(){return!t.MapService.mapInstance.getSource(t.id)}))).subscribe((function(){t.init()}));t.sub.add(e)}));this.sub.add(e)},t.prototype.ngOnChanges=function(t){this.sourceAdded&&(t.url&&!t.url.isFirstChange()||t.tiles&&!t.tiles.isFirstChange()||t.bounds&&!t.bounds.isFirstChange()||t.minzoom&&!t.minzoom.isFirstChange()||t.maxzoom&&!t.maxzoom.isFirstChange()||t.tileSize&&!t.tileSize.isFirstChange()||t.attribution&&!t.attribution.isFirstChange()||t.encoding&&!t.encoding.isFirstChange())&&(this.ngOnDestroy(),this.ngOnInit())},t.prototype.ngOnDestroy=function(){this.sub.unsubscribe(),this.sourceAdded&&(this.MapService.removeSource(this.id),this.sourceAdded=!1)},t.prototype.init=function(){var t={type:this.type,url:this.url,tiles:this.tiles,bounds:this.bounds,minzoom:this.minzoom,maxzoom:this.maxzoom,tileSize:this.tileSize,attribution:this.attribution,encoding:this.encoding};this.MapService.addSource(this.id,t),this.sourceAdded=!0},t}();U.decorators=[{type:n.Component,args:[{selector:"mgl-raster-dem-source",template:"",changeDetection:n.ChangeDetectionStrategy.OnPush}]}],U.ctorParameters=function(){return[{type:g}]},U.propDecorators={id:[{type:n.Input}],url:[{type:n.Input}],tiles:[{type:n.Input}],bounds:[{type:n.Input}],minzoom:[{type:n.Input}],maxzoom:[{type:n.Input}],tileSize:[{type:n.Input}],attribution:[{type:n.Input}],encoding:[{type:n.Input}]};var V=function(){function t(t){this.MapService=t,this.type="raster",this.sourceAdded=!1,this.sub=new o.Subscription}return t.prototype.ngOnInit=function(){var t=this,e=this.MapService.mapLoaded$.subscribe((function(){t.init();var e=o.fromEvent(t.MapService.mapInstance,"styledata").pipe(i.filter((function(){return!t.MapService.mapInstance.getSource(t.id)}))).subscribe((function(){t.init()}));t.sub.add(e)}));this.sub.add(e)},t.prototype.ngOnChanges=function(t){this.sourceAdded&&(t.url&&!t.url.isFirstChange()||t.tiles&&!t.tiles.isFirstChange()||t.bounds&&!t.bounds.isFirstChange()||t.minzoom&&!t.minzoom.isFirstChange()||t.maxzoom&&!t.maxzoom.isFirstChange()||t.tileSize&&!t.tileSize.isFirstChange()||t.scheme&&!t.scheme.isFirstChange()||t.attribution&&!t.attribution.isFirstChange())&&(this.ngOnDestroy(),this.ngOnInit())},t.prototype.ngOnDestroy=function(){this.sub.unsubscribe(),this.sourceAdded&&(this.MapService.removeSource(this.id),this.sourceAdded=!1)},t.prototype.init=function(){var t={type:this.type,url:this.url,tiles:this.tiles,bounds:this.bounds,minzoom:this.minzoom,maxzoom:this.maxzoom,tileSize:this.tileSize,scheme:this.scheme,attribution:this.attribution};this.MapService.addSource(this.id,t),this.sourceAdded=!0},t}();V.decorators=[{type:n.Component,args:[{selector:"mgl-raster-source",template:"",changeDetection:n.ChangeDetectionStrategy.OnPush}]}],V.ctorParameters=function(){return[{type:g}]},V.propDecorators={id:[{type:n.Input}],url:[{type:n.Input}],tiles:[{type:n.Input}],bounds:[{type:n.Input}],minzoom:[{type:n.Input}],maxzoom:[{type:n.Input}],tileSize:[{type:n.Input}],scheme:[{type:n.Input}],attribution:[{type:n.Input}]};var N=function(){function t(t){this.MapService=t,this.type="vector",this.sourceAdded=!1,this.sub=new o.Subscription}return t.prototype.ngOnInit=function(){var t=this,e=this.MapService.mapLoaded$.subscribe((function(){t.init();var e=o.fromEvent(t.MapService.mapInstance,"styledata").pipe(i.filter((function(){return!t.MapService.mapInstance.getSource(t.id)}))).subscribe((function(){t.init()}));t.sub.add(e)}));this.sub.add(e)},t.prototype.ngOnChanges=function(t){if(this.sourceAdded)if(t.bounds&&!t.bounds.isFirstChange()||t.scheme&&!t.scheme.isFirstChange()||t.minzoom&&!t.minzoom.isFirstChange()||t.maxzoom&&!t.maxzoom.isFirstChange()||t.attribution&&!t.attribution.isFirstChange()||t.promoteId&&!t.promoteId.isFirstChange())this.ngOnDestroy(),this.ngOnInit();else if(t.url&&!t.url.isFirstChange()||t.tiles&&!t.tiles.isFirstChange()){var e=this.MapService.getSource(this.id);t.url&&this.url&&e.setUrl(this.url),t.tiles&&this.tiles&&e.setTiles(this.tiles)}},t.prototype.ngOnDestroy=function(){this.sub.unsubscribe(),this.sourceAdded&&(this.MapService.removeSource(this.id),this.sourceAdded=!1)},t.prototype.init=function(){var t={type:this.type,url:this.url,tiles:this.tiles,bounds:this.bounds,scheme:this.scheme,minzoom:this.minzoom,maxzoom:this.maxzoom,attribution:this.attribution,promoteId:this.promoteId};this.MapService.addSource(this.id,t),this.sourceAdded=!0},t}();N.decorators=[{type:n.Component,args:[{selector:"mgl-vector-source",template:"",changeDetection:n.ChangeDetectionStrategy.OnPush}]}],N.ctorParameters=function(){return[{type:g}]},N.propDecorators={id:[{type:n.Input}],url:[{type:n.Input}],tiles:[{type:n.Input}],bounds:[{type:n.Input}],scheme:[{type:n.Input}],minzoom:[{type:n.Input}],maxzoom:[{type:n.Input}],attribution:[{type:n.Input}],promoteId:[{type:n.Input}]};var W=function(){function t(t){this.MapService=t,this.sourceAdded=!1,this.sub=new o.Subscription}return t.prototype.ngOnInit=function(){var t=this,e=this.MapService.mapLoaded$.subscribe((function(){t.init();var e=o.fromEvent(t.MapService.mapInstance,"styledata").pipe(i.filter((function(){return!t.MapService.mapInstance.getSource(t.id)}))).subscribe((function(){t.init()}));t.sub.add(e)}));this.sub.add(e)},t.prototype.ngOnChanges=function(t){if(this.sourceAdded)if(t.urls&&!t.urls.isFirstChange())this.ngOnDestroy(),this.ngOnInit();else if(t.coordinates&&!t.coordinates.isFirstChange()){this.MapService.getSource(this.id).setCoordinates(this.coordinates)}},t.prototype.ngOnDestroy=function(){this.sub.unsubscribe(),this.sourceAdded&&(this.MapService.removeSource(this.id),this.sourceAdded=!1)},t.prototype.init=function(){var t={type:"video",urls:this.urls,coordinates:this.coordinates};this.MapService.addSource(this.id,t),this.sourceAdded=!0},t}();W.decorators=[{type:n.Component,args:[{selector:"mgl-video-source",template:"",changeDetection:n.ChangeDetectionStrategy.OnPush}]}],W.ctorParameters=function(){return[{type:g}]},W.propDecorators={id:[{type:n.Input}],urls:[{type:n.Input}],coordinates:[{type:n.Input}]};var _=function(){function t(){}return t.withConfig=function(e){return{ngModule:t,providers:[{provide:d,useValue:e.accessToken},{provide:C,useValue:e.geocoderAccessToken||e.accessToken}]}},t}();_.decorators=[{type:n.NgModule,args:[{imports:[e.CommonModule],declarations:[P,x,D,z,N,w,U,V,j,W,B,k,A,Z,y,b,M,I,O,f,S,F,L,R],exports:[P,x,D,z,N,w,U,V,j,W,B,k,A,Z,y,b,M,I,O,f,S,F,L,R]}]}],t.ControlComponent=y,t.CustomControl=v,t.GeoJSONSourceComponent=w,t.MAPBOX_API_KEY=d,t.MAPBOX_GEOCODER_API_KEY=C,t.MapComponent=P,t.MapService=g,t.NgxMapboxGLModule=_,t.ɵa=I,t.ɵb=x,t.ɵc=D,t.ɵd=k,t.ɵe=z,t.ɵf=N,t.ɵg=U,t.ɵh=V,t.ɵi=j,t.ɵj=W,t.ɵk=B,t.ɵl=A,t.ɵm=Z,t.ɵn=b,t.ɵo=M,t.ɵp=O,t.ɵq=f,t.ɵr=S,t.ɵs=F,t.ɵt=L,t.ɵu=R,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-mapbox-gl.umd.min.js.map