{"version":3,"sources":["../../../node_modules/tslib/tslib.es6.js","../../../projects/ngx-mapbox-gl/src/lib/map/map.service.ts","../../../projects/ngx-mapbox-gl/src/lib/control/control.component.ts","../../../projects/ngx-mapbox-gl/src/lib/control/attribution-control.directive.ts","../../../projects/ngx-mapbox-gl/src/lib/control/fullscreen-control.directive.ts","../../../projects/ngx-mapbox-gl/src/lib/utils.ts","../../../projects/ngx-mapbox-gl/src/lib/control/geocoder-control.directive.ts","../../../projects/ngx-mapbox-gl/src/lib/control/geolocate-control.directive.ts","../../../projects/ngx-mapbox-gl/src/lib/control/navigation-control.directive.ts","../../../projects/ngx-mapbox-gl/src/lib/control/scale-control.directive.ts","../../../projects/ngx-mapbox-gl/src/lib/source/geojson/geojson-source.component.ts","../../../projects/ngx-mapbox-gl/src/lib/source/geojson/feature.component.ts","../../../projects/ngx-mapbox-gl/src/lib/draggable/draggable.directive.ts","../../../projects/ngx-mapbox-gl/src/lib/image/image.component.ts","../../../projects/ngx-mapbox-gl/src/lib/layer/layer.component.ts","../../../projects/ngx-mapbox-gl/src/lib/map/map.component.ts","../../../projects/ngx-mapbox-gl/src/lib/marker/marker.component.ts","../../../projects/ngx-mapbox-gl/src/lib/markers-for-clusters/markers-for-clusters.component.ts","../../../projects/ngx-mapbox-gl/src/lib/popup/popup.component.ts","../../../projects/ngx-mapbox-gl/src/lib/source/canvas-source.component.ts","../../../projects/ngx-mapbox-gl/src/lib/source/image-source.component.ts","../../../projects/ngx-mapbox-gl/src/lib/source/raster-dem-source.component.ts","../../../projects/ngx-mapbox-gl/src/lib/source/raster-source.component.ts","../../../projects/ngx-mapbox-gl/src/lib/source/vector-source.component.ts","../../../projects/ngx-mapbox-gl/src/lib/source/video-source.component.ts","../../../projects/ngx-mapbox-gl/src/lib/ngx-mapbox-gl.module.ts"],"names":["__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","__generator","body","f","y","t","g","_","label","sent","trys","ops","verb","throw","return","Symbol","iterator","this","n","v","op","TypeError","call","pop","length","push","Object","create","__values","o","s","m","i","MAPBOX_API_KEY","InjectionToken","MapService","zone","mapCreated","AsyncSubject","mapLoaded","markersToRemove","popupsToRemove","imageIdsToRemove","subscription","Subscription","mapCreated$","asObservable","mapLoaded$","prototype","setup","options","_this","onStable","pipe","first","subscribe","assign","MapboxGl","accessToken","customMapboxApiUrl","createMap","mapOptions","hookEvents","mapEvents","undefined","complete","destroyMap","mapInstance","unsubscribe","remove","updateMinZoom","minZoom","runOutsideAngular","setMinZoom","updateMaxZoom","maxZoom","setMaxZoom","updateMinPitch","minPitch","setMinPitch","updateMaxPitch","maxPitch","setMaxPitch","updateRenderWorldCopies","status","setRenderWorldCopies","updateScrollZoom","scrollZoom","enable","disable","updateDragRotate","dragRotate","updateTouchPitch","touchPitch","updateTouchZoomRotate","touchZoomRotate","updateDoubleClickZoom","doubleClickZoom","updateKeyboard","keyboard","updateDragPan","dragPan","updateBoxZoom","boxZoom","updateStyle","style","setStyle","updateMaxBounds","maxBounds","setMaxBounds","changeCanvasCursor","cursor","getCanvasContainer","queryRenderedFeatures","pointOrBox","parameters","panTo","center","move","movingMethod","movingOptions","zoom","bearing","pitch","getZoom","getCenter","getBearing","getPitch","addLayer","layer","bindEvents","before","keys","layerOptions","forEach","key","tkey","layerEvents","layerClick","observers","click","on","id","evt","run","emit","layerDblClick","dblClick","layerMouseDown","mouseDown","layerMouseUp","mouseUp","layerMouseEnter","mouseEnter","layerMouseLeave","mouseLeave","layerMouseMove","mouseMove","layerMouseOver","mouseOver","layerMouseOut","mouseOut","layerContextMenu","contextMenu","layerTouchStart","touchStart","layerTouchEnd","touchEnd","layerTouchCancel","touchCancel","removeLayer","layerId","getLayer","addMarker","marker","offset","markersOptions","anchor","draggable","rotationAlignment","pitchAlignment","clickTolerance","element","childNodes","markerInstance","MapboxGl.Marker","markersEvents","markerDragStart","dragStart","event","target_1","target","markerDrag","drag","target_2","markerDragEnd","dragEnd","target_3","lngLat","feature","geometry","coordinates","setLngLat","addTo","removeMarker","createPopup","popup","popupOptions","popupInstance","MapboxGl.Popup","setDOMContent","popupEvents","popupClose","close","popupOpen","open","addPopupToMap","skipOpenEvent","_listeners","addPopupToMarker","setPopup","removePopupFromMap","skipCloseEvent","removePopupFromMarker","addControl","control","position","removeControl","loadAndAddImage","imageId","url","loadImage","error","image","addImage","data","removeImage","addSource","sourceId","source","getSource","removeSource","findLayersBySourceId","setAllLayerPaintProperty","paint","setPaintProperty","setAllLayerLayoutProperty","layout","setLayoutProperty","setLayerFilter","filter","setFilter","setLayerBefore","beforeId","moveLayer","setLayerZoomRange","fitBounds","bounds","fitScreenCoordinates","points","applyChanges","removeMarkers","removePopups","removeImages","NgZone","assertNotInAngularZone","MapboxGl.Map","window","test","navigator","userAgent","add","onMicrotaskEmpty","_b","_c","layers","getStyle","l","events","mapLoad","load","mapResize","resize","mapRemove","mapMouseDown","mapMouseUp","mapMouseMove","mapClick","mapDblClick","mapMouseOver","mapMouseOut","mapContextMenu","mapTouchStart","mapTouchEnd","mapTouchMove","touchMove","mapTouchCancel","mapWheel","wheel","moveStart","moveEnd","mapDragStart","mapDrag","mapDragEnd","zoomStart","zoomEvt","zoomEnd","rotateStart","rotate","rotateEnd","pitchStart","pitchEvt","pitchEnd","boxZoomStart","boxZoomEnd","boxZoomCancel","webGlContextLost","webGlContextRestored","render","mapError","styleData","sourceData","dataLoading","styleDataLoading","sourceDataLoading","styleImageMissing","idle","obj","prop","split","shift","toString","Injectable","Optional","type","Inject","args","CustomControl","container","onAdd","onRemove","parentNode","removeChild","getDefaultPosition","ControlComponent","controlAdded","ngAfterContentInit","content","nativeElement","ngOnDestroy","Component","selector","template","changeDetection","ChangeDetectionStrategy","OnPush","Input","ViewChild","static","AttributionControlDirective","Error","compact","customAttribution","AttributionControl","Directive","decorators","Host","FullscreenControlDirective","FullscreenControl","deprecationWarning","context","oldApi","newApi","console","warn","MAPBOX_GEOCODER_API_KEY","GeocoderControlDirective","clear","EventEmitter","loading","geocoderResults","geocoderResult","geocoderError","results","proximity","countries","placeholder","bbox","types","flyTo","minLength","limit","language","localGeocoder","mapboxgl","geocoder","MapboxGeocoder","searchInput","query","ngOnChanges","changes","isFirstChange","setProximity","currentValue","warnDeprecatedOutputs","lastResultId","dw","bind","name","Output","GeolocateControlDirective","geolocate","positionOptions","fitBoundsOptions","trackUserLocation","showUserLocation","GeolocateControl","NavigationControlDirective","showCompass","showZoom","NavigationControl","ScaleControlDirective","unit","setUnit","maxWidth","ScaleControl","GeoJSONSourceComponent","updateFeatureData","Subject","sub","sourceAdded","featureIdCounter","ngOnInit","features","sub1","init","fromEvent","maxzoom","attribution","buffer","tolerance","cluster","clusterRadius","clusterMaxZoom","clusterMinPoints","clusterProperties","lineMetrics","generateId","promoteId","setData","getClusterExpansionZoom","clusterId","getClusterChildren","getClusterLeaves","_addFeature","_removeFeature","collection","index","indexOf","splice","_getNewFeatureId","debounceTime","FeatureComponent","properties","updateCoordinates","forwardRef","DraggableDirective","featureDragStart","featureDragEnd","featureDrag","enter$","leave$","updateCoords","handleDraggable","moving","inside","mouseUp$","dragStart$","filterFeature","tap","switchMap","takeUntil","dragging$","dragEnd$","take","lng","lat","point","ImageComponent","imageError","imageLoaded","loaded","isAdded","isAdding","startWith","hasImage","_a","error_1","LayerComponent","layerAdded","mapTo","minzoom","metadata","source-layer","sourceLayer","MapComponent","defineProperty","ngAfterViewInit","collectResourceTiming","mapContainer","crossSourceCollisions","fadeDuration","hash","interactive","bearingSnap","pitchWithRotate","attributionControl","logoPosition","failIfMajorPerformanceCaveat","preserveDrawingBuffer","refreshExpiredTiles","trackResize","renderWorldCopies","maxTileCacheSize","localIdeographFontFamily","transformRequest","antialias","locale","cursorStyle","toPromise","centerWithPanTo","panToOptions","providers","MarkerComponent","setDraggable","popupShown","getPopup","setPitchAlignment","setRotationAlignment","togglePopup","encapsulation","ViewEncapsulation","None","uniqId","MarkersForClustersComponent","ChangeDetectorRef","sourceDataType","isSourceLoaded","merge","updateCluster","trackByClusterPoint","_index","clusterPoint","params","pointTpl","clusterPoints","markForCheck","preserveWhitespaces","ContentChild","PointDirective","read","TemplateRef","ClusterPointDirective","PopupComponent","newlngLat","popupInstanceTmp","isOpen","previousMarker","previousValue","setOffset","addPopup","closeButton","closeOnClick","className","CanvasSourceComponent","canvas","animate","setCoordinates","ImageSourceComponent","updateImage","imageSource","RasterDemSourceComponent","tiles","tileSize","encoding","RasterSourceComponent","scheme","VectorSourceComponent","setUrl","setTiles","VideoSourceComponent","urls","NgxMapboxGLModule","withConfig","config","ngModule","provide","useValue","geocoderAccessToken","NgModule","imports","CommonModule","declarations","exports"],"mappings":"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","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from) {\r\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\r\n        to[j] = from[i];\r\n    return to;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","import {\r\n  EventEmitter,\r\n  Inject,\r\n  Injectable,\r\n  InjectionToken,\r\n  NgZone,\r\n  Optional,\r\n} from '@angular/core';\r\nimport * as MapboxGl from 'mapbox-gl';\r\nimport { AsyncSubject, Observable, Subscription } from 'rxjs';\r\nimport { first } from 'rxjs/operators';\r\nimport {\r\n  LayerEvents,\r\n  MapEvent,\r\n  MapImageData,\r\n  MapImageOptions,\r\n} from './map.types';\r\n\r\nexport const MAPBOX_API_KEY = new InjectionToken('MapboxApiKey');\r\n\r\nexport interface SetupMap {\r\n  accessToken?: string;\r\n  customMapboxApiUrl?: string;\r\n  mapOptions: Omit<MapboxGl.MapboxOptions, 'bearing' | 'pitch' | 'zoom'> & {\r\n    bearing?: [number];\r\n    pitch?: [number];\r\n    zoom?: [number];\r\n  };\r\n  mapEvents: MapEvent;\r\n}\r\n\r\nexport interface SetupLayer {\r\n  layerOptions: MapboxGl.Layer;\r\n  layerEvents: LayerEvents;\r\n}\r\n\r\nexport interface SetupPopup {\r\n  popupOptions: MapboxGl.PopupOptions;\r\n  popupEvents: {\r\n    open: EventEmitter<void>;\r\n    close: EventEmitter<void>;\r\n    popupOpen: EventEmitter<void>;\r\n    popupClose: EventEmitter<void>;\r\n  };\r\n}\r\n\r\nexport interface SetupMarker {\r\n  markersOptions: {\r\n    pitchAlignment?: MapboxGl.MarkerOptions['pitchAlignment'];\r\n    rotationAlignment?: MapboxGl.MarkerOptions['rotationAlignment'];\r\n    offset?: MapboxGl.MarkerOptions['offset'];\r\n    anchor?: MapboxGl.MarkerOptions['anchor'];\r\n    draggable?: MapboxGl.MarkerOptions['draggable'];\r\n    element: HTMLElement;\r\n    feature?: GeoJSON.Feature<GeoJSON.Point>;\r\n    lngLat?: MapboxGl.LngLatLike;\r\n    clickTolerance?: MapboxGl.MarkerOptions['clickTolerance'];\r\n  };\r\n  markersEvents: {\r\n    markerDragStart: EventEmitter<MapboxGl.Marker>;\r\n    markerDrag: EventEmitter<MapboxGl.Marker>;\r\n    markerDragEnd: EventEmitter<MapboxGl.Marker>;\r\n    dragStart: EventEmitter<MapboxGl.Marker>;\r\n    drag: EventEmitter<MapboxGl.Marker>;\r\n    dragEnd: EventEmitter<MapboxGl.Marker>;\r\n  };\r\n}\r\n\r\nexport type MovingOptions =\r\n  | MapboxGl.FlyToOptions\r\n  | (MapboxGl.AnimationOptions & MapboxGl.CameraOptions)\r\n  | MapboxGl.CameraOptions;\r\n\r\n@Injectable()\r\nexport class MapService {\r\n  mapInstance: MapboxGl.Map;\r\n  mapCreated$: Observable<void>;\r\n  mapLoaded$: Observable<void>;\r\n  mapEvents: MapEvent;\r\n\r\n  private mapCreated = new AsyncSubject<void>();\r\n  private mapLoaded = new AsyncSubject<void>();\r\n  private markersToRemove: MapboxGl.Marker[] = [];\r\n  private popupsToRemove: MapboxGl.Popup[] = [];\r\n  private imageIdsToRemove: string[] = [];\r\n  private subscription = new Subscription();\r\n\r\n  constructor(\r\n    private zone: NgZone,\r\n    @Optional() @Inject(MAPBOX_API_KEY) private readonly MAPBOX_API_KEY: string\r\n  ) {\r\n    this.mapCreated$ = this.mapCreated.asObservable();\r\n    this.mapLoaded$ = this.mapLoaded.asObservable();\r\n  }\r\n\r\n  setup(options: SetupMap) {\r\n    // Need onStable to wait for a potential @angular/route transition to end\r\n    this.zone.onStable.pipe(first()).subscribe(() => {\r\n      // Workaround rollup issue\r\n      this.assign(\r\n        MapboxGl,\r\n        'accessToken',\r\n        options.accessToken || this.MAPBOX_API_KEY\r\n      );\r\n      if (options.customMapboxApiUrl) {\r\n        this.assign(MapboxGl, 'config.API_URL', options.customMapboxApiUrl);\r\n      }\r\n      this.createMap(options.mapOptions as MapboxGl.MapboxOptions);\r\n      this.hookEvents(options.mapEvents);\r\n      this.mapEvents = options.mapEvents;\r\n      this.mapCreated.next(undefined);\r\n      this.mapCreated.complete();\r\n    });\r\n  }\r\n\r\n  destroyMap() {\r\n    if (this.mapInstance) {\r\n      this.subscription.unsubscribe();\r\n      this.mapInstance.remove();\r\n    }\r\n  }\r\n\r\n  updateMinZoom(minZoom: number) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      this.mapInstance.setMinZoom(minZoom);\r\n    });\r\n  }\r\n\r\n  updateMaxZoom(maxZoom: number) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      this.mapInstance.setMaxZoom(maxZoom);\r\n    });\r\n  }\r\n\r\n  updateMinPitch(minPitch: number) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      this.mapInstance.setMinPitch(minPitch);\r\n    });\r\n  }\r\n\r\n  updateMaxPitch(maxPitch: number) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      this.mapInstance.setMaxPitch(maxPitch);\r\n    });\r\n  }\r\n\r\n  updateRenderWorldCopies(status: boolean) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      this.mapInstance.setRenderWorldCopies(status);\r\n    });\r\n  }\r\n\r\n  updateScrollZoom(status: boolean) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      status\r\n        ? this.mapInstance.scrollZoom.enable()\r\n        : this.mapInstance.scrollZoom.disable();\r\n    });\r\n  }\r\n\r\n  updateDragRotate(status: boolean) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      status\r\n        ? this.mapInstance.dragRotate.enable()\r\n        : this.mapInstance.dragRotate.disable();\r\n    });\r\n  }\r\n\r\n  updateTouchPitch(status: boolean) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      status\r\n        ? this.mapInstance.touchPitch.enable()\r\n        : this.mapInstance.touchPitch.disable();\r\n    });\r\n  }\r\n\r\n  updateTouchZoomRotate(status: boolean) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      status\r\n        ? this.mapInstance.touchZoomRotate.enable()\r\n        : this.mapInstance.touchZoomRotate.disable();\r\n    });\r\n  }\r\n\r\n  updateDoubleClickZoom(status: boolean) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      status\r\n        ? this.mapInstance.doubleClickZoom.enable()\r\n        : this.mapInstance.doubleClickZoom.disable();\r\n    });\r\n  }\r\n\r\n  updateKeyboard(status: boolean) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      status\r\n        ? this.mapInstance.keyboard.enable()\r\n        : this.mapInstance.keyboard.disable();\r\n    });\r\n  }\r\n\r\n  updateDragPan(status: boolean) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      status\r\n        ? this.mapInstance.dragPan.enable()\r\n        : this.mapInstance.dragPan.disable();\r\n    });\r\n  }\r\n\r\n  updateBoxZoom(status: boolean) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      status\r\n        ? this.mapInstance.boxZoom.enable()\r\n        : this.mapInstance.boxZoom.disable();\r\n    });\r\n  }\r\n\r\n  updateStyle(style: MapboxGl.Style) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      this.mapInstance.setStyle(style);\r\n    });\r\n  }\r\n\r\n  updateMaxBounds(maxBounds: MapboxGl.LngLatBoundsLike) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      this.mapInstance.setMaxBounds(maxBounds);\r\n    });\r\n  }\r\n\r\n  changeCanvasCursor(cursor: string) {\r\n    const canvas = this.mapInstance.getCanvasContainer();\r\n    canvas.style.cursor = cursor;\r\n  }\r\n\r\n  queryRenderedFeatures(\r\n    pointOrBox?: MapboxGl.PointLike | [MapboxGl.PointLike, MapboxGl.PointLike],\r\n    parameters?: { layers?: string[]; filter?: any[] }\r\n  ): GeoJSON.Feature<GeoJSON.GeometryObject>[] {\r\n    return this.mapInstance.queryRenderedFeatures(pointOrBox, parameters);\r\n  }\r\n\r\n  panTo(center: MapboxGl.LngLatLike, options?: MapboxGl.AnimationOptions) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      this.mapInstance.panTo(center, options);\r\n    });\r\n  }\r\n\r\n  move(\r\n    movingMethod: 'jumpTo' | 'easeTo' | 'flyTo',\r\n    movingOptions?: MovingOptions,\r\n    zoom?: number,\r\n    center?: MapboxGl.LngLatLike,\r\n    bearing?: number,\r\n    pitch?: number\r\n  ) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      (<any>this.mapInstance[movingMethod])({\r\n        ...movingOptions,\r\n        zoom: zoom ? zoom : this.mapInstance.getZoom(),\r\n        center: center ? center : this.mapInstance.getCenter(),\r\n        bearing: bearing ? bearing : this.mapInstance.getBearing(),\r\n        pitch: pitch ? pitch : this.mapInstance.getPitch(),\r\n      });\r\n    });\r\n  }\r\n\r\n  addLayer(layer: SetupLayer, bindEvents: boolean, before?: string) {\r\n    this.zone.runOutsideAngular(() => {\r\n      Object.keys(layer.layerOptions).forEach((key: string) => {\r\n        const tkey = <keyof MapboxGl.AnyLayer>key;\r\n        if (layer.layerOptions[tkey] === undefined) {\r\n          delete layer.layerOptions[tkey];\r\n        }\r\n      });\r\n      this.mapInstance.addLayer(\r\n        layer.layerOptions as MapboxGl.AnyLayer,\r\n        before\r\n      );\r\n      if (bindEvents) {\r\n        if (\r\n          layer.layerEvents.layerClick.observers.length ||\r\n          layer.layerEvents.click.observers.length\r\n        ) {\r\n          this.mapInstance.on('click', layer.layerOptions.id, (evt) => {\r\n            this.zone.run(() => {\r\n              layer.layerEvents.layerClick.emit(evt);\r\n              layer.layerEvents.click.emit(evt);\r\n            });\r\n          });\r\n        }\r\n        if (\r\n          layer.layerEvents.layerDblClick.observers.length ||\r\n          layer.layerEvents.dblClick.observers.length\r\n        ) {\r\n          this.mapInstance.on('dblclick', layer.layerOptions.id, (evt) => {\r\n            this.zone.run(() => {\r\n              layer.layerEvents.layerDblClick.emit(evt);\r\n              layer.layerEvents.dblClick.emit(evt);\r\n            });\r\n          });\r\n        }\r\n        if (\r\n          layer.layerEvents.layerMouseDown.observers.length ||\r\n          layer.layerEvents.mouseDown.observers.length\r\n        ) {\r\n          this.mapInstance.on('mousedown', layer.layerOptions.id, (evt) => {\r\n            this.zone.run(() => {\r\n              layer.layerEvents.layerMouseDown.emit(evt);\r\n              layer.layerEvents.mouseDown.emit(evt);\r\n            });\r\n          });\r\n        }\r\n        if (\r\n          layer.layerEvents.layerMouseUp.observers.length ||\r\n          layer.layerEvents.mouseUp.observers.length\r\n        ) {\r\n          this.mapInstance.on('mouseup', layer.layerOptions.id, (evt) => {\r\n            this.zone.run(() => {\r\n              layer.layerEvents.layerMouseUp.emit(evt);\r\n              layer.layerEvents.mouseUp.emit(evt);\r\n            });\r\n          });\r\n        }\r\n        if (\r\n          layer.layerEvents.layerMouseEnter.observers.length ||\r\n          layer.layerEvents.mouseEnter.observers.length\r\n        ) {\r\n          this.mapInstance.on('mouseenter', layer.layerOptions.id, (evt) => {\r\n            this.zone.run(() => {\r\n              layer.layerEvents.layerMouseEnter.emit(evt);\r\n              layer.layerEvents.mouseEnter.emit(evt);\r\n            });\r\n          });\r\n        }\r\n        if (\r\n          layer.layerEvents.layerMouseLeave.observers.length ||\r\n          layer.layerEvents.mouseLeave.observers.length\r\n        ) {\r\n          this.mapInstance.on('mouseleave', layer.layerOptions.id, (evt) => {\r\n            this.zone.run(() => {\r\n              layer.layerEvents.layerMouseLeave.emit(evt);\r\n              layer.layerEvents.mouseLeave.emit(evt);\r\n            });\r\n          });\r\n        }\r\n        if (\r\n          layer.layerEvents.layerMouseMove.observers.length ||\r\n          layer.layerEvents.mouseMove.observers.length\r\n        ) {\r\n          this.mapInstance.on('mousemove', layer.layerOptions.id, (evt) => {\r\n            this.zone.run(() => {\r\n              layer.layerEvents.layerMouseMove.emit(evt);\r\n              layer.layerEvents.mouseMove.emit(evt);\r\n            });\r\n          });\r\n        }\r\n        if (\r\n          layer.layerEvents.layerMouseOver.observers.length ||\r\n          layer.layerEvents.mouseOver.observers.length\r\n        ) {\r\n          this.mapInstance.on('mouseover', layer.layerOptions.id, (evt) => {\r\n            this.zone.run(() => {\r\n              layer.layerEvents.layerMouseOver.emit(evt);\r\n              layer.layerEvents.mouseOver.emit(evt);\r\n            });\r\n          });\r\n        }\r\n        if (\r\n          layer.layerEvents.layerMouseOut.observers.length ||\r\n          layer.layerEvents.mouseOut.observers.length\r\n        ) {\r\n          this.mapInstance.on('mouseout', layer.layerOptions.id, (evt) => {\r\n            this.zone.run(() => {\r\n              layer.layerEvents.layerMouseOut.emit(evt);\r\n              layer.layerEvents.mouseOut.emit(evt);\r\n            });\r\n          });\r\n        }\r\n        if (\r\n          layer.layerEvents.layerContextMenu.observers.length ||\r\n          layer.layerEvents.contextMenu.observers.length\r\n        ) {\r\n          this.mapInstance.on('contextmenu', layer.layerOptions.id, (evt) => {\r\n            this.zone.run(() => {\r\n              layer.layerEvents.layerContextMenu.emit(evt);\r\n              layer.layerEvents.contextMenu.emit(evt);\r\n            });\r\n          });\r\n        }\r\n        if (\r\n          layer.layerEvents.layerTouchStart.observers.length ||\r\n          layer.layerEvents.touchStart.observers.length\r\n        ) {\r\n          this.mapInstance.on('touchstart', layer.layerOptions.id, (evt) => {\r\n            this.zone.run(() => {\r\n              layer.layerEvents.layerTouchStart.emit(evt);\r\n              layer.layerEvents.touchStart.emit(evt);\r\n            });\r\n          });\r\n        }\r\n        if (\r\n          layer.layerEvents.layerTouchEnd.observers.length ||\r\n          layer.layerEvents.touchEnd.observers.length\r\n        ) {\r\n          this.mapInstance.on('touchend', layer.layerOptions.id, (evt) => {\r\n            this.zone.run(() => {\r\n              layer.layerEvents.layerTouchEnd.emit(evt);\r\n              layer.layerEvents.touchEnd.emit(evt);\r\n            });\r\n          });\r\n        }\r\n        if (\r\n          layer.layerEvents.layerTouchCancel.observers.length ||\r\n          layer.layerEvents.touchCancel.observers.length\r\n        ) {\r\n          this.mapInstance.on('touchcancel', layer.layerOptions.id, (evt) => {\r\n            this.zone.run(() => {\r\n              layer.layerEvents.layerTouchCancel.emit(evt);\r\n              layer.layerEvents.touchCancel.emit(evt);\r\n            });\r\n          });\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  removeLayer(layerId: string) {\r\n    this.zone.runOutsideAngular(() => {\r\n      if (this.mapInstance.getLayer(layerId) != null) {\r\n        this.mapInstance.removeLayer(layerId);\r\n      }\r\n    });\r\n  }\r\n\r\n  addMarker(marker: SetupMarker) {\r\n    const options: MapboxGl.MarkerOptions = {\r\n      offset: marker.markersOptions.offset,\r\n      anchor: marker.markersOptions.anchor,\r\n      draggable: !!marker.markersOptions.draggable,\r\n      rotationAlignment: marker.markersOptions.rotationAlignment,\r\n      pitchAlignment: marker.markersOptions.pitchAlignment,\r\n      clickTolerance: marker.markersOptions.clickTolerance,\r\n    };\r\n    if (marker.markersOptions.element.childNodes.length > 0) {\r\n      options.element = marker.markersOptions.element;\r\n    }\r\n    const markerInstance = new MapboxGl.Marker(options);\r\n    if (\r\n      marker.markersEvents.markerDragStart.observers.length ||\r\n      marker.markersEvents.dragStart.observers.length\r\n    ) {\r\n      markerInstance.on('dragstart', (event) => {\r\n        if (event) {\r\n          const { target } = event as { target: MapboxGl.Marker };\r\n          this.zone.run(() => {\r\n            marker.markersEvents.markerDragStart.emit(target);\r\n            marker.markersEvents.dragStart.emit(target);\r\n          });\r\n        }\r\n      });\r\n    }\r\n    /*\r\n\r\n     */\r\n    if (\r\n      marker.markersEvents.markerDrag.observers.length ||\r\n      marker.markersEvents.drag.observers.length\r\n    ) {\r\n      markerInstance.on('drag', (event) => {\r\n        if (event) {\r\n          const { target } = event as { target: MapboxGl.Marker };\r\n          this.zone.run(() => {\r\n            marker.markersEvents.markerDrag.emit(target);\r\n            marker.markersEvents.drag.emit(target);\r\n          });\r\n        }\r\n      });\r\n    }\r\n    if (\r\n      marker.markersEvents.markerDragEnd.observers.length ||\r\n      marker.markersEvents.dragEnd.observers.length\r\n    ) {\r\n      markerInstance.on('dragend', (event) => {\r\n        if (event) {\r\n          const { target } = event as { target: MapboxGl.Marker };\r\n          this.zone.run(() => {\r\n            marker.markersEvents.markerDragEnd.emit(target);\r\n            marker.markersEvents.dragEnd.emit(target);\r\n          });\r\n        }\r\n      });\r\n    }\r\n    const lngLat: MapboxGl.LngLatLike = marker.markersOptions.feature\r\n      ? <[number, number]>marker.markersOptions.feature.geometry!.coordinates\r\n      : marker.markersOptions.lngLat!;\r\n    markerInstance.setLngLat(lngLat);\r\n    return this.zone.runOutsideAngular(() => {\r\n      markerInstance.addTo(this.mapInstance);\r\n      return markerInstance;\r\n    });\r\n  }\r\n\r\n  removeMarker(marker: MapboxGl.Marker) {\r\n    this.markersToRemove.push(marker);\r\n  }\r\n\r\n  createPopup(popup: SetupPopup, element: Node) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      Object.keys(popup.popupOptions).forEach(\r\n        (key) =>\r\n          (<any>popup.popupOptions)[key] === undefined &&\r\n          delete (<any>popup.popupOptions)[key]\r\n      );\r\n      const popupInstance = new MapboxGl.Popup(popup.popupOptions);\r\n      popupInstance.setDOMContent(element);\r\n      if (\r\n        popup.popupEvents.popupClose.observers.length ||\r\n        popup.popupEvents.close.observers.length\r\n      ) {\r\n        popupInstance.on('close', () => {\r\n          this.zone.run(() => {\r\n            popup.popupEvents.popupClose.emit();\r\n            popup.popupEvents.close.emit();\r\n          });\r\n        });\r\n      }\r\n      if (\r\n        popup.popupEvents.popupOpen.observers.length ||\r\n        popup.popupEvents.open.observers.length\r\n      ) {\r\n        popupInstance.on('open', () => {\r\n          this.zone.run(() => {\r\n            popup.popupEvents.popupOpen.emit();\r\n            popup.popupEvents.open.emit();\r\n          });\r\n        });\r\n      }\r\n      return popupInstance;\r\n    });\r\n  }\r\n\r\n  addPopupToMap(\r\n    popup: MapboxGl.Popup,\r\n    lngLat: MapboxGl.LngLatLike,\r\n    skipOpenEvent = false\r\n  ) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      if (skipOpenEvent && (<any>popup)._listeners) {\r\n        delete (<any>popup)._listeners['open'];\r\n      }\r\n      popup.setLngLat(lngLat);\r\n      popup.addTo(this.mapInstance);\r\n    });\r\n  }\r\n\r\n  addPopupToMarker(marker: MapboxGl.Marker, popup: MapboxGl.Popup) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      marker.setPopup(popup);\r\n    });\r\n  }\r\n\r\n  removePopupFromMap(popup: MapboxGl.Popup, skipCloseEvent = false) {\r\n    if (skipCloseEvent && (<any>popup)._listeners) {\r\n      delete (<any>popup)._listeners['close'];\r\n    }\r\n    this.popupsToRemove.push(popup);\r\n  }\r\n\r\n  removePopupFromMarker(marker: MapboxGl.Marker) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      marker.setPopup(undefined);\r\n    });\r\n  }\r\n\r\n  addControl(\r\n    control: MapboxGl.Control | MapboxGl.IControl,\r\n    position?: 'top-right' | 'top-left' | 'bottom-right' | 'bottom-left'\r\n  ) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      this.mapInstance.addControl(<any>control, position);\r\n    });\r\n  }\r\n\r\n  removeControl(control: MapboxGl.Control | MapboxGl.IControl) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      this.mapInstance.removeControl(<any>control);\r\n    });\r\n  }\r\n\r\n  async loadAndAddImage(\r\n    imageId: string,\r\n    url: string,\r\n    options?: MapImageOptions\r\n  ) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      return new Promise<void>((resolve, reject) => {\r\n        this.mapInstance.loadImage(url, (error, image) => {\r\n          if (error) {\r\n            reject(error);\r\n            return;\r\n          }\r\n          this.addImage(imageId, image as ImageBitmap, options);\r\n          resolve();\r\n        });\r\n      });\r\n    });\r\n  }\r\n\r\n  addImage(imageId: string, data: MapImageData, options?: MapImageOptions) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      this.mapInstance.addImage(imageId, <any>data, options);\r\n    });\r\n  }\r\n\r\n  removeImage(imageId: string) {\r\n    this.imageIdsToRemove.push(imageId);\r\n  }\r\n\r\n  addSource(sourceId: string, source: MapboxGl.AnySourceData) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      Object.keys(source).forEach(\r\n        (key) => (<any>source)[key] === undefined && delete (<any>source)[key]\r\n      );\r\n      this.mapInstance.addSource(sourceId, source);\r\n    });\r\n  }\r\n\r\n  getSource<T extends MapboxGl.AnySourceImpl>(sourceId: string) {\r\n    return <T>this.mapInstance.getSource(sourceId);\r\n  }\r\n\r\n  removeSource(sourceId: string) {\r\n    this.zone.runOutsideAngular(() => {\r\n      this.findLayersBySourceId(sourceId).forEach((layer) =>\r\n        this.mapInstance.removeLayer(layer.id)\r\n      );\r\n      this.mapInstance.removeSource(sourceId);\r\n    });\r\n  }\r\n\r\n  setAllLayerPaintProperty(\r\n    layerId: string,\r\n    paint:\r\n      | MapboxGl.BackgroundPaint\r\n      | MapboxGl.FillPaint\r\n      | MapboxGl.FillExtrusionPaint\r\n      | MapboxGl.LinePaint\r\n      | MapboxGl.SymbolPaint\r\n      | MapboxGl.RasterPaint\r\n      | MapboxGl.CirclePaint\r\n  ) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      Object.keys(paint).forEach((key) => {\r\n        // TODO Check for perf, setPaintProperty only on changed paint props maybe\r\n        this.mapInstance.setPaintProperty(layerId, key, (<any>paint)[key]);\r\n      });\r\n    });\r\n  }\r\n\r\n  setAllLayerLayoutProperty(\r\n    layerId: string,\r\n    layout:\r\n      | MapboxGl.BackgroundLayout\r\n      | MapboxGl.FillLayout\r\n      | MapboxGl.FillExtrusionLayout\r\n      | MapboxGl.LineLayout\r\n      | MapboxGl.SymbolLayout\r\n      | MapboxGl.RasterLayout\r\n      | MapboxGl.CircleLayout\r\n  ) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      Object.keys(layout).forEach((key) => {\r\n        // TODO Check for perf, setPaintProperty only on changed paint props maybe\r\n        this.mapInstance.setLayoutProperty(layerId, key, (<any>layout)[key]);\r\n      });\r\n    });\r\n  }\r\n\r\n  setLayerFilter(layerId: string, filter: any[]) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      this.mapInstance.setFilter(layerId, filter);\r\n    });\r\n  }\r\n\r\n  setLayerBefore(layerId: string, beforeId: string) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      this.mapInstance.moveLayer(layerId, beforeId);\r\n    });\r\n  }\r\n\r\n  setLayerZoomRange(layerId: string, minZoom?: number, maxZoom?: number) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      this.mapInstance.setLayerZoomRange(\r\n        layerId,\r\n        minZoom ? minZoom : 0,\r\n        maxZoom ? maxZoom : 20\r\n      );\r\n    });\r\n  }\r\n\r\n  fitBounds(\r\n    bounds: MapboxGl.LngLatBoundsLike,\r\n    options?: MapboxGl.FitBoundsOptions\r\n  ) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      this.mapInstance.fitBounds(bounds, options);\r\n    });\r\n  }\r\n\r\n  fitScreenCoordinates(\r\n    points: [MapboxGl.PointLike, MapboxGl.PointLike],\r\n    bearing: number,\r\n    options?: MapboxGl.AnimationOptions & MapboxGl.CameraOptions\r\n  ) {\r\n    return this.zone.runOutsideAngular(() => {\r\n      this.mapInstance.fitScreenCoordinates(\r\n        points[0],\r\n        points[1],\r\n        bearing,\r\n        options\r\n      );\r\n    });\r\n  }\r\n\r\n  applyChanges() {\r\n    this.zone.runOutsideAngular(() => {\r\n      this.removeMarkers();\r\n      this.removePopups();\r\n      this.removeImages();\r\n    });\r\n  }\r\n\r\n  private createMap(options: MapboxGl.MapboxOptions) {\r\n    NgZone.assertNotInAngularZone();\r\n    Object.keys(options).forEach((key: string) => {\r\n      const tkey = <keyof MapboxGl.MapboxOptions>key;\r\n      if (options[tkey] === undefined) {\r\n        delete options[tkey];\r\n      }\r\n    });\r\n    this.mapInstance = new MapboxGl.Map(options);\r\n\r\n    const isIEorEdge =\r\n      window && /msie\\s|trident\\/|edge\\//i.test(window.navigator.userAgent);\r\n    if (isIEorEdge) {\r\n      this.mapInstance.setStyle(options.style!);\r\n    }\r\n\r\n    this.subscription.add(\r\n      this.zone.onMicrotaskEmpty.subscribe(() => this.applyChanges())\r\n    );\r\n  }\r\n\r\n  private removeMarkers() {\r\n    for (const marker of this.markersToRemove) {\r\n      marker.remove();\r\n    }\r\n    this.markersToRemove = [];\r\n  }\r\n\r\n  private removePopups() {\r\n    for (const popup of this.popupsToRemove) {\r\n      popup.remove();\r\n    }\r\n    this.popupsToRemove = [];\r\n  }\r\n\r\n  private removeImages() {\r\n    for (const imageId of this.imageIdsToRemove) {\r\n      this.mapInstance.removeImage(imageId);\r\n    }\r\n    this.imageIdsToRemove = [];\r\n  }\r\n\r\n  private findLayersBySourceId(sourceId: string): MapboxGl.Layer[] {\r\n    const layers = this.mapInstance.getStyle().layers;\r\n    if (layers == null) {\r\n      return [];\r\n    }\r\n\r\n    return layers.filter((l) =>\r\n      'source' in l ? l.source === sourceId : false\r\n    );\r\n  }\r\n\r\n  private hookEvents(events: MapEvent) {\r\n    this.mapInstance.on('load', (evt) => {\r\n      this.mapLoaded.next(undefined);\r\n      this.mapLoaded.complete();\r\n      this.zone.run(() => {\r\n        events.mapLoad.emit(evt.target);\r\n        events.load.emit(evt.target);\r\n      });\r\n    });\r\n    if (events.mapResize.observers.length || events.resize.observers.length) {\r\n      this.mapInstance.on('resize', (evt) =>\r\n        this.zone.run(() => {\r\n          events.mapResize.emit(evt);\r\n          events.resize.emit(evt);\r\n        })\r\n      );\r\n    }\r\n    if (events.mapRemove.observers.length || events.remove.observers.length) {\r\n      this.mapInstance.on('remove', (evt) =>\r\n        this.zone.run(() => {\r\n          events.mapRemove.emit(evt);\r\n          events.remove.emit(evt);\r\n        })\r\n      );\r\n    }\r\n    if (\r\n      events.mapMouseDown.observers.length ||\r\n      events.mouseDown.observers.length\r\n    ) {\r\n      this.mapInstance.on('mousedown', (evt) =>\r\n        this.zone.run(() => {\r\n          events.mapMouseDown.emit(evt);\r\n          events.mouseDown.emit(evt);\r\n        })\r\n      );\r\n    }\r\n    if (events.mapMouseUp.observers.length || events.mouseUp.observers.length) {\r\n      this.mapInstance.on('mouseup', (evt) =>\r\n        this.zone.run(() => {\r\n          events.mapMouseUp.emit(evt);\r\n          events.mouseUp.emit(evt);\r\n        })\r\n      );\r\n    }\r\n    if (\r\n      events.mapMouseMove.observers.length ||\r\n      events.mouseMove.observers.length\r\n    ) {\r\n      this.mapInstance.on('mousemove', (evt) =>\r\n        this.zone.run(() => {\r\n          events.mapMouseMove.emit(evt);\r\n          events.mouseMove.emit(evt);\r\n        })\r\n      );\r\n    }\r\n    if (events.mapClick.observers.length || events.click.observers.length) {\r\n      this.mapInstance.on('click', (evt) =>\r\n        this.zone.run(() => {\r\n          events.mapClick.emit(evt);\r\n          events.click.emit(evt);\r\n        })\r\n      );\r\n    }\r\n    if (\r\n      events.mapDblClick.observers.length ||\r\n      events.dblClick.observers.length\r\n    ) {\r\n      this.mapInstance.on('dblclick', (evt) =>\r\n        this.zone.run(() => {\r\n          events.mapDblClick.emit(evt);\r\n          events.dblClick.emit(evt);\r\n        })\r\n      );\r\n    }\r\n    if (\r\n      events.mapMouseOver.observers.length ||\r\n      events.mouseOver.observers.length\r\n    ) {\r\n      this.mapInstance.on('mouseover', (evt) =>\r\n        this.zone.run(() => {\r\n          events.mapMouseOver.emit(evt);\r\n          events.mouseOver.emit(evt);\r\n        })\r\n      );\r\n    }\r\n    if (\r\n      events.mapMouseOut.observers.length ||\r\n      events.mouseOut.observers.length\r\n    ) {\r\n      this.mapInstance.on('mouseout', (evt) =>\r\n        this.zone.run(() => {\r\n          events.mapMouseOut.emit(evt);\r\n          events.mouseOut.emit(evt);\r\n        })\r\n      );\r\n    }\r\n    if (\r\n      events.mapContextMenu.observers.length ||\r\n      events.contextMenu.observers.length\r\n    ) {\r\n      this.mapInstance.on('contextmenu', (evt) =>\r\n        this.zone.run(() => {\r\n          events.mapContextMenu.emit(evt);\r\n          events.contextMenu.emit(evt);\r\n        })\r\n      );\r\n    }\r\n    if (\r\n      events.mapTouchStart.observers.length ||\r\n      events.touchStart.observers.length\r\n    ) {\r\n      this.mapInstance.on('touchstart', (evt) =>\r\n        this.zone.run(() => {\r\n          events.mapTouchStart.emit(evt);\r\n          events.touchStart.emit(evt);\r\n        })\r\n      );\r\n    }\r\n    if (\r\n      events.mapTouchEnd.observers.length ||\r\n      events.touchEnd.observers.length\r\n    ) {\r\n      this.mapInstance.on('touchend', (evt) =>\r\n        this.zone.run(() => {\r\n          events.mapTouchEnd.emit(evt);\r\n          events.touchEnd.emit(evt);\r\n        })\r\n      );\r\n    }\r\n    if (\r\n      events.mapTouchMove.observers.length ||\r\n      events.touchMove.observers.length\r\n    ) {\r\n      this.mapInstance.on('touchmove', (evt) =>\r\n        this.zone.run(() => {\r\n          events.mapTouchMove.emit(evt);\r\n          events.touchMove.emit(evt);\r\n        })\r\n      );\r\n    }\r\n    if (\r\n      events.mapTouchCancel.observers.length ||\r\n      events.touchCancel.observers.length\r\n    ) {\r\n      this.mapInstance.on('touchcancel', (evt) =>\r\n        this.zone.run(() => {\r\n          events.mapTouchCancel.emit(evt);\r\n          events.touchCancel.emit(evt);\r\n        })\r\n      );\r\n    }\r\n    if (events.mapWheel.observers.length || events.wheel.observers.length) {\r\n      this.mapInstance.on('wheel', (evt) =>\r\n        this.zone.run(() => {\r\n          events.mapWheel.emit(evt);\r\n          events.wheel.emit(evt);\r\n        })\r\n      );\r\n    }\r\n    if (events.moveStart.observers.length) {\r\n      this.mapInstance.on('movestart', (evt) =>\r\n        this.zone.run(() => events.moveStart.emit(evt))\r\n      );\r\n    }\r\n    if (events.move.observers.length) {\r\n      this.mapInstance.on('move', (evt) =>\r\n        this.zone.run(() => events.move.emit(evt))\r\n      );\r\n    }\r\n    if (events.moveEnd.observers.length) {\r\n      this.mapInstance.on('moveend', (evt) =>\r\n        this.zone.run(() => events.moveEnd.emit(evt))\r\n      );\r\n    }\r\n    if (\r\n      events.mapDragStart.observers.length ||\r\n      events.dragStart.observers.length\r\n    ) {\r\n      this.mapInstance.on('dragstart', (evt) =>\r\n        this.zone.run(() => {\r\n          events.mapDragStart.emit(evt);\r\n          events.dragStart.emit(evt);\r\n        })\r\n      );\r\n    }\r\n    if (events.mapDrag.observers.length || events.drag.observers.length) {\r\n      this.mapInstance.on('drag', (evt) =>\r\n        this.zone.run(() => {\r\n          events.mapDrag.emit(evt);\r\n          events.drag.emit(evt);\r\n        })\r\n      );\r\n    }\r\n    if (events.mapDragEnd.observers.length || events.dragEnd.observers.length) {\r\n      this.mapInstance.on('dragend', (evt) =>\r\n        this.zone.run(() => {\r\n          events.mapDragEnd.emit(evt);\r\n          events.dragEnd.emit(evt);\r\n        })\r\n      );\r\n    }\r\n    if (events.zoomStart.observers.length) {\r\n      this.mapInstance.on('zoomstart', (evt) =>\r\n        this.zone.run(() => events.zoomStart.emit(evt))\r\n      );\r\n    }\r\n    if (events.zoomEvt.observers.length) {\r\n      this.mapInstance.on('zoom', (evt) =>\r\n        this.zone.run(() => events.zoomEvt.emit(evt))\r\n      );\r\n    }\r\n    if (events.zoomEnd.observers.length) {\r\n      this.mapInstance.on('zoomend', (evt) =>\r\n        this.zone.run(() => events.zoomEnd.emit(evt))\r\n      );\r\n    }\r\n    if (events.rotateStart.observers.length) {\r\n      this.mapInstance.on('rotatestart', (evt) =>\r\n        this.zone.run(() => events.rotateStart.emit(evt))\r\n      );\r\n    }\r\n    if (events.rotate.observers.length) {\r\n      this.mapInstance.on('rotate', (evt) =>\r\n        this.zone.run(() => events.rotate.emit(evt))\r\n      );\r\n    }\r\n    if (events.rotateEnd.observers.length) {\r\n      this.mapInstance.on('rotateend', (evt) =>\r\n        this.zone.run(() => events.rotateEnd.emit(evt))\r\n      );\r\n    }\r\n    if (events.pitchStart.observers.length) {\r\n      this.mapInstance.on('pitchstart', (evt) =>\r\n        this.zone.run(() => events.pitchStart.emit(evt))\r\n      );\r\n    }\r\n    if (events.pitchEvt.observers.length) {\r\n      this.mapInstance.on('pitch', (evt) =>\r\n        this.zone.run(() => events.pitchEvt.emit(evt))\r\n      );\r\n    }\r\n    if (events.pitchEnd.observers.length) {\r\n      this.mapInstance.on('pitchend', (evt) =>\r\n        this.zone.run(() => events.pitchEnd.emit(evt))\r\n      );\r\n    }\r\n    if (events.boxZoomStart.observers.length) {\r\n      this.mapInstance.on('boxzoomstart', (evt) =>\r\n        this.zone.run(() => events.boxZoomStart.emit(evt))\r\n      );\r\n    }\r\n    if (events.boxZoomEnd.observers.length) {\r\n      this.mapInstance.on('boxzoomend', (evt) =>\r\n        this.zone.run(() => events.boxZoomEnd.emit(evt))\r\n      );\r\n    }\r\n    if (events.boxZoomCancel.observers.length) {\r\n      this.mapInstance.on('boxzoomcancel', (evt) =>\r\n        this.zone.run(() => events.boxZoomCancel.emit(evt))\r\n      );\r\n    }\r\n    if (events.webGlContextLost.observers.length) {\r\n      this.mapInstance.on('webglcontextlost', (evt) =>\r\n        this.zone.run(() => events.webGlContextLost.emit(evt))\r\n      );\r\n    }\r\n    if (events.webGlContextRestored.observers.length) {\r\n      this.mapInstance.on('webglcontextrestored', (evt) =>\r\n        this.zone.run(() => events.webGlContextRestored.emit(evt))\r\n      );\r\n    }\r\n    if (events.render.observers.length) {\r\n      this.mapInstance.on('render', (evt) =>\r\n        this.zone.run(() => events.render.emit(evt))\r\n      );\r\n    }\r\n    if (events.mapError.observers.length || events.error.observers.length) {\r\n      this.mapInstance.on('error', (evt) =>\r\n        this.zone.run(() => {\r\n          events.mapError.emit(evt);\r\n          events.error.emit(evt);\r\n        })\r\n      );\r\n    }\r\n    if (events.data.observers.length) {\r\n      this.mapInstance.on('data', (evt) =>\r\n        this.zone.run(() => events.data.emit(evt))\r\n      );\r\n    }\r\n    if (events.styleData.observers.length) {\r\n      this.mapInstance.on('styledata', (evt) =>\r\n        this.zone.run(() => events.styleData.emit(evt))\r\n      );\r\n    }\r\n    if (events.sourceData.observers.length) {\r\n      this.mapInstance.on('sourcedata', (evt) =>\r\n        this.zone.run(() => events.sourceData.emit(evt))\r\n      );\r\n    }\r\n    if (events.dataLoading.observers.length) {\r\n      this.mapInstance.on('dataloading', (evt) =>\r\n        this.zone.run(() => events.dataLoading.emit(evt))\r\n      );\r\n    }\r\n    if (events.styleDataLoading.observers.length) {\r\n      this.mapInstance.on('styledataloading', (evt) =>\r\n        this.zone.run(() => events.styleDataLoading.emit(evt))\r\n      );\r\n    }\r\n    if (events.sourceDataLoading.observers.length) {\r\n      this.mapInstance.on('sourcedataloading', (evt) =>\r\n        this.zone.run(() => events.sourceDataLoading.emit(evt))\r\n      );\r\n    }\r\n    if (events.styleImageMissing.observers.length) {\r\n      this.mapInstance.on('styleimagemissing', (evt) =>\r\n        this.zone.run(() => events.styleImageMissing.emit(evt))\r\n      );\r\n    }\r\n    if (events.idle.observers.length) {\r\n      this.mapInstance.on('idle', (evt) =>\r\n        this.zone.run(() => events.idle.emit(evt))\r\n      );\r\n    }\r\n  }\r\n\r\n  // TODO move this elsewhere\r\n  private assign(obj: any, prop: any, value: any) {\r\n    if (typeof prop === 'string') {\r\n      // tslint:disable-next-line:no-parameter-reassignment\r\n      prop = prop.split('.');\r\n    }\r\n    if (prop.length > 1) {\r\n      const e = prop.shift();\r\n      this.assign(\r\n        (obj[e] =\r\n          Object.prototype.toString.call(obj[e]) === '[object Object]'\r\n            ? obj[e]\r\n            : {}),\r\n        prop,\r\n        value\r\n      );\r\n    } else {\r\n      obj[prop[0]] = value;\r\n    }\r\n  }\r\n}\r\n","import {\r\n  AfterContentInit,\r\n  ChangeDetectionStrategy,\r\n  Component,\r\n  ElementRef,\r\n  Input,\r\n  OnDestroy,\r\n  ViewChild,\r\n} from '@angular/core';\r\nimport { IControl } from 'mapbox-gl';\r\nimport { MapService } from '../map/map.service';\r\n\r\nexport class CustomControl implements IControl {\r\n  constructor(private container: HTMLElement) {}\r\n\r\n  onAdd() {\r\n    return this.container;\r\n  }\r\n\r\n  onRemove() {\r\n    return this.container.parentNode!.removeChild(this.container);\r\n  }\r\n\r\n  getDefaultPosition() {\r\n    return 'top-right';\r\n  }\r\n}\r\n\r\n@Component({\r\n  selector: 'mgl-control',\r\n  template:\r\n    '<div class=\"mapboxgl-ctrl\" #content><ng-content></ng-content></div>',\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class ControlComponent<T extends IControl>\r\n  implements OnDestroy, AfterContentInit {\r\n  private controlAdded = false;\r\n\r\n  /* Init inputs */\r\n  @Input() position?: 'top-left' | 'top-right' | 'bottom-left' | 'bottom-right';\r\n\r\n  @ViewChild('content', { static: true }) content: ElementRef;\r\n\r\n  control: T | CustomControl;\r\n\r\n  constructor(private MapService: MapService) {}\r\n\r\n  ngAfterContentInit() {\r\n    if (this.content.nativeElement.childNodes.length) {\r\n      this.control = new CustomControl(this.content.nativeElement);\r\n      this.MapService.mapCreated$.subscribe(() => {\r\n        this.MapService.addControl(this.control!, this.position);\r\n        this.controlAdded = true;\r\n      });\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    if (this.controlAdded) {\r\n      this.MapService.removeControl(this.control);\r\n    }\r\n  }\r\n}\r\n","import { AfterContentInit, Directive, Host, Input } from '@angular/core';\r\nimport { AttributionControl } from 'mapbox-gl';\r\nimport { MapService } from '../map/map.service';\r\nimport { ControlComponent } from './control.component';\r\n\r\n@Directive({\r\n  selector: '[mglAttribution]',\r\n})\r\nexport class AttributionControlDirective implements AfterContentInit {\r\n  /* Init inputs */\r\n  @Input() compact?: boolean;\r\n  @Input() customAttribution?: string | string[];\r\n\r\n  constructor(\r\n    private MapService: MapService,\r\n    @Host() private ControlComponent: ControlComponent<AttributionControl>\r\n  ) {}\r\n\r\n  ngAfterContentInit() {\r\n    this.MapService.mapCreated$.subscribe(() => {\r\n      if (this.ControlComponent.control) {\r\n        throw new Error('Another control is already set for this control');\r\n      }\r\n      const options: {\r\n        compact?: boolean;\r\n        customAttribution?: string | string[];\r\n      } = {};\r\n      if (this.compact !== undefined) {\r\n        options.compact = this.compact;\r\n      }\r\n      if (this.customAttribution !== undefined) {\r\n        options.customAttribution = this.customAttribution;\r\n      }\r\n      this.ControlComponent.control = new AttributionControl(options);\r\n      this.MapService.addControl(\r\n        this.ControlComponent.control,\r\n        this.ControlComponent.position\r\n      );\r\n    });\r\n  }\r\n}\r\n","import { AfterContentInit, Directive, Host, Input } from '@angular/core';\r\nimport { FullscreenControl } from 'mapbox-gl';\r\nimport { MapService } from '../map/map.service';\r\nimport { ControlComponent } from './control.component';\r\n\r\n@Directive({\r\n  selector: '[mglFullscreen]',\r\n})\r\nexport class FullscreenControlDirective implements AfterContentInit {\r\n  /* Init inputs */\r\n  @Input() container?: HTMLElement;\r\n\r\n  constructor(\r\n    private MapService: MapService,\r\n    @Host() private ControlComponent: ControlComponent<FullscreenControl>\r\n  ) {}\r\n\r\n  ngAfterContentInit() {\r\n    this.MapService.mapCreated$.subscribe(() => {\r\n      if (this.ControlComponent.control) {\r\n        throw new Error('Another control is already set for this control');\r\n      }\r\n      this.ControlComponent.control = new FullscreenControl({\r\n        container: this.container,\r\n      });\r\n      this.MapService.addControl(\r\n        this.ControlComponent.control,\r\n        this.ControlComponent.position\r\n      );\r\n    });\r\n  }\r\n}\r\n","export function deprecationWarning(\r\n  context: string,\r\n  oldApi: string,\r\n  newApi: string\r\n) {\r\n  console.warn(\r\n    `[ngx-mapbox-gl]: ${context}: ${oldApi} is deprecated, please use ${newApi} instead.`\r\n  );\r\n}\r\n","import {\r\n  AfterContentInit,\r\n  Directive,\r\n  EventEmitter,\r\n  Host,\r\n  Inject,\r\n  InjectionToken,\r\n  Input,\r\n  NgZone,\r\n  OnChanges,\r\n  Optional,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport MapboxGeocoder, {\r\n  Result,\r\n  Results,\r\n  LngLatLiteral,\r\n  GeocoderOptions,\r\n} from '@mapbox/mapbox-gl-geocoder';\r\nimport { MapService } from '../map/map.service';\r\nimport { GeocoderEvent } from '../map/map.types';\r\nimport { deprecationWarning } from '../utils';\r\nimport { ControlComponent } from './control.component';\r\nimport { Map, Marker } from 'mapbox-gl';\r\n\r\nexport const MAPBOX_GEOCODER_API_KEY = new InjectionToken('MapboxApiKey');\r\nexport { Result, Results } from '@mapbox/mapbox-gl-geocoder';\r\n\r\n@Directive({\r\n  selector: '[mglGeocoder]',\r\n})\r\nexport class GeocoderControlDirective\r\n  implements AfterContentInit, OnChanges, GeocoderEvent {\r\n  /* Init inputs */\r\n  @Input() countries?: string;\r\n  @Input() placeholder?: string;\r\n  @Input() zoom?: number;\r\n  @Input() bbox?: [number, number, number, number];\r\n  @Input() types?: string;\r\n  @Input() flyTo?: boolean;\r\n  @Input() minLength?: number;\r\n  @Input() limit?: number;\r\n  @Input() language?: string;\r\n  @Input() accessToken?: string;\r\n  @Input() filter?: (feature: Result) => boolean;\r\n  @Input() localGeocoder?: (query: string) => Result[];\r\n  @Input() mapboxgl?: Map;\r\n  @Input() marker: boolean | Marker = false;\r\n\r\n  /* Dynamic inputs */\r\n  @Input() proximity?: LngLatLiteral;\r\n  @Input() searchInput: string;\r\n\r\n  @Output() clear = new EventEmitter<void>();\r\n  @Output() loading = new EventEmitter<{ query: string }>();\r\n\r\n  @Output() geocoderResults = new EventEmitter<Results>();\r\n\r\n  @Output() geocoderResult = new EventEmitter<{ result: Result }>();\r\n\r\n  @Output() geocoderError = new EventEmitter<any>();\r\n  /**\r\n   * @deprecated Use geocoderResults instead\r\n   */\r\n  @Output() results = new EventEmitter<Results>();\r\n  /**\r\n   * @deprecated Use geocoderResult instead\r\n   */\r\n  @Output() result = new EventEmitter<{ result: Result }>();\r\n  /**\r\n   * @deprecated Use geocoderError instead\r\n   */\r\n  @Output() error = new EventEmitter<any>();\r\n\r\n  geocoder: MapboxGeocoder;\r\n\r\n  private lastResultId?: string | number;\r\n\r\n  constructor(\r\n    private MapService: MapService,\r\n    private zone: NgZone,\r\n    @Host() private ControlComponent: ControlComponent<MapboxGeocoder>,\r\n    @Optional()\r\n    @Inject(MAPBOX_GEOCODER_API_KEY)\r\n    private readonly MAPBOX_GEOCODER_API_KEY: string\r\n  ) {}\r\n\r\n  ngAfterContentInit() {\r\n    this.MapService.mapCreated$.subscribe(() => {\r\n      if (this.ControlComponent.control) {\r\n        throw new Error('Another control is already set for this control');\r\n      }\r\n      const options: GeocoderOptions = {\r\n        proximity: this.proximity,\r\n        countries: this.countries,\r\n        placeholder: this.placeholder,\r\n        zoom: this.zoom,\r\n        bbox: this.bbox,\r\n        types: this.types,\r\n        flyTo: this.flyTo,\r\n        minLength: this.minLength,\r\n        limit: this.limit,\r\n        language: this.language,\r\n        filter: this.filter,\r\n        localGeocoder: this.localGeocoder,\r\n        accessToken: this.accessToken || this.MAPBOX_GEOCODER_API_KEY,\r\n        mapboxgl: this.mapboxgl,\r\n        marker: this.marker,\r\n      };\r\n\r\n      Object.keys(options).forEach((key: string) => {\r\n        const tkey = <keyof typeof options>key;\r\n        if (options[tkey] === undefined) {\r\n          delete options[tkey];\r\n        }\r\n      });\r\n      this.geocoder = new MapboxGeocoder(options);\r\n      this.hookEvents(this);\r\n      this.addControl();\r\n    });\r\n    if (this.searchInput) {\r\n      this.MapService.mapLoaded$.subscribe(() => {\r\n        this.geocoder.query(this.searchInput);\r\n      });\r\n    }\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (!this.geocoder) {\r\n      return;\r\n    }\r\n    if (changes.proximity && !changes.proximity.isFirstChange()) {\r\n      this.geocoder.setProximity(changes.proximity.currentValue);\r\n    }\r\n    if (changes.searchInput) {\r\n      this.geocoder.query(this.searchInput);\r\n    }\r\n  }\r\n\r\n  private addControl() {\r\n    this.ControlComponent.control = this.geocoder;\r\n    this.MapService.addControl(\r\n      this.ControlComponent.control,\r\n      this.ControlComponent.position\r\n    );\r\n  }\r\n\r\n  private hookEvents(events: GeocoderEvent) {\r\n    this.warnDeprecatedOutputs(events);\r\n    if (\r\n      events.results.observers.length ||\r\n      events.geocoderResults.observers.length\r\n    ) {\r\n      this.geocoder.on('results', (evt: Results) =>\r\n        this.zone.run(() => {\r\n          events.geocoderResults.emit(evt);\r\n          events.results.emit(evt);\r\n        })\r\n      );\r\n    }\r\n    if (\r\n      events.geocoderResult.observers.length ||\r\n      events.result.observers.length\r\n    ) {\r\n      this.geocoder.on('result', (evt: { result: Result }) => {\r\n        // Workaroud issue https://github.com/mapbox/mapbox-gl-geocoder/issues/99\r\n        if (this.lastResultId !== evt.result.id) {\r\n          this.lastResultId = evt.result.id;\r\n          this.zone.run(() => {\r\n            events.geocoderResult.emit(evt);\r\n            events.result.emit(evt);\r\n          });\r\n        }\r\n      });\r\n    }\r\n    if (\r\n      events.error.observers.length ||\r\n      events.geocoderError.observers.length\r\n    ) {\r\n      this.geocoder.on('error', (evt: any) =>\r\n        this.zone.run(() => {\r\n          events.geocoderError.emit(evt);\r\n          events.error.emit(evt);\r\n        })\r\n      );\r\n    }\r\n    if (events.loading.observers.length) {\r\n      this.geocoder.on('loading', (evt: { query: string }) =>\r\n        this.zone.run(() => events.loading.emit(evt))\r\n      );\r\n    }\r\n    if (events.clear.observers.length) {\r\n      this.geocoder.on('clear', () => this.zone.run(() => events.clear.emit()));\r\n    }\r\n  }\r\n\r\n  private warnDeprecatedOutputs(events: GeocoderEvent) {\r\n    const dw = deprecationWarning.bind(\r\n      undefined,\r\n      GeocoderControlDirective.name\r\n    );\r\n    if (events.results.observers.length) {\r\n      dw('results', 'geocoderResults');\r\n    }\r\n    if (events.result.observers.length) {\r\n      dw('result', 'geocoderResult');\r\n    }\r\n    if (events.error.observers.length) {\r\n      dw('error', 'geocoderError');\r\n    }\r\n  }\r\n}\r\n","import {\r\n  AfterContentInit,\r\n  Directive,\r\n  EventEmitter,\r\n  Host,\r\n  Input,\r\n  Output,\r\n} from '@angular/core';\r\nimport { FitBoundsOptions, GeolocateControl } from 'mapbox-gl';\r\nimport { MapService } from '../map/map.service';\r\nimport { ControlComponent } from './control.component';\r\nimport { Position } from '../map/map.types'\r\n\r\n@Directive({\r\n  selector: '[mglGeolocate]',\r\n})\r\nexport class GeolocateControlDirective implements AfterContentInit {\r\n  /* Init inputs */\r\n  @Input() positionOptions?: PositionOptions;\r\n  @Input() fitBoundsOptions?: FitBoundsOptions;\r\n  @Input() trackUserLocation?: boolean;\r\n  @Input() showUserLocation?: boolean;\r\n\r\n  @Output()\r\n  geolocate: EventEmitter<Position> = new EventEmitter<Position>();\r\n\r\n  constructor(\r\n    private MapService: MapService,\r\n    @Host() private ControlComponent: ControlComponent<GeolocateControl>\r\n  ) {}\r\n\r\n  ngAfterContentInit() {\r\n    this.MapService.mapCreated$.subscribe(() => {\r\n      if (this.ControlComponent.control) {\r\n        throw new Error('Another control is already set for this control');\r\n      }\r\n      const options = {\r\n        positionOptions: this.positionOptions,\r\n        fitBoundsOptions: this.fitBoundsOptions,\r\n        trackUserLocation: this.trackUserLocation,\r\n        showUserLocation: this.showUserLocation,\r\n      };\r\n\r\n      Object.keys(options).forEach((key: string) => {\r\n        const tkey = <keyof typeof options>key;\r\n        if (options[tkey] === undefined) {\r\n          delete options[tkey];\r\n        }\r\n      });\r\n      this.ControlComponent.control = new GeolocateControl(options);\r\n      this.ControlComponent.control.on('geolocate', (data) => {\r\n          this.geolocate.emit(data as Position);\r\n        }\r\n      );\r\n      this.MapService.addControl(\r\n        this.ControlComponent.control,\r\n        this.ControlComponent.position\r\n      );\r\n    });\r\n  }\r\n}\r\n","import { AfterContentInit, Directive, Host, Input } from '@angular/core';\r\nimport { NavigationControl } from 'mapbox-gl';\r\nimport { MapService } from '../map/map.service';\r\nimport { ControlComponent } from './control.component';\r\n\r\n@Directive({\r\n  selector: '[mglNavigation]',\r\n})\r\nexport class NavigationControlDirective implements AfterContentInit {\r\n  /* Init inputs */\r\n  @Input() showCompass?: boolean;\r\n  @Input() showZoom?: boolean;\r\n\r\n  constructor(\r\n    private MapService: MapService,\r\n    @Host() private ControlComponent: ControlComponent<NavigationControl>\r\n  ) {}\r\n\r\n  ngAfterContentInit() {\r\n    this.MapService.mapCreated$.subscribe(() => {\r\n      if (this.ControlComponent.control) {\r\n        throw new Error('Another control is already set for this control');\r\n      }\r\n      const options: { showCompass?: boolean; showZoom?: boolean } = {};\r\n      if (this.showCompass !== undefined) {\r\n        options.showCompass = this.showCompass;\r\n      }\r\n      if (this.showZoom !== undefined) {\r\n        options.showZoom = this.showZoom;\r\n      }\r\n      this.ControlComponent.control = new NavigationControl(options);\r\n      this.MapService.addControl(\r\n        this.ControlComponent.control,\r\n        this.ControlComponent.position\r\n      );\r\n    });\r\n  }\r\n}\r\n","import {\r\n  AfterContentInit,\r\n  Directive,\r\n  Host,\r\n  Input,\r\n  OnChanges,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { ScaleControl } from 'mapbox-gl';\r\nimport { MapService } from '../map/map.service';\r\nimport { ControlComponent } from './control.component';\r\n\r\n@Directive({\r\n  selector: '[mglScale]',\r\n})\r\nexport class ScaleControlDirective implements AfterContentInit, OnChanges {\r\n  /* Init inputs */\r\n  @Input() maxWidth?: number;\r\n\r\n  /* Dynamic inputs */\r\n  @Input() unit?: 'imperial' | 'metric' | 'nautical';\r\n\r\n  constructor(\r\n    private MapService: MapService,\r\n    @Host() private ControlComponent: ControlComponent<ScaleControl>\r\n  ) {}\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (changes.unit && !changes.unit.isFirstChange()) {\r\n      (<any>this.ControlComponent.control).setUnit(changes.unit.currentValue);\r\n    }\r\n  }\r\n\r\n  ngAfterContentInit() {\r\n    this.MapService.mapCreated$.subscribe(() => {\r\n      if (this.ControlComponent.control) {\r\n        throw new Error('Another control is already set for this control');\r\n      }\r\n      const options: { maxWidth?: number; unit?: string } = {};\r\n      if (this.maxWidth !== undefined) {\r\n        options.maxWidth = this.maxWidth;\r\n      }\r\n      if (this.unit !== undefined) {\r\n        options.unit = this.unit;\r\n      }\r\n      this.ControlComponent.control = new ScaleControl(options);\r\n      this.MapService.addControl(\r\n        this.ControlComponent.control,\r\n        this.ControlComponent.position\r\n      );\r\n    });\r\n  }\r\n}\r\n","import {\r\n  ChangeDetectionStrategy,\r\n  Component,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  SimpleChanges,\r\n  NgZone,\r\n} from '@angular/core';\r\nimport {\r\n  GeoJSONSource,\r\n  GeoJSONSourceOptions,\r\n  GeoJSONSourceRaw,\r\n} from 'mapbox-gl';\r\nimport { fromEvent, Subject, Subscription } from 'rxjs';\r\nimport { debounceTime, filter } from 'rxjs/operators';\r\nimport { MapService } from '../../map/map.service';\r\n\r\n@Component({\r\n  selector: 'mgl-geojson-source',\r\n  template: '',\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class GeoJSONSourceComponent\r\n  implements OnInit, OnDestroy, OnChanges, GeoJSONSourceOptions {\r\n  /* Init inputs */\r\n  @Input() id: string;\r\n\r\n  /* Dynamic inputs */\r\n  @Input() data?: GeoJSONSourceOptions['data'];\r\n  @Input() maxzoom?: GeoJSONSourceOptions['maxzoom'];\r\n  @Input() attribution?: GeoJSONSourceOptions['attribution'];\r\n  @Input() buffer?: GeoJSONSourceOptions['buffer'];\r\n  @Input() tolerance?: GeoJSONSourceOptions['tolerance'];\r\n  @Input() cluster?: GeoJSONSourceOptions['cluster'];\r\n  @Input() clusterRadius?: GeoJSONSourceOptions['clusterRadius'];\r\n  @Input() clusterMaxZoom?: GeoJSONSourceOptions['clusterMaxZoom'];\r\n  @Input() clusterMinPoints?: GeoJSONSourceOptions['clusterMinPoints'];\r\n  @Input() clusterProperties?: GeoJSONSourceOptions['clusterProperties'];\r\n  @Input() lineMetrics?: GeoJSONSourceOptions['lineMetrics'];\r\n  @Input() generateId?: GeoJSONSourceOptions['generateId'];\r\n  @Input() promoteId?: GeoJSONSourceOptions['promoteId'];\r\n  @Input() filter?: GeoJSONSourceOptions['filter'];\r\n\r\n  updateFeatureData = new Subject();\r\n\r\n  private sub = new Subscription();\r\n  private sourceAdded = false;\r\n  private featureIdCounter = 0;\r\n\r\n  constructor(private MapService: MapService, private zone: NgZone) {}\r\n\r\n  ngOnInit() {\r\n    if (!this.data) {\r\n      this.data = {\r\n        type: 'FeatureCollection',\r\n        features: [],\r\n      };\r\n    }\r\n    const sub1 = this.MapService.mapLoaded$.subscribe(() => {\r\n      this.init();\r\n      const sub = fromEvent(<any>this.MapService.mapInstance, 'styledata')\r\n        .pipe(filter(() => !this.MapService.mapInstance.getSource(this.id)))\r\n        .subscribe(() => {\r\n          this.init();\r\n        });\r\n      this.sub.add(sub);\r\n    });\r\n    this.sub.add(sub1);\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (!this.sourceAdded) {\r\n      return;\r\n    }\r\n    if (\r\n      (changes.maxzoom && !changes.maxzoom.isFirstChange()) ||\r\n      (changes.attribution && !changes.attribution.isFirstChange()) ||\r\n      (changes.buffer && !changes.buffer.isFirstChange()) ||\r\n      (changes.tolerance && !changes.tolerance.isFirstChange()) ||\r\n      (changes.cluster && !changes.cluster.isFirstChange()) ||\r\n      (changes.clusterRadius && !changes.clusterRadius.isFirstChange()) ||\r\n      (changes.clusterMaxZoom && !changes.clusterMaxZoom.isFirstChange()) ||\r\n      (changes.clusterMinPoints && !changes.clusterMinPoints.isFirstChange()) ||\r\n      (changes.clusterProperties &&\r\n        !changes.clusterProperties.isFirstChange()) ||\r\n      (changes.lineMetrics && !changes.lineMetrics.isFirstChange()) ||\r\n      (changes.generateId && !changes.generateId.isFirstChange()) ||\r\n      (changes.promoteId && !changes.promoteId.isFirstChange()) ||\r\n      (changes.filter && !changes.filter.isFirstChange())\r\n    ) {\r\n      this.ngOnDestroy();\r\n      this.ngOnInit();\r\n    }\r\n    if (changes.data && !changes.data.isFirstChange()) {\r\n      const source = this.MapService.getSource<GeoJSONSource>(this.id);\r\n      source.setData(this.data!);\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.sub.unsubscribe();\r\n    if (this.sourceAdded) {\r\n      this.MapService.removeSource(this.id);\r\n      this.sourceAdded = false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * For clustered sources, fetches the zoom at which the given cluster expands.\r\n   * @param clusterId The value of the cluster's cluster_id property.\r\n   */\r\n  async getClusterExpansionZoom(clusterId: number) {\r\n    const source = this.MapService.getSource<GeoJSONSource>(this.id);\r\n    return this.zone.run(async () => {\r\n      return new Promise<number>((resolve, reject) => {\r\n        source.getClusterExpansionZoom(clusterId, (error, zoom) => {\r\n          if (error) {\r\n            reject(error);\r\n          } else {\r\n            resolve(zoom);\r\n          }\r\n        });\r\n      });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * For clustered sources, fetches the children of the given cluster on the next zoom level (as an array of GeoJSON features).\r\n   * @param clusterId The value of the cluster's cluster_id property.\r\n   */\r\n  async getClusterChildren(clusterId: number) {\r\n    const source = this.MapService.getSource<GeoJSONSource>(this.id);\r\n    return this.zone.run(async () => {\r\n      return new Promise<GeoJSON.Feature<GeoJSON.Geometry>[]>(\r\n        (resolve, reject) => {\r\n          source.getClusterChildren(clusterId, (error, features) => {\r\n            if (error) {\r\n              reject(error);\r\n            } else {\r\n              resolve(features);\r\n            }\r\n          });\r\n        }\r\n      );\r\n    });\r\n  }\r\n\r\n  /**\r\n   * For clustered sources, fetches the original points that belong to the cluster (as an array of GeoJSON features).\r\n   * @param clusterId The value of the cluster's cluster_id property.\r\n   * @param limit The maximum number of features to return.\r\n   * @param offset The number of features to skip (e.g. for pagination).\r\n   */\r\n  async getClusterLeaves(clusterId: number, limit: number, offset: number) {\r\n    const source = this.MapService.getSource<GeoJSONSource>(this.id);\r\n    return this.zone.run(async () => {\r\n      return new Promise<GeoJSON.Feature<GeoJSON.Geometry>[]>(\r\n        (resolve, reject) => {\r\n          source.getClusterLeaves(\r\n            clusterId,\r\n            limit,\r\n            offset,\r\n            (error, features) => {\r\n              if (error) {\r\n                reject(error);\r\n              } else {\r\n                resolve(features);\r\n              }\r\n            }\r\n          );\r\n        }\r\n      );\r\n    });\r\n  }\r\n\r\n  _addFeature(feature: GeoJSON.Feature<GeoJSON.GeometryObject>) {\r\n    const collection = <GeoJSON.FeatureCollection<GeoJSON.GeometryObject>>(\r\n      this.data\r\n    );\r\n    collection.features.push(feature);\r\n    this.updateFeatureData.next();\r\n  }\r\n\r\n  _removeFeature(feature: GeoJSON.Feature<GeoJSON.GeometryObject>) {\r\n    const collection = <GeoJSON.FeatureCollection<GeoJSON.GeometryObject>>(\r\n      this.data\r\n    );\r\n    const index = collection.features.indexOf(feature);\r\n    if (index > -1) {\r\n      collection.features.splice(index, 1);\r\n    }\r\n    this.updateFeatureData.next();\r\n  }\r\n\r\n  _getNewFeatureId() {\r\n    return ++this.featureIdCounter;\r\n  }\r\n\r\n  private init() {\r\n    const source: GeoJSONSourceRaw = {\r\n      type: 'geojson',\r\n      data: this.data,\r\n      maxzoom: this.maxzoom,\r\n      attribution: this.attribution,\r\n      buffer: this.buffer,\r\n      tolerance: this.tolerance,\r\n      cluster: this.cluster,\r\n      clusterRadius: this.clusterRadius,\r\n      clusterMaxZoom: this.clusterMaxZoom,\r\n      clusterMinPoints: this.clusterMinPoints,\r\n      clusterProperties: this.clusterProperties,\r\n      lineMetrics: this.lineMetrics,\r\n      generateId: this.generateId,\r\n      promoteId: this.promoteId,\r\n      filter: this.filter,\r\n    };\r\n    this.MapService.addSource(this.id, source);\r\n    const sub = this.updateFeatureData.pipe(debounceTime(0)).subscribe(() => {\r\n      const source = this.MapService.getSource<GeoJSONSource>(this.id);\r\n      source.setData(this.data!);\r\n    });\r\n    this.sub.add(sub);\r\n    this.sourceAdded = true;\r\n  }\r\n}\r\n","import {\r\n  Component,\r\n  forwardRef,\r\n  Inject,\r\n  Input,\r\n  OnDestroy,\r\n  OnInit,\r\n  ChangeDetectionStrategy,\r\n} from '@angular/core';\r\nimport { GeoJSONSourceComponent } from './geojson-source.component';\r\n\r\n@Component({\r\n  selector: 'mgl-feature',\r\n  template: '',\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class FeatureComponent\r\n  implements OnInit, OnDestroy, GeoJSON.Feature<GeoJSON.GeometryObject> {\r\n  /* Init inputs */\r\n  @Input() id?: number; // FIXME number only for now https://github.com/mapbox/mapbox-gl-js/issues/2716\r\n  @Input() geometry: GeoJSON.GeometryObject;\r\n  @Input() properties: any;\r\n  type: 'Feature' = 'Feature';\r\n\r\n  private feature: GeoJSON.Feature<GeoJSON.GeometryObject>;\r\n\r\n  constructor(\r\n    @Inject(forwardRef(() => GeoJSONSourceComponent))\r\n    private GeoJSONSourceComponent: GeoJSONSourceComponent\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    if (!this.id) {\r\n      this.id = this.GeoJSONSourceComponent._getNewFeatureId();\r\n    }\r\n    this.feature = {\r\n      type: this.type,\r\n      geometry: this.geometry,\r\n      properties: this.properties ? this.properties : {},\r\n    };\r\n    this.feature.id = this.id;\r\n    this.GeoJSONSourceComponent._addFeature(this.feature);\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.GeoJSONSourceComponent._removeFeature(this.feature);\r\n  }\r\n\r\n  updateCoordinates(coordinates: number[]) {\r\n    (<GeoJSON.Point>this.feature.geometry).coordinates = coordinates;\r\n    this.GeoJSONSourceComponent.updateFeatureData.next();\r\n  }\r\n}\r\n","import {\r\n  Directive,\r\n  EventEmitter,\r\n  Host,\r\n  Input,\r\n  NgZone,\r\n  OnDestroy,\r\n  OnInit,\r\n  Optional,\r\n  Output,\r\n} from '@angular/core';\r\nimport { MapMouseEvent } from 'mapbox-gl';\r\nimport { fromEvent, Observable, Subscription } from 'rxjs';\r\nimport { filter, switchMap, take, takeUntil, tap } from 'rxjs/operators';\r\nimport { LayerComponent } from '../layer/layer.component';\r\nimport { MapService } from '../map/map.service';\r\nimport { FeatureComponent } from '../source/geojson/feature.component';\r\nimport { deprecationWarning } from '../utils';\r\n\r\n@Directive({\r\n  selector: '[mglDraggable]',\r\n})\r\nexport class DraggableDirective implements OnInit, OnDestroy {\r\n  // tslint:disable-next-line:no-input-rename\r\n  @Input('mglDraggable') layer?: LayerComponent;\r\n\r\n  @Output() featureDragStart = new EventEmitter<MapMouseEvent>();\r\n  @Output() featureDragEnd = new EventEmitter<MapMouseEvent>();\r\n  @Output() featureDrag = new EventEmitter<MapMouseEvent>();\r\n  /**\r\n   * @deprecated Use featureDragStart instead\r\n   */\r\n  @Output() dragStart = new EventEmitter<MapMouseEvent>();\r\n  /**\r\n   * @deprecated Use featureDragEnd instead\r\n   */\r\n  @Output() dragEnd = new EventEmitter<MapMouseEvent>();\r\n  /**\r\n   * @deprecated Use featureDrag instead\r\n   */\r\n  @Output() drag = new EventEmitter<MapMouseEvent>();\r\n\r\n  private sub = new Subscription();\r\n\r\n  constructor(\r\n    private MapService: MapService,\r\n    private NgZone: NgZone,\r\n    @Optional() @Host() private FeatureComponent?: FeatureComponent\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.warnDeprecatedOutputs();\r\n    let enter$;\r\n    let leave$;\r\n    let updateCoords;\r\n    if (this.FeatureComponent && this.layer) {\r\n      enter$ = this.layer.layerMouseEnter;\r\n      leave$ = this.layer.layerMouseLeave;\r\n      updateCoords = this.FeatureComponent.updateCoordinates.bind(\r\n        this.FeatureComponent\r\n      );\r\n      if (this.FeatureComponent.geometry.type !== 'Point') {\r\n        throw new Error('mglDraggable only support point feature');\r\n      }\r\n    } else {\r\n      throw new Error(\r\n        'mglDraggable can only be used on Feature (with a layer as input) or Marker'\r\n      );\r\n    }\r\n\r\n    this.handleDraggable(enter$, leave$, updateCoords);\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.sub.unsubscribe();\r\n  }\r\n\r\n  private handleDraggable(\r\n    enter$: Observable<MapMouseEvent>,\r\n    leave$: Observable<MapMouseEvent>,\r\n    updateCoords: (coord: number[]) => void\r\n  ) {\r\n    let moving = false;\r\n    let inside = false;\r\n    this.MapService.mapCreated$.subscribe(() => {\r\n      const mouseUp$ = fromEvent<MapMouseEvent>(\r\n        <any>this.MapService.mapInstance,\r\n        'mouseup'\r\n      );\r\n      const dragStart$ = enter$.pipe(\r\n        filter(() => !moving),\r\n        filter((evt) => this.filterFeature(evt)),\r\n        tap(() => {\r\n          inside = true;\r\n          this.MapService.changeCanvasCursor('move');\r\n          this.MapService.updateDragPan(false);\r\n        }),\r\n        switchMap(() =>\r\n          fromEvent<MapMouseEvent>(\r\n            <any>this.MapService.mapInstance,\r\n            'mousedown'\r\n          ).pipe(takeUntil(leave$))\r\n        )\r\n      );\r\n      const dragging$ = dragStart$.pipe(\r\n        switchMap(() =>\r\n          fromEvent<MapMouseEvent>(\r\n            <any>this.MapService.mapInstance,\r\n            'mousemove'\r\n          ).pipe(takeUntil(mouseUp$))\r\n        )\r\n      );\r\n      const dragEnd$ = dragStart$.pipe(switchMap(() => mouseUp$.pipe(take(1))));\r\n      this.sub.add(\r\n        dragStart$.subscribe((evt) => {\r\n          moving = true;\r\n          if (\r\n            this.featureDragStart.observers.length ||\r\n            this.dragStart.observers.length\r\n          ) {\r\n            this.NgZone.run(() => {\r\n              this.featureDragStart.emit(evt);\r\n              this.dragStart.emit(evt);\r\n            });\r\n          }\r\n        })\r\n      );\r\n      this.sub.add(\r\n        dragging$.subscribe((evt) => {\r\n          updateCoords([evt.lngLat.lng, evt.lngLat.lat]);\r\n          if (this.featureDrag.observers.length || this.drag.observers.length) {\r\n            this.NgZone.run(() => {\r\n              this.featureDrag.emit(evt);\r\n              this.drag.emit(evt);\r\n            });\r\n          }\r\n        })\r\n      );\r\n      this.sub.add(\r\n        dragEnd$.subscribe((evt) => {\r\n          moving = false;\r\n          if (\r\n            this.featureDragEnd.observers.length ||\r\n            this.dragEnd.observers.length\r\n          ) {\r\n            this.NgZone.run(() => {\r\n              this.featureDragEnd.emit(evt);\r\n              this.dragEnd.emit(evt);\r\n            });\r\n          }\r\n          if (!inside) {\r\n            // It's possible to dragEnd outside the target (small input lag)\r\n            this.MapService.changeCanvasCursor('');\r\n            this.MapService.updateDragPan(true);\r\n          }\r\n        })\r\n      );\r\n      this.sub.add(\r\n        leave$\r\n          .pipe(\r\n            tap(() => (inside = false)),\r\n            filter(() => !moving)\r\n          )\r\n          .subscribe(() => {\r\n            this.MapService.changeCanvasCursor('');\r\n            this.MapService.updateDragPan(true);\r\n          })\r\n      );\r\n    });\r\n  }\r\n\r\n  private filterFeature(evt: MapMouseEvent) {\r\n    if (this.FeatureComponent && this.layer) {\r\n      const feature: GeoJSON.Feature<any> = this.MapService.queryRenderedFeatures(\r\n        evt.point,\r\n        {\r\n          layers: [this.layer.id],\r\n          filter: [\r\n            'all',\r\n            ['==', '$type', 'Point'],\r\n            ['==', '$id', this.FeatureComponent.id],\r\n          ],\r\n        }\r\n      )[0];\r\n      if (!feature) {\r\n        return false;\r\n      }\r\n    }\r\n    return true;\r\n  }\r\n\r\n  private warnDeprecatedOutputs() {\r\n    const dw = deprecationWarning.bind(undefined, DraggableDirective.name);\r\n    if (this.dragStart.observers.length) {\r\n      dw('dragStart', 'featureDragStart');\r\n    }\r\n    if (this.dragEnd.observers.length) {\r\n      dw('dragEnd', 'featureDragEnd');\r\n    }\r\n    if (this.drag.observers.length) {\r\n      dw('drag', 'featureDrag');\r\n    }\r\n  }\r\n}\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  NgZone,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { fromEvent, Subscription } from 'rxjs';\r\nimport { filter, startWith, switchMap } from 'rxjs/operators';\r\nimport { MapService } from '../map/map.service';\r\nimport { MapImageData, MapImageOptions } from '../map/map.types';\r\nimport { deprecationWarning } from '../utils';\r\n\r\n@Component({\r\n  selector: 'mgl-image',\r\n  template: '',\r\n})\r\nexport class ImageComponent implements OnInit, OnDestroy, OnChanges {\r\n  /* Init inputs */\r\n  @Input() id: string;\r\n\r\n  /* Dynamic inputs */\r\n  @Input() data?: MapImageData;\r\n  @Input() options?: MapImageOptions;\r\n  @Input() url?: string;\r\n\r\n  @Output() imageError = new EventEmitter<{ status: number }>();\r\n  @Output() imageLoaded = new EventEmitter<void>();\r\n  /**\r\n   * @deprecated Use imageError instead\r\n   */\r\n  @Output() error = new EventEmitter<{ status: number }>();\r\n  /**\r\n   * @deprecated Use imageLoaded instead\r\n   */\r\n  @Output() loaded = new EventEmitter<void>();\r\n\r\n  private isAdded = false;\r\n  private isAdding = false;\r\n  private sub: Subscription;\r\n\r\n  constructor(private MapService: MapService, private zone: NgZone) {}\r\n\r\n  ngOnInit() {\r\n    this.warnDeprecatedOutputs();\r\n    this.sub = this.MapService.mapLoaded$\r\n      .pipe(\r\n        switchMap(() =>\r\n          fromEvent(<any>this.MapService.mapInstance, 'styledata').pipe(\r\n            startWith(undefined),\r\n            filter(\r\n              () =>\r\n                !this.isAdding && !this.MapService.mapInstance.hasImage(this.id)\r\n            )\r\n          )\r\n        )\r\n      )\r\n      .subscribe(() => this.init());\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (\r\n      (changes.data && !changes.data.isFirstChange()) ||\r\n      (changes.options && !changes.options.isFirstChange()) ||\r\n      (changes.url && !changes.url.isFirstChange())\r\n    ) {\r\n      this.ngOnDestroy();\r\n      this.ngOnInit();\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    if (this.isAdded) {\r\n      this.MapService.removeImage(this.id);\r\n    }\r\n    if (this.sub) {\r\n      this.sub.unsubscribe();\r\n    }\r\n  }\r\n\r\n  private async init() {\r\n    this.isAdding = true;\r\n    if (this.data) {\r\n      this.MapService.addImage(this.id, this.data, this.options);\r\n      this.isAdded = true;\r\n      this.isAdding = false;\r\n    } else if (this.url) {\r\n      try {\r\n        await this.MapService.loadAndAddImage(this.id, this.url, this.options);\r\n        this.isAdded = true;\r\n        this.isAdding = false;\r\n        this.zone.run(() => {\r\n          this.imageLoaded.emit();\r\n          this.loaded.emit();\r\n        });\r\n      } catch (error) {\r\n        this.zone.run(() => {\r\n          this.imageError.emit(error);\r\n          this.error.emit(error);\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  private warnDeprecatedOutputs() {\r\n    const dw = deprecationWarning.bind(undefined, ImageComponent.name);\r\n    if (this.error.observers.length) {\r\n      dw('error', 'imageError');\r\n    }\r\n    if (this.loaded.observers.length) {\r\n      dw('loaded', 'imageLoaded');\r\n    }\r\n  }\r\n}\r\n","import {\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport {\r\n  AnyLayer,\r\n  EventData,\r\n  Layer,\r\n  MapLayerMouseEvent,\r\n  MapLayerTouchEvent,\r\n} from 'mapbox-gl';\r\nimport { fromEvent, Subscription } from 'rxjs';\r\nimport { filter, mapTo, startWith, switchMap } from 'rxjs/operators';\r\nimport { MapService, SetupLayer } from '../map/map.service';\r\nimport { LayerEvents } from '../map/map.types';\r\nimport { deprecationWarning } from '../utils';\r\n\r\n@Component({\r\n  selector: 'mgl-layer',\r\n  template: '',\r\n})\r\nexport class LayerComponent\r\n  implements OnInit, OnDestroy, OnChanges, Layer, LayerEvents {\r\n  /* Init inputs */\r\n  @Input() id: AnyLayer['id'];\r\n  @Input() source?: Layer['source'];\r\n  @Input() type: AnyLayer['type'];\r\n  @Input() metadata?: Layer['metadata'];\r\n  @Input() sourceLayer?: Layer['source-layer'];\r\n\r\n  /* Dynamic inputs */\r\n  @Input() filter?: Layer['filter'];\r\n  @Input() layout?: Layer['layout'];\r\n  @Input() paint?: Layer['paint'];\r\n  @Input() before?: string;\r\n  @Input() minzoom?: Layer['minzoom'];\r\n  @Input() maxzoom?: Layer['maxzoom'];\r\n\r\n  @Output() layerClick = new EventEmitter<MapLayerMouseEvent & EventData>();\r\n  @Output() layerDblClick = new EventEmitter<MapLayerMouseEvent & EventData>();\r\n  @Output() layerMouseDown = new EventEmitter<MapLayerMouseEvent & EventData>();\r\n  @Output() layerMouseUp = new EventEmitter<MapLayerMouseEvent & EventData>();\r\n  @Output() layerMouseEnter = new EventEmitter<\r\n    MapLayerMouseEvent & EventData\r\n  >();\r\n  @Output() layerMouseLeave = new EventEmitter<\r\n    MapLayerMouseEvent & EventData\r\n  >();\r\n  @Output() layerMouseMove = new EventEmitter<MapLayerMouseEvent & EventData>();\r\n  @Output() layerMouseOver = new EventEmitter<MapLayerMouseEvent & EventData>();\r\n  @Output() layerMouseOut = new EventEmitter<MapLayerMouseEvent & EventData>();\r\n  @Output() layerContextMenu = new EventEmitter<\r\n    MapLayerMouseEvent & EventData\r\n  >();\r\n  @Output() layerTouchStart = new EventEmitter<\r\n    MapLayerTouchEvent & EventData\r\n  >();\r\n  @Output() layerTouchEnd = new EventEmitter<MapLayerTouchEvent & EventData>();\r\n  @Output() layerTouchCancel = new EventEmitter<\r\n    MapLayerTouchEvent & EventData\r\n  >();\r\n  /**\r\n   * @deprecated Use layerClick instead\r\n   */\r\n  @Output() click = new EventEmitter<MapLayerMouseEvent & EventData>();\r\n  /**\r\n   * @deprecated Use layerDblClick instead\r\n   */\r\n  @Output() dblClick = new EventEmitter<MapLayerMouseEvent & EventData>();\r\n  /**\r\n   * @deprecated Use layerMouseDown instead\r\n   */\r\n  @Output() mouseDown = new EventEmitter<MapLayerMouseEvent & EventData>();\r\n  /**\r\n   * @deprecated Use layerMouseUp instead\r\n   */\r\n  @Output() mouseUp = new EventEmitter<MapLayerMouseEvent & EventData>();\r\n  /**\r\n   * @deprecated Use layerMouseEnter instead\r\n   */\r\n  @Output() mouseEnter = new EventEmitter<MapLayerMouseEvent & EventData>();\r\n  /**\r\n   * @deprecated Use layerMouseLeave instead\r\n   */\r\n  @Output() mouseLeave = new EventEmitter<MapLayerMouseEvent & EventData>();\r\n  /**\r\n   * @deprecated Use layerMouseMove instead\r\n   */\r\n  @Output() mouseMove = new EventEmitter<MapLayerMouseEvent & EventData>();\r\n  /**\r\n   * @deprecated Use layerMouseOver instead\r\n   */\r\n  @Output() mouseOver = new EventEmitter<MapLayerMouseEvent & EventData>();\r\n  /**\r\n   * @deprecated Use layerMouseOut instead\r\n   */\r\n  @Output() mouseOut = new EventEmitter<MapLayerMouseEvent & EventData>();\r\n  /**\r\n   * @deprecated Use layerContextMenu instead\r\n   */\r\n  @Output() contextMenu = new EventEmitter<MapLayerMouseEvent & EventData>();\r\n  /**\r\n   * @deprecated Use layerTouchStart instead\r\n   */\r\n  @Output() touchStart = new EventEmitter<MapLayerTouchEvent & EventData>();\r\n  /**\r\n   * @deprecated Use layerTouchEnd instead\r\n   */\r\n  @Output() touchEnd = new EventEmitter<MapLayerTouchEvent & EventData>();\r\n  /**\r\n   * @deprecated Use layerTouchCancel instead\r\n   */\r\n  @Output() touchCancel = new EventEmitter<MapLayerTouchEvent & EventData>();\r\n\r\n  private layerAdded = false;\r\n  private sub: Subscription;\r\n\r\n  constructor(private MapService: MapService) {}\r\n\r\n  ngOnInit() {\r\n    this.warnDeprecatedOutputs();\r\n    this.sub = this.MapService.mapLoaded$\r\n      .pipe(\r\n        switchMap(() =>\r\n          fromEvent(<any>this.MapService.mapInstance, 'styledata').pipe(\r\n            mapTo(false),\r\n            filter(() => !this.MapService.mapInstance.getLayer(this.id)),\r\n            startWith(true)\r\n          )\r\n        )\r\n      )\r\n      .subscribe((bindEvents: boolean) => this.init(bindEvents));\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (!this.layerAdded) {\r\n      return;\r\n    }\r\n    if (changes.paint && !changes.paint.isFirstChange()) {\r\n      this.MapService.setAllLayerPaintProperty(\r\n        this.id,\r\n        changes.paint.currentValue!\r\n      );\r\n    }\r\n    if (changes.layout && !changes.layout.isFirstChange()) {\r\n      this.MapService.setAllLayerLayoutProperty(\r\n        this.id,\r\n        changes.layout.currentValue!\r\n      );\r\n    }\r\n    if (changes.filter && !changes.filter.isFirstChange()) {\r\n      this.MapService.setLayerFilter(this.id, changes.filter.currentValue!);\r\n    }\r\n    if (changes.before && !changes.before.isFirstChange()) {\r\n      this.MapService.setLayerBefore(this.id, changes.before.currentValue!);\r\n    }\r\n    if (\r\n      (changes.minzoom && !changes.minzoom.isFirstChange()) ||\r\n      (changes.maxzoom && !changes.maxzoom.isFirstChange())\r\n    ) {\r\n      this.MapService.setLayerZoomRange(this.id, this.minzoom, this.maxzoom);\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    if (this.layerAdded) {\r\n      this.MapService.removeLayer(this.id);\r\n    }\r\n    if (this.sub) {\r\n      this.sub.unsubscribe();\r\n    }\r\n  }\r\n\r\n  private init(bindEvents: boolean) {\r\n    const layer: SetupLayer = {\r\n      layerOptions: {\r\n        id: this.id,\r\n        type: <any>this.type,\r\n        source: this.source,\r\n        metadata: this.metadata,\r\n        'source-layer': this.sourceLayer,\r\n        minzoom: this.minzoom,\r\n        maxzoom: this.maxzoom,\r\n        filter: this.filter,\r\n        layout: this.layout,\r\n        paint: this.paint,\r\n      },\r\n      layerEvents: {\r\n        layerClick: this.layerClick,\r\n        layerDblClick: this.layerDblClick,\r\n        layerMouseDown: this.layerMouseDown,\r\n        layerMouseUp: this.layerMouseUp,\r\n        layerMouseEnter: this.layerMouseEnter,\r\n        layerMouseLeave: this.layerMouseLeave,\r\n        layerMouseMove: this.layerMouseMove,\r\n        layerMouseOver: this.layerMouseOver,\r\n        layerMouseOut: this.layerMouseOut,\r\n        layerContextMenu: this.layerContextMenu,\r\n        layerTouchStart: this.layerTouchStart,\r\n        layerTouchEnd: this.layerTouchEnd,\r\n        layerTouchCancel: this.layerTouchCancel,\r\n        click: this.click,\r\n        dblClick: this.dblClick,\r\n        mouseDown: this.mouseDown,\r\n        mouseUp: this.mouseUp,\r\n        mouseEnter: this.mouseEnter,\r\n        mouseLeave: this.mouseLeave,\r\n        mouseMove: this.mouseMove,\r\n        mouseOver: this.mouseOver,\r\n        mouseOut: this.mouseOut,\r\n        contextMenu: this.contextMenu,\r\n        touchStart: this.touchStart,\r\n        touchEnd: this.touchEnd,\r\n        touchCancel: this.touchCancel,\r\n      },\r\n    };\r\n    this.MapService.addLayer(layer, bindEvents, this.before);\r\n    this.layerAdded = true;\r\n  }\r\n\r\n  private warnDeprecatedOutputs() {\r\n    const dw = deprecationWarning.bind(undefined, LayerComponent.name);\r\n    if (this.click.observers.length) {\r\n      dw('click', 'layerClick');\r\n    }\r\n    if (this.dblClick.observers.length) {\r\n      dw('dblClick', 'layerDblClick');\r\n    }\r\n    if (this.mouseDown.observers.length) {\r\n      dw('mouseDown', 'layerMouseDown');\r\n    }\r\n    if (this.mouseUp.observers.length) {\r\n      dw('mouseUp', 'layerMouseUp');\r\n    }\r\n    if (this.mouseEnter.observers.length) {\r\n      dw('mouseEnter', 'layerMouseEnter');\r\n    }\r\n    if (this.mouseLeave.observers.length) {\r\n      dw('mouseLeave', 'layerMouseLeave');\r\n    }\r\n    if (this.mouseMove.observers.length) {\r\n      dw('mouseMove', 'layerMouseMove');\r\n    }\r\n    if (this.mouseOver.observers.length) {\r\n      dw('mouseOver', 'layerMouseOver');\r\n    }\r\n    if (this.mouseOut.observers.length) {\r\n      dw('mouseOut', 'layerMouseOut');\r\n    }\r\n    if (this.contextMenu.observers.length) {\r\n      dw('contextMenu', 'layerContextMenu');\r\n    }\r\n    if (this.touchStart.observers.length) {\r\n      dw('touchStart', 'layerTouchStart');\r\n    }\r\n    if (this.touchEnd.observers.length) {\r\n      dw('touchEnd', 'layerTouchEnd');\r\n    }\r\n    if (this.touchCancel.observers.length) {\r\n      dw('touchCancel', 'layerTouchCancel');\r\n    }\r\n  }\r\n}\r\n","import {\r\n  AfterViewInit,\r\n  ChangeDetectionStrategy,\r\n  Component,\r\n  ElementRef,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  Output,\r\n  SimpleChanges,\r\n  ViewChild,\r\n} from '@angular/core';\r\nimport {\r\n  AnimationOptions,\r\n  ErrorEvent,\r\n  EventData,\r\n  LngLatBoundsLike,\r\n  Map,\r\n  MapboxEvent,\r\n  MapboxOptions,\r\n  MapBoxZoomEvent,\r\n  MapContextEvent,\r\n  MapDataEvent,\r\n  MapMouseEvent,\r\n  MapSourceDataEvent,\r\n  MapStyleDataEvent,\r\n  MapTouchEvent,\r\n  MapWheelEvent,\r\n  PointLike,\r\n} from 'mapbox-gl';\r\nimport { deprecationWarning } from '../utils';\r\nimport { MapService, MovingOptions } from './map.service';\r\nimport { MapEvent } from './map.types';\r\n\r\n@Component({\r\n  selector: 'mgl-map',\r\n  template: '<div #container></div>',\r\n  styles: [\r\n    `\r\n      :host {\r\n        display: block;\r\n      }\r\n      div {\r\n        height: 100%;\r\n        width: 100%;\r\n      }\r\n    `,\r\n  ],\r\n  providers: [MapService],\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class MapComponent\r\n  implements\r\n    OnChanges,\r\n    OnDestroy,\r\n    AfterViewInit,\r\n    Omit<MapboxOptions, 'bearing' | 'container' | 'pitch' | 'zoom'>,\r\n    MapEvent {\r\n  /* Init inputs */\r\n  @Input() accessToken?: MapboxOptions['accessToken'];\r\n  @Input() collectResourceTiming?: MapboxOptions['collectResourceTiming'];\r\n  @Input() crossSourceCollisions?: MapboxOptions['crossSourceCollisions'];\r\n  @Input() customMapboxApiUrl?: string;\r\n  @Input() fadeDuration?: MapboxOptions['fadeDuration'];\r\n  @Input() hash?: MapboxOptions['hash'];\r\n  @Input() refreshExpiredTiles?: MapboxOptions['refreshExpiredTiles'];\r\n  @Input()\r\n  failIfMajorPerformanceCaveat?: MapboxOptions['failIfMajorPerformanceCaveat'];\r\n  @Input() bearingSnap?: MapboxOptions['bearingSnap'];\r\n  @Input() interactive?: MapboxOptions['interactive'];\r\n  @Input() pitchWithRotate?: MapboxOptions['pitchWithRotate'];\r\n  @Input() clickTolerance?: MapboxOptions['clickTolerance'];\r\n  @Input() attributionControl?: MapboxOptions['attributionControl'];\r\n  @Input() logoPosition?: MapboxOptions['logoPosition'];\r\n  @Input() maxTileCacheSize?: MapboxOptions['maxTileCacheSize'];\r\n  @Input() localIdeographFontFamily?: MapboxOptions['localIdeographFontFamily'];\r\n  @Input() preserveDrawingBuffer?: MapboxOptions['preserveDrawingBuffer'];\r\n  @Input() trackResize?: MapboxOptions['trackResize'];\r\n  @Input() transformRequest?: MapboxOptions['transformRequest'];\r\n  @Input() bounds?: MapboxOptions['bounds']; // Use fitBounds for dynamic input\r\n  @Input() antialias?: MapboxOptions['antialias'];\r\n  @Input() locale: MapboxOptions['locale'];\r\n\r\n  /* Dynamic inputs */\r\n  @Input() minZoom?: MapboxOptions['minZoom'];\r\n  @Input() maxZoom?: MapboxOptions['maxZoom'];\r\n  @Input() minPitch?: MapboxOptions['minPitch'];\r\n  @Input() maxPitch?: MapboxOptions['maxPitch'];\r\n  @Input() scrollZoom?: MapboxOptions['scrollZoom'];\r\n  @Input() dragRotate?: MapboxOptions['dragRotate'];\r\n  @Input() touchPitch?: MapboxOptions['touchPitch'];\r\n  @Input() touchZoomRotate?: MapboxOptions['touchZoomRotate'];\r\n  @Input() doubleClickZoom?: MapboxOptions['doubleClickZoom'];\r\n  @Input() keyboard?: MapboxOptions['keyboard'];\r\n  @Input() dragPan?: MapboxOptions['dragPan'];\r\n  @Input() boxZoom?: MapboxOptions['boxZoom'];\r\n  @Input() style: MapboxOptions['style'];\r\n  @Input() center?: MapboxOptions['center'];\r\n  @Input() maxBounds?: MapboxOptions['maxBounds'];\r\n  @Input() zoom?: [number];\r\n  @Input() bearing?: [number];\r\n  @Input() pitch?: [number];\r\n  @Input() fitBoundsOptions?: MapboxOptions['fitBoundsOptions']; // First value goes to options.fitBoundsOptions. Subsequents changes are passed to fitBounds\r\n  @Input() renderWorldCopies?: MapboxOptions['renderWorldCopies'];\r\n\r\n  /* Added by ngx-mapbox-gl */\r\n  @Input() movingMethod: 'jumpTo' | 'easeTo' | 'flyTo' = 'flyTo';\r\n  @Input() movingOptions?: MovingOptions;\r\n  // => First value is a alias to bounds input (since mapbox 0.53.0). Subsequents changes are passed to fitBounds\r\n  @Input() fitBounds?: LngLatBoundsLike;\r\n  @Input() fitScreenCoordinates?: [PointLike, PointLike];\r\n  @Input() centerWithPanTo?: boolean;\r\n  @Input() panToOptions?: AnimationOptions;\r\n  @Input() cursorStyle?: string;\r\n\r\n  @Output() mapResize = new EventEmitter<MapboxEvent & EventData>();\r\n  @Output() mapRemove = new EventEmitter<MapboxEvent & EventData>();\r\n  @Output() mapMouseDown = new EventEmitter<MapMouseEvent & EventData>();\r\n  @Output() mapMouseUp = new EventEmitter<MapMouseEvent & EventData>();\r\n  @Output() mapMouseMove = new EventEmitter<MapMouseEvent & EventData>();\r\n  @Output() mapClick = new EventEmitter<MapMouseEvent & EventData>();\r\n  @Output() mapDblClick = new EventEmitter<MapMouseEvent & EventData>();\r\n  @Output() mapMouseOver = new EventEmitter<MapMouseEvent & EventData>();\r\n  @Output() mapMouseOut = new EventEmitter<MapMouseEvent & EventData>();\r\n  @Output() mapContextMenu = new EventEmitter<MapMouseEvent & EventData>();\r\n  @Output() mapTouchStart = new EventEmitter<MapTouchEvent & EventData>();\r\n  @Output() mapTouchEnd = new EventEmitter<MapTouchEvent & EventData>();\r\n  @Output() mapTouchMove = new EventEmitter<MapTouchEvent & EventData>();\r\n  @Output() mapTouchCancel = new EventEmitter<MapTouchEvent & EventData>();\r\n  @Output() mapWheel = new EventEmitter<MapWheelEvent & EventData>();\r\n  @Output() moveStart = new EventEmitter<\r\n    MapboxEvent<MouseEvent | TouchEvent | WheelEvent | undefined> & EventData\r\n  >();\r\n  @Output() move = new EventEmitter<\r\n    MapboxEvent<MouseEvent | TouchEvent | WheelEvent | undefined> & EventData\r\n  >();\r\n  @Output() moveEnd = new EventEmitter<\r\n    MapboxEvent<MouseEvent | TouchEvent | WheelEvent | undefined> & EventData\r\n  >();\r\n  @Output() mapDragStart = new EventEmitter<\r\n    MapboxEvent<MouseEvent | TouchEvent | undefined> & EventData\r\n  >();\r\n  @Output() mapDrag = new EventEmitter<\r\n    MapboxEvent<MouseEvent | TouchEvent | undefined> & EventData\r\n  >();\r\n  @Output() mapDragEnd = new EventEmitter<\r\n    MapboxEvent<MouseEvent | TouchEvent | undefined> & EventData\r\n  >();\r\n  @Output() zoomStart = new EventEmitter<\r\n    MapboxEvent<MouseEvent | TouchEvent | WheelEvent | undefined> & EventData\r\n  >();\r\n  @Output() zoomEvt = new EventEmitter<\r\n    MapboxEvent<MouseEvent | TouchEvent | WheelEvent | undefined> & EventData\r\n  >();\r\n  @Output() zoomEnd = new EventEmitter<\r\n    MapboxEvent<MouseEvent | TouchEvent | WheelEvent | undefined> & EventData\r\n  >();\r\n  @Output() rotateStart = new EventEmitter<\r\n    MapboxEvent<MouseEvent | TouchEvent | undefined> & EventData\r\n  >();\r\n  @Output() rotate = new EventEmitter<\r\n    MapboxEvent<MouseEvent | TouchEvent | undefined> & EventData\r\n  >();\r\n  @Output() rotateEnd = new EventEmitter<\r\n    MapboxEvent<MouseEvent | TouchEvent | undefined> & EventData\r\n  >();\r\n  @Output() pitchStart = new EventEmitter<\r\n    MapboxEvent<MouseEvent | TouchEvent | undefined> & EventData\r\n  >();\r\n  @Output() pitchEvt = new EventEmitter<\r\n    MapboxEvent<MouseEvent | TouchEvent | undefined> & EventData\r\n  >();\r\n  @Output() pitchEnd = new EventEmitter<\r\n    MapboxEvent<MouseEvent | TouchEvent | undefined> & EventData\r\n  >();\r\n  @Output() boxZoomStart = new EventEmitter<MapBoxZoomEvent & EventData>();\r\n  @Output() boxZoomEnd = new EventEmitter<MapBoxZoomEvent & EventData>();\r\n  @Output() boxZoomCancel = new EventEmitter<MapBoxZoomEvent & EventData>();\r\n  @Output() webGlContextLost = new EventEmitter<MapContextEvent & EventData>();\r\n  @Output() webGlContextRestored = new EventEmitter<\r\n    MapContextEvent & EventData\r\n  >();\r\n  @Output() mapLoad = new EventEmitter<Map>();\r\n  @Output() idle = new EventEmitter<MapboxEvent & EventData>();\r\n  @Output() render = new EventEmitter<MapboxEvent & EventData>();\r\n  @Output() mapError = new EventEmitter<ErrorEvent & EventData>();\r\n  @Output() data = new EventEmitter<MapDataEvent & EventData>();\r\n  @Output() styleData = new EventEmitter<MapStyleDataEvent & EventData>();\r\n  @Output() sourceData = new EventEmitter<MapSourceDataEvent & EventData>();\r\n  @Output() dataLoading = new EventEmitter<MapDataEvent & EventData>();\r\n  @Output() styleDataLoading = new EventEmitter<\r\n    MapStyleDataEvent & EventData\r\n  >();\r\n  @Output() sourceDataLoading = new EventEmitter<\r\n    MapSourceDataEvent & EventData\r\n  >();\r\n  @Output() styleImageMissing = new EventEmitter<{ id: string } & EventData>();\r\n\r\n  /**\r\n   * @deprecated Use mapResize instead\r\n   */\r\n  @Output() resize = new EventEmitter<MapboxEvent & EventData>();\r\n  /**\r\n   * @deprecated Use mapRemove instead\r\n   */\r\n  @Output() remove = new EventEmitter<MapboxEvent & EventData>();\r\n  /**\r\n   * @deprecated Use mapMouseDown instead\r\n   */\r\n  @Output() mouseDown = new EventEmitter<MapMouseEvent & EventData>();\r\n  /**\r\n   * @deprecated Use mapMouseUp instead\r\n   */\r\n  @Output() mouseUp = new EventEmitter<MapMouseEvent & EventData>();\r\n  /**\r\n   * @deprecated Use mapMouseMove instead\r\n   */\r\n  @Output() mouseMove = new EventEmitter<MapMouseEvent & EventData>();\r\n  /**\r\n   * @deprecated Use mapClick instead\r\n   */\r\n  @Output() click = new EventEmitter<MapMouseEvent & EventData>();\r\n  /**\r\n   * @deprecated Use mapDblClick instead\r\n   */\r\n  @Output() dblClick = new EventEmitter<MapMouseEvent & EventData>();\r\n  /**\r\n   * @deprecated Use mapMouseOver instead\r\n   */\r\n  @Output() mouseOver = new EventEmitter<MapMouseEvent & EventData>();\r\n  /**\r\n   * @deprecated Use mapMouseOut instead\r\n   */\r\n  @Output() mouseOut = new EventEmitter<MapMouseEvent & EventData>();\r\n  /**\r\n   * @deprecated Use mapContextMenu instead\r\n   */\r\n  @Output() contextMenu = new EventEmitter<MapMouseEvent & EventData>();\r\n  /**\r\n   * @deprecated Use mapTouchStart instead\r\n   */\r\n  @Output() touchStart = new EventEmitter<MapTouchEvent & EventData>();\r\n  /**\r\n   * @deprecated Use mapTouchEnd instead\r\n   */\r\n  @Output() touchEnd = new EventEmitter<MapTouchEvent & EventData>();\r\n  /**\r\n   * @deprecated Use mapTouchMove instead\r\n   */\r\n  @Output() touchMove = new EventEmitter<MapTouchEvent & EventData>();\r\n  /**\r\n   * @deprecated Use mapTouchCancel instead\r\n   */\r\n  @Output() touchCancel = new EventEmitter<MapTouchEvent & EventData>();\r\n  /**\r\n   * @deprecated Use mapWheel instead\r\n   */\r\n  @Output() wheel = new EventEmitter<MapWheelEvent & EventData>();\r\n  /**\r\n   * @deprecated Use mapDragStart instead\r\n   */\r\n  @Output() dragStart = new EventEmitter<\r\n    MapboxEvent<MouseEvent | TouchEvent | undefined> & EventData\r\n  >();\r\n  /**\r\n   * @deprecated Use mapDrag instead\r\n   */\r\n  @Output() drag = new EventEmitter<\r\n    MapboxEvent<MouseEvent | TouchEvent | undefined> & EventData\r\n  >();\r\n  /**\r\n   * @deprecated Use mapDragEnd instead\r\n   */\r\n  @Output() dragEnd = new EventEmitter<\r\n    MapboxEvent<MouseEvent | TouchEvent | undefined> & EventData\r\n  >();\r\n  /**\r\n   * @deprecated Use mapLoad instead\r\n   */\r\n  @Output() load = new EventEmitter<Map>();\r\n  /**\r\n   * @deprecated Use mapError instead\r\n   */\r\n  @Output() error = new EventEmitter<ErrorEvent & EventData>();\r\n\r\n  get mapInstance(): Map {\r\n    return this.MapService.mapInstance;\r\n  }\r\n\r\n  @ViewChild('container', { static: true }) mapContainer: ElementRef;\r\n\r\n  constructor(private MapService: MapService) {}\r\n\r\n  ngAfterViewInit() {\r\n    this.warnDeprecatedOutputs();\r\n    this.MapService.setup({\r\n      accessToken: this.accessToken,\r\n      customMapboxApiUrl: this.customMapboxApiUrl,\r\n      mapOptions: {\r\n        collectResourceTiming: this.collectResourceTiming,\r\n        container: this.mapContainer.nativeElement,\r\n        crossSourceCollisions: this.crossSourceCollisions,\r\n        fadeDuration: this.fadeDuration,\r\n        minZoom: this.minZoom,\r\n        maxZoom: this.maxZoom,\r\n        minPitch: this.minPitch,\r\n        maxPitch: this.maxPitch,\r\n        style: this.style,\r\n        hash: this.hash,\r\n        interactive: this.interactive,\r\n        bearingSnap: this.bearingSnap,\r\n        pitchWithRotate: this.pitchWithRotate,\r\n        clickTolerance: this.clickTolerance,\r\n        attributionControl: this.attributionControl,\r\n        logoPosition: this.logoPosition,\r\n        failIfMajorPerformanceCaveat: this.failIfMajorPerformanceCaveat,\r\n        preserveDrawingBuffer: this.preserveDrawingBuffer,\r\n        refreshExpiredTiles: this.refreshExpiredTiles,\r\n        maxBounds: this.maxBounds,\r\n        scrollZoom: this.scrollZoom,\r\n        boxZoom: this.boxZoom,\r\n        dragRotate: this.dragRotate,\r\n        dragPan: this.dragPan,\r\n        keyboard: this.keyboard,\r\n        doubleClickZoom: this.doubleClickZoom,\r\n        touchPitch: this.touchPitch,\r\n        touchZoomRotate: this.touchZoomRotate,\r\n        trackResize: this.trackResize,\r\n        center: this.center,\r\n        zoom: this.zoom,\r\n        bearing: this.bearing,\r\n        pitch: this.pitch,\r\n        renderWorldCopies: this.renderWorldCopies,\r\n        maxTileCacheSize: this.maxTileCacheSize,\r\n        localIdeographFontFamily: this.localIdeographFontFamily,\r\n        transformRequest: this.transformRequest,\r\n        bounds: this.bounds ? this.bounds : this.fitBounds,\r\n        fitBoundsOptions: this.fitBoundsOptions,\r\n        antialias: this.antialias,\r\n        locale: this.locale,\r\n      },\r\n      mapEvents: this,\r\n    });\r\n    if (this.cursorStyle) {\r\n      this.MapService.changeCanvasCursor(this.cursorStyle);\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.MapService.destroyMap();\r\n  }\r\n\r\n  async ngOnChanges(changes: SimpleChanges) {\r\n    await this.MapService.mapCreated$.toPromise();\r\n    if (changes.cursorStyle && !changes.cursorStyle.isFirstChange()) {\r\n      this.MapService.changeCanvasCursor(changes.cursorStyle.currentValue);\r\n    }\r\n    if (changes.minZoom && !changes.minZoom.isFirstChange()) {\r\n      this.MapService.updateMinZoom(changes.minZoom.currentValue);\r\n    }\r\n    if (changes.maxZoom && !changes.maxZoom.isFirstChange()) {\r\n      this.MapService.updateMaxZoom(changes.maxZoom.currentValue);\r\n    }\r\n    if (changes.minPitch && !changes.minPitch.isFirstChange()) {\r\n      this.MapService.updateMinPitch(changes.minPitch.currentValue);\r\n    }\r\n    if (changes.maxPitch && !changes.maxPitch.isFirstChange()) {\r\n      this.MapService.updateMaxPitch(changes.maxPitch.currentValue);\r\n    }\r\n    if (\r\n      changes.renderWorldCopies &&\r\n      !changes.renderWorldCopies.isFirstChange()\r\n    ) {\r\n      this.MapService.updateRenderWorldCopies(\r\n        changes.renderWorldCopies.currentValue\r\n      );\r\n    }\r\n    if (changes.scrollZoom && !changes.scrollZoom.isFirstChange()) {\r\n      this.MapService.updateScrollZoom(changes.scrollZoom.currentValue);\r\n    }\r\n    if (changes.dragRotate && !changes.dragRotate.isFirstChange()) {\r\n      this.MapService.updateDragRotate(changes.dragRotate.currentValue);\r\n    }\r\n    if (changes.touchPitch && !changes.touchPitch.isFirstChange()) {\r\n      this.MapService.updateTouchPitch(changes.touchPitch.currentValue);\r\n    }\r\n    if (changes.touchZoomRotate && !changes.touchZoomRotate.isFirstChange()) {\r\n      this.MapService.updateTouchZoomRotate(\r\n        changes.touchZoomRotate.currentValue\r\n      );\r\n    }\r\n    if (changes.doubleClickZoom && !changes.doubleClickZoom.isFirstChange()) {\r\n      this.MapService.updateDoubleClickZoom(\r\n        changes.doubleClickZoom.currentValue\r\n      );\r\n    }\r\n    if (changes.keyboard && !changes.keyboard.isFirstChange()) {\r\n      this.MapService.updateKeyboard(changes.keyboard.currentValue);\r\n    }\r\n    if (changes.dragPan && !changes.dragPan.isFirstChange()) {\r\n      this.MapService.updateDragPan(changes.dragPan.currentValue);\r\n    }\r\n    if (changes.boxZoom && !changes.boxZoom.isFirstChange()) {\r\n      this.MapService.updateBoxZoom(changes.boxZoom.currentValue);\r\n    }\r\n    if (changes.style && !changes.style.isFirstChange()) {\r\n      this.MapService.updateStyle(changes.style.currentValue);\r\n    }\r\n    if (changes.maxBounds && !changes.maxBounds.isFirstChange()) {\r\n      this.MapService.updateMaxBounds(changes.maxBounds.currentValue);\r\n    }\r\n    if (\r\n      changes.fitBounds &&\r\n      changes.fitBounds.currentValue &&\r\n      !changes.fitBounds.isFirstChange()\r\n    ) {\r\n      this.MapService.fitBounds(\r\n        changes.fitBounds.currentValue,\r\n        this.fitBoundsOptions\r\n      );\r\n    }\r\n    if (\r\n      changes.fitScreenCoordinates &&\r\n      changes.fitScreenCoordinates.currentValue\r\n    ) {\r\n      if (\r\n        (this.center || this.zoom || this.pitch || this.fitBounds) &&\r\n        changes.fitScreenCoordinates.isFirstChange()\r\n      ) {\r\n        console.warn(\r\n          '[ngx-mapbox-gl] center / zoom / pitch / fitBounds inputs are being overridden by fitScreenCoordinates input'\r\n        );\r\n      }\r\n      this.MapService.fitScreenCoordinates(\r\n        changes.fitScreenCoordinates.currentValue,\r\n        this.bearing ? this.bearing[0] : 0,\r\n        this.movingOptions\r\n      );\r\n    }\r\n    if (\r\n      this.centerWithPanTo &&\r\n      changes.center &&\r\n      !changes.center.isFirstChange() &&\r\n      !changes.zoom &&\r\n      !changes.bearing &&\r\n      !changes.pitch\r\n    ) {\r\n      this.MapService.panTo(this.center!, this.panToOptions);\r\n    } else if (\r\n      (changes.center && !changes.center.isFirstChange()) ||\r\n      (changes.zoom && !changes.zoom.isFirstChange()) ||\r\n      (changes.bearing &&\r\n        !changes.bearing.isFirstChange() &&\r\n        !changes.fitScreenCoordinates) ||\r\n      (changes.pitch && !changes.pitch.isFirstChange())\r\n    ) {\r\n      this.MapService.move(\r\n        this.movingMethod,\r\n        this.movingOptions,\r\n        changes.zoom && this.zoom ? this.zoom[0] : undefined,\r\n        changes.center ? this.center : undefined,\r\n        changes.bearing && this.bearing ? this.bearing[0] : undefined,\r\n        changes.pitch && this.pitch ? this.pitch[0] : undefined\r\n      );\r\n    }\r\n  }\r\n\r\n  private warnDeprecatedOutputs() {\r\n    const dw = deprecationWarning.bind(undefined, MapComponent.name);\r\n    if (this.resize.observers.length) {\r\n      dw('resize', 'mapResize');\r\n    }\r\n    if (this.remove.observers.length) {\r\n      dw('remove', 'mapRemove');\r\n    }\r\n    if (this.mouseDown.observers.length) {\r\n      dw('mouseDown', 'mapMouseDown');\r\n    }\r\n    if (this.mouseUp.observers.length) {\r\n      dw('mouseUp', 'mapMouseUp');\r\n    }\r\n    if (this.mouseMove.observers.length) {\r\n      dw('mouseMove', 'mapMouseMove');\r\n    }\r\n    if (this.click.observers.length) {\r\n      dw('click', 'mapClick');\r\n    }\r\n    if (this.dblClick.observers.length) {\r\n      dw('dblClick', 'mapDblClick');\r\n    }\r\n    if (this.mouseOver.observers.length) {\r\n      dw('mouseOver', 'mapMouseOver');\r\n    }\r\n    if (this.mouseOut.observers.length) {\r\n      dw('mouseOut', 'mapMouseOut');\r\n    }\r\n    if (this.contextMenu.observers.length) {\r\n      dw('contextMenu', 'mapContextMenu');\r\n    }\r\n    if (this.touchStart.observers.length) {\r\n      dw('touchStart', 'mapTouchStart');\r\n    }\r\n    if (this.touchEnd.observers.length) {\r\n      dw('touchEnd', 'mapTouchEnd');\r\n    }\r\n    if (this.touchMove.observers.length) {\r\n      dw('touchMove', 'mapTouchMove');\r\n    }\r\n    if (this.touchCancel.observers.length) {\r\n      dw('touchCancel', 'mapTouchCancel');\r\n    }\r\n    if (this.wheel.observers.length) {\r\n      dw('wheel', 'mapWheel');\r\n    }\r\n    if (this.dragStart.observers.length) {\r\n      dw('dragStart', 'mapDragStart');\r\n    }\r\n    if (this.drag.observers.length) {\r\n      dw('drag', 'mapDrag');\r\n    }\r\n    if (this.dragEnd.observers.length) {\r\n      dw('dragEnd', 'mapDragEnd');\r\n    }\r\n    if (this.load.observers.length) {\r\n      dw('load', 'mapLoad');\r\n    }\r\n    if (this.error.observers.length) {\r\n      dw('error', 'mapError');\r\n    }\r\n  }\r\n}\r\n","import {\r\n  AfterViewInit,\r\n  ChangeDetectionStrategy,\r\n  Component,\r\n  ElementRef,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n  ViewChild,\r\n  ViewEncapsulation,\r\n} from '@angular/core';\r\nimport { LngLatLike, Marker, MarkerOptions } from 'mapbox-gl';\r\nimport { MapService } from '../map/map.service';\r\nimport { deprecationWarning } from '../utils';\r\n\r\n@Component({\r\n  selector: 'mgl-marker',\r\n  template: '<div [class]=\"className\" #content><ng-content></ng-content></div>',\r\n  encapsulation: ViewEncapsulation.None,\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class MarkerComponent\r\n  implements OnChanges, OnDestroy, AfterViewInit, OnInit {\r\n  /* Init input */\r\n  @Input() offset?: MarkerOptions['offset'];\r\n  @Input() anchor?: MarkerOptions['anchor'];\r\n  @Input() clickTolerance?: MarkerOptions['clickTolerance'];\r\n\r\n  /* Dynamic input */\r\n  @Input() feature?: GeoJSON.Feature<GeoJSON.Point>;\r\n  @Input() lngLat?: LngLatLike;\r\n  @Input() draggable?: MarkerOptions['draggable'];\r\n  @Input() popupShown?: boolean;\r\n  @Input() className: string;\r\n  @Input() pitchAlignment?: MarkerOptions['pitchAlignment'];\r\n  @Input() rotationAlignment?: MarkerOptions['rotationAlignment'];\r\n\r\n  @Output() markerDragStart = new EventEmitter<Marker>();\r\n  @Output() markerDragEnd = new EventEmitter<Marker>();\r\n  @Output() markerDrag = new EventEmitter<Marker>();\r\n  /**\r\n   * @deprecated Use markerDragStart instead\r\n   */\r\n  @Output() dragStart = new EventEmitter<Marker>();\r\n  /**\r\n   * @deprecated Use markerDragEnd instead\r\n   */\r\n  @Output() dragEnd = new EventEmitter<Marker>();\r\n  /**\r\n   * @deprecated Use markerDrag instead\r\n   */\r\n  @Output() drag = new EventEmitter<Marker>();\r\n\r\n  @ViewChild('content', { static: true }) content: ElementRef;\r\n\r\n  markerInstance?: Marker;\r\n\r\n  constructor(private MapService: MapService) {}\r\n\r\n  ngOnInit() {\r\n    this.warnDeprecatedOutputs();\r\n    if (this.feature && this.lngLat) {\r\n      throw new Error('feature and lngLat input are mutually exclusive');\r\n    }\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (changes.lngLat && !changes.lngLat.isFirstChange()) {\r\n      this.markerInstance!.setLngLat(this.lngLat!);\r\n    }\r\n    if (changes.feature && !changes.feature.isFirstChange()) {\r\n      this.markerInstance!.setLngLat(\r\n        <[number, number]>this.feature!.geometry!.coordinates\r\n      );\r\n    }\r\n    if (changes.draggable && !changes.draggable.isFirstChange()) {\r\n      this.markerInstance!.setDraggable(!!this.draggable);\r\n    }\r\n    if (changes.popupShown && !changes.popupShown.isFirstChange()) {\r\n      changes.popupShown.currentValue\r\n        ? this.markerInstance!.getPopup().addTo(this.MapService.mapInstance)\r\n        : this.markerInstance!.getPopup().remove();\r\n    }\r\n    if (changes.pitchAlignment && !changes.pitchAlignment.isFirstChange()) {\r\n      this.markerInstance!.setPitchAlignment(\r\n        changes.pitchAlignment.currentValue\r\n      );\r\n    }\r\n    if (\r\n      changes.rotationAlignment &&\r\n      !changes.rotationAlignment.isFirstChange()\r\n    ) {\r\n      this.markerInstance!.setRotationAlignment(\r\n        changes.rotationAlignment.currentValue\r\n      );\r\n    }\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    this.MapService.mapCreated$.subscribe(() => {\r\n      this.markerInstance = this.MapService.addMarker({\r\n        markersOptions: {\r\n          offset: this.offset,\r\n          anchor: this.anchor,\r\n          pitchAlignment: this.pitchAlignment,\r\n          rotationAlignment: this.rotationAlignment,\r\n          draggable: !!this.draggable,\r\n          element: this.content.nativeElement,\r\n          feature: this.feature,\r\n          lngLat: this.lngLat,\r\n          clickTolerance: this.clickTolerance,\r\n        },\r\n        markersEvents: {\r\n          markerDragStart: this.markerDragStart,\r\n          markerDrag: this.markerDrag,\r\n          markerDragEnd: this.markerDragEnd,\r\n          dragStart: this.dragStart,\r\n          drag: this.drag,\r\n          dragEnd: this.dragEnd,\r\n        },\r\n      });\r\n    });\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.MapService.removeMarker(this.markerInstance!);\r\n    this.markerInstance = undefined;\r\n  }\r\n\r\n  togglePopup() {\r\n    this.markerInstance!.togglePopup();\r\n  }\r\n\r\n  updateCoordinates(coordinates: number[]) {\r\n    this.markerInstance!.setLngLat(<[number, number]>coordinates);\r\n  }\r\n\r\n  private warnDeprecatedOutputs() {\r\n    const dw = deprecationWarning.bind(undefined, MarkerComponent.name);\r\n    if (this.dragStart.observers.length) {\r\n      dw('dragStart', 'markerDragStart');\r\n    }\r\n    if (this.dragEnd.observers.length) {\r\n      dw('dragEnd', 'markerDragEnd');\r\n    }\r\n    if (this.drag.observers.length) {\r\n      dw('drag', 'markerDrag');\r\n    }\r\n  }\r\n}\r\n","import {\r\n  AfterContentInit,\r\n  ChangeDetectionStrategy,\r\n  ChangeDetectorRef,\r\n  Component,\r\n  ContentChild,\r\n  Directive,\r\n  Input,\r\n  NgZone,\r\n  OnDestroy,\r\n  TemplateRef,\r\n} from '@angular/core';\r\nimport { MapboxGeoJSONFeature, MapSourceDataEvent } from 'mapbox-gl';\r\nimport { fromEvent, merge, Subscription } from 'rxjs';\r\nimport { filter, startWith, switchMap } from 'rxjs/operators';\r\nimport { MapService } from '../map/map.service';\r\n\r\n@Directive({ selector: 'ng-template[mglPoint]' })\r\nexport class PointDirective {}\r\n\r\n@Directive({ selector: 'ng-template[mglClusterPoint]' })\r\nexport class ClusterPointDirective {}\r\n\r\nlet uniqId = 0;\r\n\r\n@Component({\r\n  selector: 'mgl-markers-for-clusters',\r\n  template: `\r\n    <mgl-layer\r\n      [id]=\"layerId\"\r\n      [source]=\"source\"\r\n      type=\"circle\"\r\n      [paint]=\"{ 'circle-radius': 0 }\"\r\n    ></mgl-layer>\r\n    <ng-container\r\n      *ngFor=\"let feature of clusterPoints; trackBy: trackByClusterPoint\"\r\n    >\r\n      <ng-container *ngIf=\"feature.properties.cluster\">\r\n        <mgl-marker [feature]=\"feature\">\r\n          <ng-container\r\n            *ngTemplateOutlet=\"clusterPointTpl; context: { $implicit: feature }\"\r\n          ></ng-container>\r\n        </mgl-marker>\r\n      </ng-container>\r\n      <ng-container *ngIf=\"!feature.properties.cluster\">\r\n        <mgl-marker [feature]=\"feature\">\r\n          <ng-container\r\n            *ngTemplateOutlet=\"pointTpl; context: { $implicit: feature }\"\r\n          ></ng-container>\r\n        </mgl-marker>\r\n      </ng-container>\r\n    </ng-container>\r\n  `,\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n  preserveWhitespaces: false,\r\n})\r\nexport class MarkersForClustersComponent\r\n  implements OnDestroy, AfterContentInit {\r\n  /* Init input */\r\n  @Input() source: string;\r\n\r\n  @ContentChild(PointDirective, { read: TemplateRef, static: false })\r\n  pointTpl?: TemplateRef<any>;\r\n  @ContentChild(ClusterPointDirective, { read: TemplateRef, static: false })\r\n  clusterPointTpl: TemplateRef<any>;\r\n\r\n  clusterPoints: MapboxGeoJSONFeature[]; // Incorrect typings\r\n  layerId = `mgl-markers-for-clusters-${uniqId++}`;\r\n\r\n  private sub = new Subscription();\r\n\r\n  constructor(\r\n    private MapService: MapService,\r\n    private ChangeDetectorRef: ChangeDetectorRef,\r\n    private zone: NgZone\r\n  ) {}\r\n\r\n  ngAfterContentInit() {\r\n    const clusterDataUpdate = () =>\r\n      fromEvent<MapSourceDataEvent>(\r\n        <any>this.MapService.mapInstance,\r\n        'data'\r\n      ).pipe(\r\n        filter(\r\n          (e) =>\r\n            e.sourceId === this.source &&\r\n            e.sourceDataType !== 'metadata' &&\r\n            this.MapService.mapInstance.isSourceLoaded(this.source)\r\n        )\r\n      );\r\n    const sub = this.MapService.mapCreated$\r\n      .pipe(\r\n        switchMap(clusterDataUpdate),\r\n        switchMap(() =>\r\n          merge(\r\n            fromEvent(<any>this.MapService.mapInstance, 'move'),\r\n            fromEvent(<any>this.MapService.mapInstance, 'moveend')\r\n          ).pipe(startWith<any>(undefined))\r\n        )\r\n      )\r\n      .subscribe(() => {\r\n        this.zone.run(() => {\r\n          this.updateCluster();\r\n        });\r\n      });\r\n    this.sub.add(sub);\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.sub.unsubscribe();\r\n  }\r\n\r\n  trackByClusterPoint(_index: number, clusterPoint: { id: number }) {\r\n    return clusterPoint.id;\r\n  }\r\n\r\n  private updateCluster() {\r\n    // Invalid queryRenderedFeatures typing\r\n    const params: any = { layers: [this.layerId] };\r\n    if (!this.pointTpl) {\r\n      params.filter = ['==', 'cluster', true];\r\n    }\r\n    this.clusterPoints = this.MapService.mapInstance.queryRenderedFeatures(\r\n      params\r\n    );\r\n    this.ChangeDetectorRef.markForCheck();\r\n  }\r\n}\r\n","import {\r\n  AfterViewInit,\r\n  ChangeDetectionStrategy,\r\n  Component,\r\n  ElementRef,\r\n  EventEmitter,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  Output,\r\n  SimpleChanges,\r\n  ViewChild,\r\n} from '@angular/core';\r\nimport { LngLatLike, PointLike, Popup, PopupOptions } from 'mapbox-gl';\r\nimport { MapService } from '../map/map.service';\r\nimport { MarkerComponent } from '../marker/marker.component';\r\nimport { deprecationWarning } from '../utils';\r\n\r\n@Component({\r\n  selector: 'mgl-popup',\r\n  template: '<div #content><ng-content></ng-content></div>',\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class PopupComponent\r\n  implements OnChanges, OnDestroy, AfterViewInit, OnInit {\r\n  /* Init input */\r\n  @Input() closeButton?: PopupOptions['closeButton'];\r\n  @Input() closeOnClick?: PopupOptions['closeOnClick'];\r\n  @Input() anchor?: PopupOptions['anchor'];\r\n  @Input() className?: PopupOptions['className'];\r\n  @Input() maxWidth?: PopupOptions['maxWidth'];\r\n\r\n  /* Dynamic input */\r\n  @Input() feature?: GeoJSON.Feature<GeoJSON.Point>;\r\n  @Input() lngLat?: LngLatLike;\r\n  @Input() marker?: MarkerComponent;\r\n  @Input() offset?: number | PointLike | { [anchor: string]: [number, number] };\r\n\r\n  @Output() popupClose = new EventEmitter<void>();\r\n  @Output() popupOpen = new EventEmitter<void>();\r\n  /**\r\n   * @deprecated Use popupClose instead\r\n   */\r\n  @Output() close = new EventEmitter<void>();\r\n  /**\r\n   * @deprecated Use popupOpen instead\r\n   */\r\n  @Output() open = new EventEmitter<void>();\r\n\r\n  @ViewChild('content', { static: true }) content: ElementRef;\r\n\r\n  popupInstance?: Popup;\r\n\r\n  constructor(private MapService: MapService) {}\r\n\r\n  ngOnInit() {\r\n    this.warnDeprecatedOutputs();\r\n    if (\r\n      (this.lngLat && this.marker) ||\r\n      (this.feature && this.lngLat) ||\r\n      (this.feature && this.marker)\r\n    ) {\r\n      throw new Error('marker, lngLat, feature input are mutually exclusive');\r\n    }\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (\r\n      (changes.lngLat && !changes.lngLat.isFirstChange()) ||\r\n      (changes.feature && !changes.feature.isFirstChange())\r\n    ) {\r\n      const newlngLat = changes.lngLat\r\n        ? this.lngLat!\r\n        : <[number, number]>this.feature!.geometry!.coordinates!;\r\n      this.MapService.removePopupFromMap(this.popupInstance!, true);\r\n      const popupInstanceTmp = this.createPopup();\r\n      this.MapService.addPopupToMap(\r\n        popupInstanceTmp,\r\n        newlngLat,\r\n        this.popupInstance!.isOpen()\r\n      );\r\n      this.popupInstance = popupInstanceTmp;\r\n    }\r\n    if (changes.marker && !changes.marker.isFirstChange()) {\r\n      const previousMarker: MarkerComponent = changes.marker.previousValue;\r\n      if (previousMarker.markerInstance) {\r\n        this.MapService.removePopupFromMarker(previousMarker.markerInstance);\r\n      }\r\n      if (this.marker && this.marker.markerInstance && this.popupInstance) {\r\n        this.MapService.addPopupToMarker(\r\n          this.marker.markerInstance,\r\n          this.popupInstance\r\n        );\r\n      }\r\n    }\r\n    if (\r\n      changes.offset &&\r\n      !changes.offset.isFirstChange() &&\r\n      this.popupInstance\r\n    ) {\r\n      this.popupInstance.setOffset(this.offset);\r\n    }\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    this.popupInstance = this.createPopup();\r\n    this.addPopup(this.popupInstance);\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    if (this.popupInstance) {\r\n      if (this.lngLat || this.feature) {\r\n        this.MapService.removePopupFromMap(this.popupInstance);\r\n      } else if (this.marker && this.marker.markerInstance) {\r\n        this.MapService.removePopupFromMarker(this.marker.markerInstance);\r\n      }\r\n    }\r\n    this.popupInstance = undefined;\r\n  }\r\n\r\n  private createPopup() {\r\n    return this.MapService.createPopup(\r\n      {\r\n        popupOptions: {\r\n          closeButton: this.closeButton,\r\n          closeOnClick: this.closeOnClick,\r\n          anchor: this.anchor,\r\n          offset: this.offset,\r\n          className: this.className,\r\n          maxWidth: this.maxWidth,\r\n        },\r\n        popupEvents: {\r\n          open: this.open,\r\n          close: this.close,\r\n          popupOpen: this.popupOpen,\r\n          popupClose: this.popupClose,\r\n        },\r\n      },\r\n      this.content.nativeElement\r\n    );\r\n  }\r\n\r\n  private addPopup(popup: Popup) {\r\n    this.MapService.mapCreated$.subscribe(() => {\r\n      if (this.lngLat || this.feature) {\r\n        this.MapService.addPopupToMap(\r\n          popup,\r\n          this.lngLat\r\n            ? this.lngLat\r\n            : <[number, number]>this.feature!.geometry!.coordinates!\r\n        );\r\n      } else if (this.marker && this.marker.markerInstance) {\r\n        this.MapService.addPopupToMarker(this.marker.markerInstance, popup);\r\n      } else {\r\n        throw new Error(\r\n          'mgl-popup need either lngLat/marker/feature to be set'\r\n        );\r\n      }\r\n    });\r\n  }\r\n\r\n  private warnDeprecatedOutputs() {\r\n    const dw = deprecationWarning.bind(undefined, PopupComponent.name);\r\n    if (this.close.observers.length) {\r\n      dw('close', 'popupClose');\r\n    }\r\n    if (this.open.observers.length) {\r\n      dw('open', 'popupOpen');\r\n    }\r\n  }\r\n}\r\n","import {\r\n  ChangeDetectionStrategy,\r\n  Component,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { CanvasSource, CanvasSourceOptions, CanvasSourceRaw } from 'mapbox-gl';\r\nimport { fromEvent, Subscription } from 'rxjs';\r\nimport { filter } from 'rxjs/operators';\r\nimport { MapService } from '../map/map.service';\r\n\r\n@Component({\r\n  selector: 'mgl-canvas-source',\r\n  template: '',\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class CanvasSourceComponent\r\n  implements OnInit, OnDestroy, OnChanges, CanvasSourceOptions {\r\n  /* Init inputs */\r\n  @Input() id: string;\r\n\r\n  /* Dynamic inputs */\r\n  @Input() coordinates: CanvasSourceOptions['coordinates'];\r\n  @Input() canvas: CanvasSourceOptions['canvas'];\r\n  @Input() animate?: CanvasSourceOptions['animate'];\r\n\r\n  private sourceAdded = false;\r\n  private sub = new Subscription();\r\n\r\n  constructor(private MapService: MapService) {}\r\n\r\n  ngOnInit() {\r\n    const sub1 = this.MapService.mapLoaded$.subscribe(() => {\r\n      this.init();\r\n      const sub = fromEvent(<any>this.MapService.mapInstance, 'styledata')\r\n        .pipe(filter(() => !this.MapService.mapInstance.getSource(this.id)))\r\n        .subscribe(() => {\r\n          this.init();\r\n        });\r\n      this.sub.add(sub);\r\n    });\r\n    this.sub.add(sub1);\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (!this.sourceAdded) {\r\n      return;\r\n    }\r\n    if (\r\n      (changes.canvas && !changes.canvas.isFirstChange()) ||\r\n      (changes.animate && !changes.animate.isFirstChange())\r\n    ) {\r\n      this.ngOnDestroy();\r\n      this.ngOnInit();\r\n    } else if (changes.coordinates && !changes.coordinates.isFirstChange()) {\r\n      const source = this.MapService.getSource<CanvasSource>(this.id);\r\n      source.setCoordinates(this.coordinates);\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.sub.unsubscribe();\r\n    if (this.sourceAdded) {\r\n      this.MapService.removeSource(this.id);\r\n      this.sourceAdded = false;\r\n    }\r\n  }\r\n\r\n  private init() {\r\n    const source: CanvasSourceRaw = {\r\n      type: 'canvas',\r\n      coordinates: this.coordinates,\r\n      canvas: this.canvas,\r\n      animate: this.animate,\r\n    };\r\n    this.MapService.addSource(this.id, source);\r\n    this.sourceAdded = true;\r\n  }\r\n}\r\n","import {\r\n  ChangeDetectionStrategy,\r\n  Component,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { ImageSource, ImageSourceOptions, ImageSourceRaw } from 'mapbox-gl';\r\nimport { Subscription } from 'rxjs';\r\nimport { MapService } from '../map/map.service';\r\n\r\n@Component({\r\n  selector: 'mgl-image-source',\r\n  template: '',\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class ImageSourceComponent\r\n  implements OnInit, OnDestroy, OnChanges, ImageSourceOptions {\r\n  /* Init inputs */\r\n  @Input() id: string;\r\n\r\n  /* Dynamic inputs */\r\n  @Input() url: ImageSourceOptions['url'];\r\n  @Input() coordinates: ImageSourceOptions['coordinates'];\r\n\r\n  private sub: Subscription;\r\n  private sourceId?: string;\r\n\r\n  constructor(private MapService: MapService) {}\r\n\r\n  ngOnInit() {\r\n    this.sub = this.MapService.mapLoaded$.subscribe(() => this.init());\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (this.sourceId === undefined) {\r\n      return;\r\n    }\r\n\r\n    const source = this.MapService.getSource<ImageSource>(this.sourceId);\r\n    source.updateImage({\r\n      url: changes.url === undefined ? undefined : this.url,\r\n      coordinates:\r\n        changes.coordinates === undefined ? undefined : this.coordinates,\r\n    });\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    if (this.sub !== undefined) {\r\n      this.sub.unsubscribe();\r\n    }\r\n\r\n    if (this.sourceId !== undefined) {\r\n      this.MapService.removeSource(this.sourceId);\r\n      this.sourceId = undefined;\r\n    }\r\n  }\r\n\r\n  private init() {\r\n    const imageSource: ImageSourceRaw = {\r\n      type: 'image',\r\n      url: this.url,\r\n      coordinates: this.coordinates,\r\n    };\r\n    this.MapService.addSource(this.id, imageSource);\r\n    this.sourceId = this.id;\r\n  }\r\n}\r\n","import {\r\n  ChangeDetectionStrategy,\r\n  Component,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { RasterDemSource } from 'mapbox-gl';\r\nimport { fromEvent, Subscription } from 'rxjs';\r\nimport { filter } from 'rxjs/operators';\r\nimport { MapService } from '../map/map.service';\r\n\r\n@Component({\r\n  selector: 'mgl-raster-dem-source',\r\n  template: '',\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class RasterDemSourceComponent\r\n  implements OnInit, OnDestroy, OnChanges, RasterDemSource {\r\n  /* Init inputs */\r\n  @Input() id: string;\r\n\r\n  /* Dynamic inputs */\r\n  @Input() url?: RasterDemSource['url'];\r\n  @Input() tiles?: RasterDemSource['tiles'];\r\n  @Input() bounds?: RasterDemSource['bounds'];\r\n  @Input() minzoom?: RasterDemSource['minzoom'];\r\n  @Input() maxzoom?: RasterDemSource['maxzoom'];\r\n  @Input() tileSize?: RasterDemSource['tileSize'];\r\n  @Input() attribution?: RasterDemSource['attribution'];\r\n  @Input() encoding?: RasterDemSource['encoding'];\r\n\r\n  type: RasterDemSource['type'] = 'raster-dem';\r\n\r\n  private sourceAdded = false;\r\n  private sub = new Subscription();\r\n\r\n  constructor(private MapService: MapService) {}\r\n\r\n  ngOnInit() {\r\n    const sub1 = this.MapService.mapLoaded$.subscribe(() => {\r\n      this.init();\r\n      const sub = fromEvent(<any>this.MapService.mapInstance, 'styledata')\r\n        .pipe(filter(() => !this.MapService.mapInstance.getSource(this.id)))\r\n        .subscribe(() => {\r\n          this.init();\r\n        });\r\n      this.sub.add(sub);\r\n    });\r\n    this.sub.add(sub1);\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (!this.sourceAdded) {\r\n      return;\r\n    }\r\n    if (\r\n      (changes.url && !changes.url.isFirstChange()) ||\r\n      (changes.tiles && !changes.tiles.isFirstChange()) ||\r\n      (changes.bounds && !changes.bounds.isFirstChange()) ||\r\n      (changes.minzoom && !changes.minzoom.isFirstChange()) ||\r\n      (changes.maxzoom && !changes.maxzoom.isFirstChange()) ||\r\n      (changes.tileSize && !changes.tileSize.isFirstChange()) ||\r\n      (changes.attribution && !changes.attribution.isFirstChange()) ||\r\n      (changes.encoding && !changes.encoding.isFirstChange())\r\n    ) {\r\n      this.ngOnDestroy();\r\n      this.ngOnInit();\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.sub.unsubscribe();\r\n    if (this.sourceAdded) {\r\n      this.MapService.removeSource(this.id);\r\n      this.sourceAdded = false;\r\n    }\r\n  }\r\n\r\n  private init() {\r\n    const source: RasterDemSource = {\r\n      type: this.type,\r\n      url: this.url,\r\n      tiles: this.tiles,\r\n      bounds: this.bounds,\r\n      minzoom: this.minzoom,\r\n      maxzoom: this.maxzoom,\r\n      tileSize: this.tileSize,\r\n      attribution: this.attribution,\r\n      encoding: this.encoding,\r\n    };\r\n    this.MapService.addSource(this.id, source);\r\n    this.sourceAdded = true;\r\n  }\r\n}\r\n","import {\r\n  ChangeDetectionStrategy,\r\n  Component,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { RasterSource } from 'mapbox-gl';\r\nimport { fromEvent, Subscription } from 'rxjs';\r\nimport { filter } from 'rxjs/operators';\r\nimport { MapService } from '../map/map.service';\r\n\r\n@Component({\r\n  selector: 'mgl-raster-source',\r\n  template: '',\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class RasterSourceComponent\r\n  implements OnInit, OnDestroy, OnChanges, RasterSource {\r\n  /* Init inputs */\r\n  @Input() id: string;\r\n\r\n  /* Dynamic inputs */\r\n  @Input() url?: RasterSource['url'];\r\n  @Input() tiles?: RasterSource['tiles'];\r\n  @Input() bounds?: RasterSource['bounds'];\r\n  @Input() minzoom?: RasterSource['minzoom'];\r\n  @Input() maxzoom?: RasterSource['maxzoom'];\r\n  @Input() tileSize?: RasterSource['tileSize'];\r\n  @Input() scheme?: RasterSource['scheme'];\r\n  @Input() attribution?: RasterSource['attribution'];\r\n\r\n  type: RasterSource['type'] = 'raster';\r\n\r\n  private sourceAdded = false;\r\n  private sub = new Subscription();\r\n\r\n  constructor(private MapService: MapService) {}\r\n\r\n  ngOnInit() {\r\n    const sub1 = this.MapService.mapLoaded$.subscribe(() => {\r\n      this.init();\r\n      const sub = fromEvent(<any>this.MapService.mapInstance, 'styledata')\r\n        .pipe(filter(() => !this.MapService.mapInstance.getSource(this.id)))\r\n        .subscribe(() => {\r\n          this.init();\r\n        });\r\n      this.sub.add(sub);\r\n    });\r\n    this.sub.add(sub1);\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (!this.sourceAdded) {\r\n      return;\r\n    }\r\n    if (\r\n      (changes.url && !changes.url.isFirstChange()) ||\r\n      (changes.tiles && !changes.tiles.isFirstChange()) ||\r\n      (changes.bounds && !changes.bounds.isFirstChange()) ||\r\n      (changes.minzoom && !changes.minzoom.isFirstChange()) ||\r\n      (changes.maxzoom && !changes.maxzoom.isFirstChange()) ||\r\n      (changes.tileSize && !changes.tileSize.isFirstChange()) ||\r\n      (changes.scheme && !changes.scheme.isFirstChange()) ||\r\n      (changes.attribution && !changes.attribution.isFirstChange())\r\n    ) {\r\n      this.ngOnDestroy();\r\n      this.ngOnInit();\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.sub.unsubscribe();\r\n    if (this.sourceAdded) {\r\n      this.MapService.removeSource(this.id);\r\n      this.sourceAdded = false;\r\n    }\r\n  }\r\n\r\n  private init() {\r\n    const source: RasterSource = {\r\n      type: this.type,\r\n      url: this.url,\r\n      tiles: this.tiles,\r\n      bounds: this.bounds,\r\n      minzoom: this.minzoom,\r\n      maxzoom: this.maxzoom,\r\n      tileSize: this.tileSize,\r\n      scheme: this.scheme,\r\n      attribution: this.attribution,\r\n    };\r\n    this.MapService.addSource(this.id, source);\r\n    this.sourceAdded = true;\r\n  }\r\n}\r\n","import {\r\n  ChangeDetectionStrategy,\r\n  Component,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { VectorSource, VectorSourceImpl } from 'mapbox-gl';\r\nimport { fromEvent, Subscription } from 'rxjs';\r\nimport { filter } from 'rxjs/operators';\r\nimport { MapService } from '../map/map.service';\r\n\r\n@Component({\r\n  selector: 'mgl-vector-source',\r\n  template: '',\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class VectorSourceComponent\r\n  implements OnInit, OnDestroy, OnChanges, VectorSource {\r\n  /* Init inputs */\r\n  @Input() id: string;\r\n\r\n  /* Dynamic inputs */\r\n  @Input() url?: VectorSource['url'];\r\n  @Input() tiles?: VectorSource['tiles'];\r\n  @Input() bounds?: VectorSource['bounds'];\r\n  @Input() scheme?: VectorSource['scheme'];\r\n  @Input() minzoom?: VectorSource['minzoom'];\r\n  @Input() maxzoom?: VectorSource['maxzoom'];\r\n  @Input() attribution?: VectorSource['attribution'];\r\n  @Input() promoteId?: VectorSource['promoteId'];\r\n\r\n  type: VectorSource['type'] = 'vector';\r\n\r\n  private sourceAdded = false;\r\n  private sub = new Subscription();\r\n\r\n  constructor(private MapService: MapService) {}\r\n\r\n  ngOnInit() {\r\n    const sub1 = this.MapService.mapLoaded$.subscribe(() => {\r\n      this.init();\r\n      const sub = fromEvent(<any>this.MapService.mapInstance, 'styledata')\r\n        .pipe(filter(() => !this.MapService.mapInstance.getSource(this.id)))\r\n        .subscribe(() => {\r\n          this.init();\r\n        });\r\n      this.sub.add(sub);\r\n    });\r\n    this.sub.add(sub1);\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (!this.sourceAdded) {\r\n      return;\r\n    }\r\n\r\n    if (\r\n      (changes.bounds && !changes.bounds.isFirstChange()) ||\r\n      (changes.scheme && !changes.scheme.isFirstChange()) ||\r\n      (changes.minzoom && !changes.minzoom.isFirstChange()) ||\r\n      (changes.maxzoom && !changes.maxzoom.isFirstChange()) ||\r\n      (changes.attribution && !changes.attribution.isFirstChange()) ||\r\n      (changes.promoteId && !changes.promoteId.isFirstChange())\r\n    ) {\r\n      this.ngOnDestroy();\r\n      this.ngOnInit();\r\n    } else if (\r\n      (changes.url && !changes.url.isFirstChange()) ||\r\n      (changes.tiles && !changes.tiles.isFirstChange())\r\n    ) {\r\n      const source = this.MapService.getSource<VectorSourceImpl>(this.id);\r\n\r\n      if (changes.url && this.url) {\r\n        source.setUrl(this.url);\r\n      }\r\n\r\n      if (changes.tiles && this.tiles) {\r\n        source.setTiles(this.tiles);\r\n      }\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.sub.unsubscribe();\r\n    if (this.sourceAdded) {\r\n      this.MapService.removeSource(this.id);\r\n      this.sourceAdded = false;\r\n    }\r\n  }\r\n\r\n  private init() {\r\n    const source: VectorSource = {\r\n      type: this.type,\r\n      url: this.url,\r\n      tiles: this.tiles,\r\n      bounds: this.bounds,\r\n      scheme: this.scheme,\r\n      minzoom: this.minzoom,\r\n      maxzoom: this.maxzoom,\r\n      attribution: this.attribution,\r\n      promoteId: this.promoteId,\r\n    };\r\n    this.MapService.addSource(this.id, source);\r\n    this.sourceAdded = true;\r\n  }\r\n}\r\n","import {\r\n  ChangeDetectionStrategy,\r\n  Component,\r\n  Input,\r\n  OnChanges,\r\n  OnDestroy,\r\n  OnInit,\r\n  SimpleChanges,\r\n} from '@angular/core';\r\nimport { VideoSource, VideoSourceOptions, VideoSourceRaw } from 'mapbox-gl';\r\nimport { fromEvent, Subscription } from 'rxjs';\r\nimport { filter } from 'rxjs/operators';\r\nimport { MapService } from '../map/map.service';\r\n\r\n@Component({\r\n  selector: 'mgl-video-source',\r\n  template: '',\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class VideoSourceComponent\r\n  implements OnInit, OnDestroy, OnChanges, VideoSourceOptions {\r\n  /* Init inputs */\r\n  @Input() id: string;\r\n\r\n  /* Dynamic inputs */\r\n  @Input() urls: VideoSourceOptions['urls'];\r\n  @Input() coordinates: VideoSourceOptions['coordinates'];\r\n\r\n  private sourceAdded = false;\r\n  private sub = new Subscription();\r\n\r\n  constructor(private MapService: MapService) {}\r\n\r\n  ngOnInit() {\r\n    const sub1 = this.MapService.mapLoaded$.subscribe(() => {\r\n      this.init();\r\n      const sub = fromEvent(<any>this.MapService.mapInstance, 'styledata')\r\n        .pipe(filter(() => !this.MapService.mapInstance.getSource(this.id)))\r\n        .subscribe(() => {\r\n          this.init();\r\n        });\r\n      this.sub.add(sub);\r\n    });\r\n    this.sub.add(sub1);\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (!this.sourceAdded) {\r\n      return;\r\n    }\r\n\r\n    if (changes.urls && !changes.urls.isFirstChange()) {\r\n      this.ngOnDestroy();\r\n      this.ngOnInit();\r\n    } else if (changes.coordinates && !changes.coordinates.isFirstChange()) {\r\n      const source = this.MapService.getSource<VideoSource>(this.id);\r\n      source.setCoordinates(this.coordinates!);\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.sub.unsubscribe();\r\n    if (this.sourceAdded) {\r\n      this.MapService.removeSource(this.id);\r\n      this.sourceAdded = false;\r\n    }\r\n  }\r\n\r\n  private init() {\r\n    const source: VideoSourceRaw = {\r\n      type: 'video',\r\n      urls: this.urls,\r\n      coordinates: this.coordinates,\r\n    };\r\n    this.MapService.addSource(this.id, source);\r\n    this.sourceAdded = true;\r\n  }\r\n}\r\n","import { CommonModule } from '@angular/common';\r\nimport { ModuleWithProviders, NgModule } from '@angular/core';\r\nimport { AttributionControlDirective } from './control/attribution-control.directive';\r\nimport { ControlComponent } from './control/control.component';\r\nimport { FullscreenControlDirective } from './control/fullscreen-control.directive';\r\nimport {\r\n  GeocoderControlDirective,\r\n  MAPBOX_GEOCODER_API_KEY,\r\n} from './control/geocoder-control.directive';\r\nimport { GeolocateControlDirective } from './control/geolocate-control.directive';\r\nimport { NavigationControlDirective } from './control/navigation-control.directive';\r\nimport { ScaleControlDirective } from './control/scale-control.directive';\r\nimport { DraggableDirective } from './draggable/draggable.directive';\r\nimport { ImageComponent } from './image/image.component';\r\nimport { LayerComponent } from './layer/layer.component';\r\nimport { MapComponent } from './map/map.component';\r\nimport { MAPBOX_API_KEY } from './map/map.service';\r\nimport { MarkerComponent } from './marker/marker.component';\r\nimport {\r\n  ClusterPointDirective,\r\n  PointDirective,\r\n  MarkersForClustersComponent,\r\n} from './markers-for-clusters/markers-for-clusters.component';\r\nimport { PopupComponent } from './popup/popup.component';\r\nimport { CanvasSourceComponent } from './source/canvas-source.component';\r\nimport { FeatureComponent } from './source/geojson/feature.component';\r\nimport { GeoJSONSourceComponent } from './source/geojson/geojson-source.component';\r\nimport { ImageSourceComponent } from './source/image-source.component';\r\nimport { RasterDemSourceComponent } from './source/raster-dem-source.component';\r\nimport { RasterSourceComponent } from './source/raster-source.component';\r\nimport { VectorSourceComponent } from './source/vector-source.component';\r\nimport { VideoSourceComponent } from './source/video-source.component';\r\n\r\n@NgModule({\r\n  imports: [CommonModule],\r\n  declarations: [\r\n    MapComponent,\r\n    LayerComponent,\r\n    DraggableDirective,\r\n    ImageComponent,\r\n    VectorSourceComponent,\r\n    GeoJSONSourceComponent,\r\n    RasterDemSourceComponent,\r\n    RasterSourceComponent,\r\n    ImageSourceComponent,\r\n    VideoSourceComponent,\r\n    CanvasSourceComponent,\r\n    FeatureComponent,\r\n    MarkerComponent,\r\n    PopupComponent,\r\n    ControlComponent,\r\n    FullscreenControlDirective,\r\n    NavigationControlDirective,\r\n    GeocoderControlDirective,\r\n    GeolocateControlDirective,\r\n    AttributionControlDirective,\r\n    ScaleControlDirective,\r\n    PointDirective,\r\n    ClusterPointDirective,\r\n    MarkersForClustersComponent,\r\n  ],\r\n  exports: [\r\n    MapComponent,\r\n    LayerComponent,\r\n    DraggableDirective,\r\n    ImageComponent,\r\n    VectorSourceComponent,\r\n    GeoJSONSourceComponent,\r\n    RasterDemSourceComponent,\r\n    RasterSourceComponent,\r\n    ImageSourceComponent,\r\n    VideoSourceComponent,\r\n    CanvasSourceComponent,\r\n    FeatureComponent,\r\n    MarkerComponent,\r\n    PopupComponent,\r\n    ControlComponent,\r\n    FullscreenControlDirective,\r\n    NavigationControlDirective,\r\n    GeocoderControlDirective,\r\n    GeolocateControlDirective,\r\n    AttributionControlDirective,\r\n    ScaleControlDirective,\r\n    PointDirective,\r\n    ClusterPointDirective,\r\n    MarkersForClustersComponent,\r\n  ],\r\n})\r\nexport class NgxMapboxGLModule {\r\n  static withConfig(config: {\r\n    accessToken: string;\r\n    geocoderAccessToken?: string;\r\n  }): ModuleWithProviders<NgxMapboxGLModule> {\r\n    return {\r\n      ngModule: NgxMapboxGLModule,\r\n      providers: [\r\n        {\r\n          provide: MAPBOX_API_KEY,\r\n          useValue: config.accessToken,\r\n        },\r\n        {\r\n          provide: MAPBOX_GEOCODER_API_KEY,\r\n          useValue: config.geocoderAccessToken || config.accessToken,\r\n        },\r\n      ],\r\n    };\r\n  }\r\n}\r\n"]}